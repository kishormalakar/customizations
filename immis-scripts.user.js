// ==UserScript==
// @name         IMMIS
// @namespace    http://tampermonkey.net/
// @version      1.0.86
// @description  try to take over the world!
// @author       You
// @match        https://ireps.gov.in/fcgi/*
// @icon         https://www.google.com/s2/favicons?sz=64&domain=gov.in
// @grant        GM_xmlhttpRequest
// @run-at       document-end
// ==/UserScript==

window.addEventListener(
	"load",
	function () {
		"use strict";

		if (document.title.startsWith("Run Form - ")) {
			var titleBar = document.querySelectorAll("#TitleBar")[0];
			var title = titleBar.querySelectorAll("td")[1].innerText;
			document.title = title;
			titleBar.style.width = "100%";
		}

		var titleBar = "";
		var currentDepotCode = "";
		var currentZoneCode = "";
		var currentZone = "";
		var currentYear = "";
        var today = new Date();

		var body = document.querySelectorAll("body")[0];

		var zoneJson = {
			CR: "01",
			ER: "02",
			NR: "03",
			NER: "04",
			NFR: "05",
			SR: "06",
			SCR: "07",
			SER: "08",
			WR: "09",
			ECR: "10",
			ECOR: "11",
			NCR: "12",
			NWR: "13",
			SECR: "14",
			SWR: "15",
			WCR: "16",
			METRO: "17",
			CLW: "21",
			BLW: "22",
			ICF: "23",
			RCF: "24",
			RWF: "25",
			PLW: "26",
			MCFRBL: "27",
			NFRCON: "28",
			RWP: "29",
			RB: "30",
			RDSO: "31",
			KRCL: "41",
			CORE: "42",
			COFMOW: "43",
			RELTEL: "44",
			WPO: "45",
			NAIR: "55",
			CRIS: "98",
		};

		var zoneDepotArray = [
			["PD/DDU", "22"],
			["DSD/DDU", "23"],
			["DSL/PTRU", "26"],
			["TRS/GMO", "30"],
			["TRS/DDU", "31"],
			["DSL/DDU", "32"],
			["BOXNDDU", "33"],
			["GSDGHZ", "34"],
			["MEMU JAJ", "35"],
			["CRW/HRT", "37"],
			["DEMU SEE", "38"],
			["GSD/DHN", "41"],
			["RNCC/PATNA", "42"],
			["ROH/BRWD", "43"],
			["MEMU/Gaya", "44"],
			["GSD/SPJ", "70"],
			["DSL/SPJ", "71"],
		];

		var monthArray = ["JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"];

		var dealerPlArray = [
            ['3000','3034','Navin Prakash'],['3035','3097','Anmol Kumar'],['3100','3170','Pramod Kumar'],['3171','3180','Raymond Indwar'],['3181','3192','Srikant'],['3193','3197','Dhananjay Kumar'],['3200','3297','Yogendra Chaudhary'],['3300','3355','Ashok Kumar'],['3356','3397','Dhiranjan Kumar'],['3500','3597','Yogendra Chaudhary'],['3700','3799','Yogendra Chaudhary'],['3800','3810','Satrughan Singh'],['3812','3812','Surendra Prasad'],['3813','3813','Satrughan Singh'],['3814','3814','Surendra Prasad'],['3816','3839','Satrughan Singh'],['3840','3899','Surendra Prasad'],['0','0','Priyanka Kumari'],['0','0','Sanjeev Kr Singh']
        ];

        var specialPlArray = ['30110786','Priyanka Kumari','30210598','Priyanka Kumari','30210616','Priyanka Kumari','30317344','Priyanka Kumari','30351480','Priyanka Kumari','30351881','Priyanka Kumari','30357007','Priyanka Kumari','30726748','Priyanka Kumari','33260011','Priyanka Kumari','33260023','Priyanka Kumari','33260035','Priyanka Kumari','33500915','Priyanka Kumari','33500964','Priyanka Kumari','33501610','Priyanka Kumari','33501750','Priyanka Kumari','33501786','Priyanka Kumari','33501830','Priyanka Kumari','33513855','Priyanka Kumari','33681223','Priyanka Kumari','33519560','Priyanka Kumari','33683402','Priyanka Kumari','33502699','Priyanka Kumari','33502705','Priyanka Kumari','33683888','Priyanka Kumari','33502717','Priyanka Kumari','33502924','Priyanka Kumari','33503230','Priyanka Kumari','33504817','Priyanka Kumari','33504829','Priyanka Kumari','33504854','Priyanka Kumari','33504891','Priyanka Kumari','33576294','Priyanka Kumari','33505159','Priyanka Kumari','33505172','Priyanka Kumari','33683888','Priyanka Kumari','33506516','Priyanka Kumari','33506589','Priyanka Kumari','33512620','Priyanka Kumari','33507831','Priyanka Kumari','33512590','Priyanka Kumari','33508355','Priyanka Kumari','33509165','Priyanka Kumari','33509815','Priyanka Kumari','33510131','Priyanka Kumari','33512360','Priyanka Kumari','33505421','Priyanka Kumari','33512413','Priyanka Kumari','33518051','Priyanka Kumari','33533556','Priyanka Kumari','33534639','Priyanka Kumari','33553762','Priyanka Kumari','33571831','Priyanka Kumari','33575046','Priyanka Kumari','33580029','Priyanka Kumari','33580042','Priyanka Kumari','33582040','Priyanka Kumari','33588119','Priyanka Kumari','33591337','Priyanka Kumari','33591362','Priyanka Kumari','33591374','Priyanka Kumari','33592044','Priyanka Kumari','33597923','Priyanka Kumari','33598411','Priyanka Kumari','33607564','Priyanka Kumari','33614568','Priyanka Kumari','33643362','Priyanka Kumari','33674188','Priyanka Kumari','33681697','Priyanka Kumari','33682781','Priyanka Kumari','33683402','Priyanka Kumari','33687006','Priyanka Kumari','33689969','Priyanka Kumari','30126629','Sanjeev Kr Singh','31050189','Sanjeev Kr Singh','31307772','Sanjeev Kr Singh','31307784','Sanjeev Kr Singh','31307930','Sanjeev Kr Singh','31307954','Sanjeev Kr Singh','31308090','Sanjeev Kr Singh','31308119','Sanjeev Kr Singh','31308120','Sanjeev Kr Singh','31308272','Sanjeev Kr Singh','31308296','Sanjeev Kr Singh','31308302','Sanjeev Kr Singh','31308340','Sanjeev Kr Singh','31308351','Sanjeev Kr Singh','31308363','Sanjeev Kr Singh','31308454','Sanjeev Kr Singh','31308466','Sanjeev Kr Singh','31308478','Sanjeev Kr Singh','31308557','Sanjeev Kr Singh','31309860','Sanjeev Kr Singh','31309902','Sanjeev Kr Singh','31311222','Sanjeev Kr Singh','31317030','Sanjeev Kr Singh','31317170','Sanjeev Kr Singh','31317200','Sanjeev Kr Singh','31352807','Sanjeev Kr Singh','31755987','Sanjeev Kr Singh','31867352','Sanjeev Kr Singh','31877217','Sanjeev Kr Singh','31877229','Sanjeev Kr Singh','31892000','Sanjeev Kr Singh','31892012','Sanjeev Kr Singh','31892024','Sanjeev Kr Singh','31892048','Sanjeev Kr Singh','31892050','Sanjeev Kr Singh','31892061','Sanjeev Kr Singh','31892073','Sanjeev Kr Singh','31892085','Sanjeev Kr Singh','31892097','Sanjeev Kr Singh','31892103','Sanjeev Kr Singh','31892115','Sanjeev Kr Singh','31892164','Sanjeev Kr Singh','31892176','Sanjeev Kr Singh','31892188','Sanjeev Kr Singh','31892190','Sanjeev Kr Singh','31897990','Sanjeev Kr Singh','31910634','Sanjeev Kr Singh','31910646','Sanjeev Kr Singh','31910658','Sanjeev Kr Singh','31910660','Sanjeev Kr Singh','31910695','Sanjeev Kr Singh','31910701','Sanjeev Kr Singh','31910713','Sanjeev Kr Singh','31910725','Sanjeev Kr Singh','31912758','Sanjeev Kr Singh','31912771','Sanjeev Kr Singh','31914780','Sanjeev Kr Singh','31915310','Sanjeev Kr Singh','31915474','Sanjeev Kr Singh','31915814','Sanjeev Kr Singh','31916223','Sanjeev Kr Singh','31916247','Sanjeev Kr Singh','31916272','Sanjeev Kr Singh','31916284','Sanjeev Kr Singh','31921670','Sanjeev Kr Singh','33500848','Sanjeev Kr Singh','33500927','Sanjeev Kr Singh','33500940','Sanjeev Kr Singh','33500952','Sanjeev Kr Singh','33501476','Sanjeev Kr Singh','33501567','Sanjeev Kr Singh','33501671','Sanjeev Kr Singh','33501695','Sanjeev Kr Singh','33502470','Sanjeev Kr Singh','33502663','Sanjeev Kr Singh','33502675','Sanjeev Kr Singh','33502687','Sanjeev Kr Singh','33503394','Sanjeev Kr Singh','33503618','Sanjeev Kr Singh','33505627','Sanjeev Kr Singh','33506127','Sanjeev Kr Singh','33507028','Sanjeev Kr Singh','33507041','Sanjeev Kr Singh','33507983','Sanjeev Kr Singh','33510556','Sanjeev Kr Singh','33517666','Sanjeev Kr Singh','33550657','Sanjeev Kr Singh','33552472','Sanjeev Kr Singh','33553427','Sanjeev Kr Singh','33576294','Sanjeev Kr Singh','33580080','Sanjeev Kr Singh','33580121','Sanjeev Kr Singh','33580133','Sanjeev Kr Singh','33580145','Sanjeev Kr Singh','33580169','Sanjeev Kr Singh','33591090','Sanjeev Kr Singh','33591106','Sanjeev Kr Singh','33591118','Sanjeev Kr Singh','33591143','Sanjeev Kr Singh','33591155','Sanjeev Kr Singh','33591167','Sanjeev Kr Singh','33591180','Sanjeev Kr Singh','33591209','Sanjeev Kr Singh','33591234','Sanjeev Kr Singh','33591258','Sanjeev Kr Singh','33591994','Sanjeev Kr Singh','33592019','Sanjeev Kr Singh','33592020','Sanjeev Kr Singh','33598368','Sanjeev Kr Singh','33599038','Sanjeev Kr Singh','33599609','Sanjeev Kr Singh','33599658','Sanjeev Kr Singh','33601940','Sanjeev Kr Singh','33633575','Sanjeev Kr Singh','33680899','Sanjeev Kr Singh','33681909','Sanjeev Kr Singh','33686993','Sanjeev Kr Singh','33687160','Sanjeev Kr Singh','33689957','Sanjeev Kr Singh','33691368','Sanjeev Kr Singh','33691472','Sanjeev Kr Singh','33691484','Sanjeev Kr Singh','33693316','Sanjeev Kr Singh','33699525','Sanjeev Kr Singh','33699987','Sanjeev Kr Singh','33519535','Sanjeev Kr Singh','31913192','Sanjeev Kr Singh','31907260','Sanjeev Kr Singh','31153938','Sanjeev Kr Singh','33580157','Sanjeev Kr Singh','31153938','Sanjeev Kr Singh','31153983','Sanjeev Kr Singh','33549734','Sanjeev Kr Singh'];

        var itemNatureArray = ['30010354','N','C1','4','30010470','N','C2','9','30010548','N','C1','9','30010561','N','C2','9','30010639','N','D','9','30010743','N','C1','4','30010755','S','A','5','30010767','N','C1','9','30010858','N','C2','9','30010871','N','B1','9','30010974','N','C2','9','30011085','S','C2','9','30011115','N','C2','9','30011140','N','C2','9','30011231','N','B2','9','30014220','N','C2','9','30016605','N','C2','9','30017051','N','C2','9','30017075','N','C1','9','30017087','N','C2','9','30020116','N','C1','9','30020232','N','D','9','30020372','N','A','5','30020451','S','B1','9','30020487','S','A','5','30020542','N','C2','9','30020591','S','C2','9','30020608','S','C2','9','30020645','N','A','4','30020670','N','C2','9','30020750','S','C2','9','30020955','N','B2','9','30024407','N','C1','9','30027068','N','A','4','30027184','N','B1','9','30027305','N','C2','9','30027354','N','D','9','30030043','N','C2','9','30030225','S','C1','9','30030330','S','C2','9','30030444','N','D','9','30030470','N','D','9','30037074','N','B1','9','30038261','N','C2','9','30038273','N','C2','9','30040152','N','C2','9','30050029','N','C1','4','30050042','N','C2','9','30050108','N','B2','9','30050110','N','C2','9','30050121','N','C2','9','30050315','N','C2','9','30050388','N','D','9','30050716','N','C1','9','30050856','N','C2','9','30050870','N','C2','9','30051046','S','C1','9','30051058','S','A','5','30051137','N','C2','9','30051149','S','B1','9','30051277','N','C2','9','30051356','N','C2','9','30054205','S','B1','9','30054229','N','C2','9','30056056','S','C1','9','30056068','N','C2','9','30056070','N','C2','9','30057309','N','C1','9','30057437','N','C2','9','30057759','N','A','5','30057966','N','C2','9','30058983','N','C1','9','30060230','N','C2','9','30060321','N','C2','9','30060461','N','C2','9','30064200','S','C2','9','30064211','N','C1','9','30067110','N','C1','9','30070340','S','B1','9','30070363','N','C1','9','30070442','S','C2','9','30070454','N','C2','9','30076134','N','B2','9','30077096','N','B2','9','30100318','N','C2','9','30100446','N','C2','9','30100653','N','C1','9','30107647','N','C2','9','30107982','N','C2','9','30107994','N','C2','9','30108032','N','C2','9','30108056','N','C2','9','30110180','N','B2','9','30110282','N','C2','9','30110350','N','D','9','30110361','N','D','9','30110397','N','C2','9','30110695','N','C2','9','30110701','N','C2','9','30110737','N','D','9','30110786','N','C2','9','30117161','N','C2','9','30117173','N','C2','9','30126125','N','D','9','30126344','N','C1','9','30126629','N','D','9','30126708','N','B2','9','30127014','N','C2','9','30127075','N','C2','9','30127087','N','C2','9','30127099','N','C2','9','30127105','N','C2','9','30127117','N','C2','9','30130414','N','C2','9','30137081','N','D','9','30140067','N','C2','9','30140377','N','D','9','30140468','N','C1','9','30146008','N','C2','9','30146010','N','C2','9','30177017','N','C1','9','30177157','N','B2','9','30177261','N','C2','9','30177443','N','C2','9','30178540','N','C1','9','30180016','N','C2','9','30200003','N','D','9','30200027','N','C2','9','30210010','N','C1','9','30210100','N','C1','9','30210112','N','C2','9','30210318','N','C2','9','30210320','N','C2','9','30210355','N','C2','9','30210434','N','C2','9','30210598','N','C2','9','30210616','N','B2','9','30217040','N','C1','9','30217519','N','C2','9','30220129','N','C2','9','30226030','S','B2','9','30226041','N','D','9','30227010','N','C1','9','30230044','N','D','9','30230184','N','C2','9','30230329','N','C2','9','30247007','N','B2','9','30251308','N','C2','9','30254085','N','C2','9','30256379','N','C2','9','30256549','N','D','9','30256550','N','B2','9','30257207','N','C2','9','30260103','N','C2','9','30266373','N','D','9','30300009','N','D','9','30310131','N','C2','9','30310167','N','C2','9','30310210','N','C2','9','30310260','N','C1','9','30310271','N','C1','9','30310337','N','C1','9','30316121','S','A','5','30317149','S','C2','9','30317204','N','C2','9','30317344','N','C1','9','30320082','N','C1','9','30320392','N','B2','9','30320574','N','C2','9','30320586','N','C1','9','30320604','N','C2','9','30321165','N','D','9','30321256','N','C2','9','30321335','N','C2','9','30321372','N','C2','9','30326461','N','C2','9','30326588','N','C2','9','30327015','N','C2','9','30327040','N','C2','9','30327088','N','C2','9','30327209','N','C1','9','30327234','N','C2','9','30327246','N','C2','9','30327325','N','C2','9','30327416','N','C2','9','30327799','N','C2','9','30327805','N','C2','9','30328263','N','C2','9','30328329','N','D','9','30337690','N','C1','9','30337707','N','C2','9','30337719','N','C2','9','30340111','N','D','9','30350311','N','C2','9','30350323','N','C2','9','30350864','N','C2','9','30350920','N','C2','9','30350931','N','C2','9','30351157','N','D','9','30351303','N','C2','9','30351480','N','C1','9','30351698','N','D','9','30351819','N','C1','9','30351856','N','C2','9','30351868','N','C2','9','30351881','N','N','9','30352186','N','C2','9','30352230','N','C2','9','30352241','N','C2','9','30352253','N','C2','9','30352630','N','C2','9','30352873','N','C2','9','30353014','N','C2','9','30353051','N','C1','9','30353129','N','C2','9','30353180','N','C1','9','30353889','N','N','9','30357007','N','B2','9','30357044','N','C2','9','30357070','N','C2','9','30357135','N','C1','9','30357147','N','C1','9','30357159','N','C2','9','30357202','N','C1','9','30357925','N','C1','9','30358231','N','C2','9','30358371','N','C2','9','30358796','N','B1','9','30358840','N','C2','9','30358875','N','B2','9','30358887','N','C1','9','30358929','N','D','9','30358942','N','C2','9','30358954','N','C2','9','30359065','N','C1','9','30359077','N','C2','9','30370012','N','A','5','30370024','N','C2','9','30377201','N','C2','9','30377237','N','C2','9','30380005','N','C2','9','30390000','N','D','9','30410174','N','D','9','30411130','N','C2','9','30411180','N','C2','9','30420416','N','C2','9','30427289','N','C1','9','30427290','N','C2','9','30427514','N','D','9','30436254','N','C2','9','30437039','N','C2','9','30437234','N','B2','9','30437246','N','B2','9','30437258','N','B2','9','30477797','N','C1','9','30477803','N','C2','9','30478110','N','C2','9','30478133','N','C1','9','30478145','N','C1','9','30478182','N','C2','9','30478194','N','C2','9','30478200','N','C2','9','30516328','N','C2','9','30517310','N','C2','9','30517370','N','C2','9','30536017','N','C2','9','30540240','N','D','9','30540252','N','C2','9','30540264','N','C1','9','30541037','N','C2','9','30541062','N','D','9','30546266','N','D','9','30546280','N','D','9','30546333','N','D','9','30546527','N','D','9','30546655','N','C2','9','30546722','N','C1','9','30546886','N','D','9','30547015','N','C1','9','30547088','N','A','5','30547090','N','B1','9','30547544','N','D','9','30548214','N','C2','9','30548354','N','B1','9','30548366','N','C2','9','30548380','N','C2','9','30548512','N','D','9','30548860','N','C2','9','30548986','N','D','9','30550464','N','D','9','30550488','N','C2','9','30556065','N','C1','9','30556090','N','C1','9','30557124','N','C1','9','30557215','N','D','9','30557227','N','C2','9','30560275','N','C2','9','30560287','N','D','9','30560354','N','C1','9','30560366','N','D','9','30560470','N','C1','9','30561115','N','N','9','30561899','N','C2','9','30562168','N','N','9','30566680','N','C1','9','30567245','N','C2','9','30568092','N','C2','9','30568109','N','C1','9','30568237','N','D','9','30568250','N','C1','9','30568286','N','C2','9','30587347','N','D','9','30590012','N','C2','9','30610953','N','D','9','30617820','N','D','9','30618563','N','D','9','30618575','N','D','9','30618710','N','C2','9','30630204','N','C1','9','30631415','N','C1','9','30631518','N','N','9','30631841','N','C2','9','30631865','N','N','9','30632092','N','N','9','30633333','N','C2','9','30633345','N','D','9','30635317','N','C2','9','30635329','N','C2','9','30636024','N','C2','9','30636656','N','C2','9','30637028','N','C2','9','30637521','N','C2','9','30638616','N','C2','9','30638665','N','B2','9','30640052','N','C2','9','30640921','N','D','9','30643259','N','D','9','30643818','N','D','9','30647009','N','C2','9','30647526','PN','C1','9','30647538','PN','C2','9','30648762','N','C2','9','30649894','N','C2','9','30662606','N','D','9','30662783','N','C2','9','30663350','N','C1','9','30663374','N','D','9','30663404','N','D','9','30666867','N','C2','9','30667010','N','D','9','30667409','N','C2','9','30674153','N','B2','9','30676071','N','D','9','30676186','N','C2','9','30676617','N','D','9','30676629','N','D','9','30676782','N','C1','9','30676836','N','C2','9','30676848','N','D','9','30676897','N','C1','9','30677129','N','D','9','30678018','N','C2','9','30710133','N','C2','9','30710534','N','D','9','30726748','N','B1','9','30768550','N','D','9','30920462','N','C2','9','30922082','S','C2','9','30922239','N','C1','9','30922471','N','C2','9','30922677','N','C2','9','30970015','N','D','9','30971032','N','C2','9','30972255','N','D','9','30972693','N','D','9','30972759','S','B2','9','30972851','N','C1','9','30981232','N','D','9','30981657','N','D','9','30982558','N','C2','9','30983484','N','D','9','30983800','N','D','9','30983812','N','D','9','30983873','N','D','9','30984117','N','D','9','30984786','N','D','9','30985134','N','D','9','30985250','N','D','9','30985341','N','D','9','30985663','N','D','9','30986000','N','D','9','30986242','N','D','9','31000186','N','C2','9','31000216','N','N','9','31000460','N','B2','9','31000496','N','C1','9','31000538','N','C2','9','31000540','N','C2','9','31000551','N','C2','9','31000757','N','C2','9','31000850','N','C2','9','31000861','N','C1','9','31001002','N','C1','9','31001130','N','D','9','31001210','N','B2','9','31001221','N','B2','9','31001385','N','N','9','31001397','N','N','9','31001403','N','D','9','31001427','N','N','9','31001798','N','N','9','31010817','N','C2','9','31011408','N','C1','9','31011494','N','C1','9','31020150','N','C2','9','31020951','N','N','9','31020963','N','N','9','31020975','N','N','9','31020987','N','N','9','31020999','N','N','9','31021001','N','N','9','31021062','N','N','9','31021074','N','N','9','31021311','N','N','9','31021359','N','N','9','31021360','N','N','9','31021372','N','N','9','31030023','N','C2','9','31030336','N','C2','9','31050128','S','B2','9','31050189','N','C2','9','31050566','N','C2','9','31057652','N','N','9','31057664','S','N','9','31057676','N','N','9','31058073','N','N','9','31090035','N','C1','9','31090047','N','C1','9','31090059','N','C2','9','31097236','N','C1','9','31102256','N','C2','9','31102426','N','N','9','31102438','N','D','9','31107990','N','C2','9','31108015','N','C2','9','31130288','N','C2','9','31137027','N','C2','9','31137039','N','D','9','31137120','N','C2','9','31137155','N','C2','9','31137453','N','A','5','31150937','N','C2','9','31151530','N','C1','9','31153938','N','D','9','31154293','N','C2','9','31154920','N','N','9','31160980','N','N','9','31160992','N','N','9','31168085','N','D','9','31168097','N','B2','9','31169107','N','B2','9','31169338','N','C2','9','31169340','N','C2','9','31169351','N','C2','9','31169508','N','C2','9','31169594','N','C2','9','31210053','N','C2','9','31210090','N','N','9','31220149','N','C2','9','31220824','N','C2','9','31222055','N','C2','9','31222663','N','C2','9','31240008','N','C2','9','31250014','N','C2','9','31257380','N','C2','9','31300066','N','D','9','31300078','N','N','9','31300080','N','N','9','31300091','N','N','9','31300108','N','N','9','31300110','N','D','9','31300121','N','C2','9','31300133','N','C2','9','31300145','N','N','9','31307085','N','C2','9','31307280','N','C2','9','31307383','N','C2','9','31307760','N','C2','9','31307905','N','C2','9','31308107','N','C2','9','31308132','N','C2','9','31308387','N','C2','9','31308594','N','C2','9','31308612','N','C2','9','31308661','N','C2','9','31308673','N','C2','9','31309069','N','C2','9','31309082','N','C2','9','31309203','N','C2','9','31309215','N','C2','9','31309690','N','D','9','31310072','N','C2','9','31310138','N','C1','9','31317091','N','C2','9','31317110','N','C2','9','31317194','N','C2','9','31317236','N','C2','9','31317390','N','D','9','31317595','N','C2','9','31320107','N','C2','9','31320181','N','C2','9','31321550','N','C2','9','31327035','N','N','9','31327199','N','C1','9','31327394','N','C2','9','31327400','N','C2','9','31327412','N','C2','9','31327424','N','C2','9','31327436','N','C2','9','31327473','N','B2','9','31350288','N','C1','9','31350290','N','C1','9','31350835','N','C2','9','31351128','N','B2','9','31351566','N','B2','9','31351724','N','C2','9','31351748','N','C2','9','31351852','V','N','9','31352030','N','C2','9','31352133','N','D','9','31352145','N','C2','9','31352169','N','C2','9','31352352','N','C2','9','31352546','N','C1','9','31352558','N','C2','9','31352560','N','C2','9','31352637','N','C2','9','31352820','N','C2','9','31352832','N','C2','9','31352844','N','C2','9','31352959','N','C2','9','31353010','N','C2','9','31353125','N','C1','9','31353137','N','C2','9','31353332','N','N','9','31353381','N','C2','9','31353721','N','C2','9','31354002','N','C1','9','31354026','N','C2','9','31355754','S','D','9','31355780','N','N','9','31355845','N','N','9','31355869','S','C2','9','31355870','S','N','9','31355882','N','C2','9','31356084','N','C2','9','31356096','N','D','9','31356308','N','C2','9','31356710','S','N','9','31356760','S','D','9','31356795','S','C1','9','31357088','N','N','9','31357120','N','C2','9','31357143','N','C2','9','31357180','N','C2','9','31357192','S','C2','9','31357209','S','B2','9','31357210','N','D','9','31357222','N','D','9','31357246','N','C1','9','31357337','N','C2','9','31357362','N','C2','9','31357374','N','C2','9','31357404','N','C2','9','31357416','N','C1','9','31357957','N','B2','9','31357969','N','C1','9','31358159','N','C2','9','31358160','S','D','9','31358184','N','C2','9','31358226','N','N','9','31358755','N','N','9','31358860','S','C2','9','31358895','N','C1','9','31358925','N','N','9','31358998','N','D','9','31359279','S','D','9','31359383','S','C2','9','31359425','N','N','9','31359437','N','N','9','31359449','N','C2','9','31359504','N','C2','9','31359516','N','N','9','31359530','N','N','9','31359541','N','N','9','31359759','N','N','9','31360038','N','N','9','31360040','N','C1','9','31360063','N','N','9','31362874','N','N','9','31362904','N','N','9','31362916','N','N','9','31363003','N','N','9','31363131','N','N','9','31363143','N','N','9','31363246','S','N','9','31363258','N','N','9','31370019','N','C2','9','31390067','N','C2','9','31390729','N','C2','9','31391072','N','C2','9','31391102','N','C2','9','31391205','N','C2','9','31392623','N','C2','9','31392635','N','C2','9','31393214','N','C2','9','31393330','N','N','9','31395995','N','C2','9','31396008','N','C2','9','31396290','N','N','9','31396501','N','N','9','31400474','N','C2','9','31400486','N','C2','9','31437230','V','N','9','31467015','N','C2','9','31517122','S','D','9','31540030','N','C2','9','31540065','N','C2','9','31540879','N','C1','9','31540909','N','C2','9','31540934','N','D','9','31540946','N','D','9','31540983','N','D','9','31541100','N','N','9','31541227','N','C2','9','31541318','N','C2','9','31541320','N','N','9','31541331','N','N','9','31541355','N','D','9','31541379','S','D','9','31607287','N','D','9','31607755','N','C2','9','31617724','N','D','9','31618182','N','C2','9','31618984','N','N','9','31620589','N','C2','9','31630303','N','N','9','31630420','N','D','9','31630996','N','N','9','31631046','N','N','9','31637050','N','C2','9','31646013','N','C1','9','31648642','N','N','9','31667788','N','C2','9','31670039','N','D','9','31687015','N','C2','9','31703513','N','C2','9','31707026','N','C2','9','31707038','N','C2','9','31707452','N','C2','9','31707464','S','C2','9','31707830','N','C2','9','31720596','N','C2','9','31720626','N','C2','9','31720985','N','N','9','31721011','N','N','9','31721023','N','D','9','31721084','N','N','9','31737079','N','C2','9','31755987','N','D','9','31758563','N','C2','9','31758952','N','C2','9','31759180','N','N','9','31759415','N','N','9','31761732','N','D','9','31761835','N','N','9','31762037','N','N','9','31762098','N','N','9','31762104','N','N','9','31762116','N','N','9','31787241','N','C2','9','31787381','N','C2','9','31787423','N','C2','9','31790653','N','C1','9','31792716','N','C2','9','31794609','N','C2','9','31797003','N','C2','9','31797027','N','C1','9','31797039','N','B2','9','31797090','N','D','9','31867352','N','D','4','31870132','N','C2','9','31877217','N','C2','4','31877229','N','C2','4','31892000','N','C2','4','31892012','N','C2','4','31892024','N','C2','4','31892048','N','C2','4','31892050','N','C2','4','31892061','N','C2','4','31892073','N','C2','4','31892085','N','C2','5','31892097','N','C2','5','31892103','N','D','5','31892115','N','C2','5','31892164','N','C2','4','31892176','N','C2','5','31892188','N','C2','4','31892190','N','D','4','31897990','N','C2','4','31900227','N','C1','9','31901130','N','C2','9','31901335','N','C2','9','31901360','N','C2','9','31901372','N','C2','9','31901451','N','C2','9','31901712','N','C2','9','31901736','N','C2','9','31901748','N','C2','9','31901888','V','N','9','31902108','N','D','9','31902649','N','C1','9','31902819','S','C2','9','31902832','N','N','9','31903484','N','C2','9','31905160','N','C2','9','31905195','N','N','9','31905201','N','N','9','31905493','N','N','9','31905500','N','N','9','31905547','N','N','9','31905559','N','D','9','31907120','N','C2','9','31907260','N','C2','9','31907763','N','C2','9','31910040','N','D','9','31910210','N','C2','9','31910634','N','C2','4','31910646','N','C2','4','31910658','N','C2','4','31910660','N','C1','5','31910695','N','C2','9','31910701','N','C1','4','31910713','N','C2','4','31910725','N','D','4','31911419','N','C2','9','31911432','N','C2','9','31911481','N','D','9','31911950','N','C2','9','31912758','N','C2','4','31912771','N','C1','4','31912862','N','C2','9','31912989','N','C1','9','31913192','N','C2','9','31913891','N','C2','9','31914020','N','C2','9','31914044','N','C2','9','31914780','N','C1','4','31915310','N','D','9','31915474','N','C2','4','31915814','N','C2','4','31916223','N','C2','4','31916247','N','D','4','31916272','N','D','4','31916284','N','D','4','31916533','N','C2','9','31917203','N','C2','9','31921670','N','B2','4','31922971','N','C2','9','31929126','N','C2','9','31930360','N','C2','9','31930852','N','C1','9','31930931','N','C2','9','31930955','N','C2','9','31930979','N','C2','9','31931005','N','D','9','31931017','N','C1','9','31931108','N','N','9','31931194','N','D','9','31932150','S','C2','9','31932307','N','N','9','31932721','N','C2','9','31933993','N','B1','9','31934237','N','B2','9','31934249','N','C2','9','31934250','N','C2','9','31934304','N','N','9','31934330','N','C2','9','31934341','N','D','9','31934353','N','D','9','31934365','N','C2','9','31934389','N','D','9','31934456','N','B2','9','31934602','N','N','9','31934614','N','N','9','31934638','N','C1','9','31934640','N','N','9','31934663','N','C2','9','31934675','N','C2','9','31934687','N','N','9','31934699','N','N','9','31934705','N','N','9','31934717','N','N','9','31934729','N','N','9','31934730','N','N','9','31934742','N','C1','9','31934754','N','C1','9','31934766','N','N','9','31934778','N','N','9','31934780','N','N','9','31934791','N','N','9','31934808','N','N','9','31934810','N','N','9','31934821','N','N','9','31934833','N','N','9','31934845','N','N','9','31934857','N','N','9','31934869','N','N','9','31934882','N','N','9','31934894','N','N','9','31934900','N','N','9','31934912','N','N','9','31934924','N','N','9','31934936','N','N','9','31934948','N','C2','9','31934950','N','C2','9','31934961','N','C2','9','31934973','N','D','9','31934985','N','C2','9','31934997','N','N','9','31935000','N','D','9','31935011','N','C2','9','31935023','N','N','9','31935035','N','N','9','31935047','N','D','9','31935059','N','N','9','31935084','N','N','9','31935096','N','N','9','31935126','N','N','9','31948730','N','C2','9','31948984','N','C2','9','31985907','N','D','9','31989020','N','C2','9','31990150','N','C2','9','31993229','N','C2','9','32040052','N','C1','9','32040076','N','D','9','32080013','N','C2','9','32100425','N','C2','9','32160136','N','C2','9','32160150','N','C2','9','32160185','N','C2','9','32160197','N','D','9','32160203','N','N','9','32160227','N','D','9','32160239','N','C2','9','32160343','N','D','9','32160410','S','C2','9','32160434','N','C2','9','32160471','N','C2','9','32160525','S','D','9','32169073','N','D','9','32210462','N','C2','9','32250010','N','D','9','32300037','N','D','9','32630001','N','C1','9','32640006','N','C1','9','32670000','N','N','9','32700088','N','C2','9','32860018','N','C2','9','32871004','N','C2','9','32871028','N','C2','9','32900016','N','C1','9','32900028','N','C1','9','32900259','N','C2','9','32915640','N','D','9','33100445','N','C2','5','33211504','N','C2','5','33211528','N','C2','5','33211541','N','C2','5','33260011','N','C1','5','33260023','N','C1','5','33260035','N','B1','9','33400015','N','C2','5','33500010','S','A','5','33500022','N','A','5','33500034','N','B2','9','33500046','N','B1','9','33500058','N','C2','5','33500060','N','A','5','33500083','N','C2','5','33500095','N','C2','5','33500113','N','C1','5','33500137','N','C2','5','33500149','N','D','5','33500174','N','C2','5','33500186','N','C1','5','33500216','N','C2','5','33500228','N','C2','5','33500230','N','C2','5','33500241','S','B2','9','33500265','S','C1','5','33500277','N','B2','9','33500289','N','C2','5','33500290','N','C2','5','33500307','N','C2','5','33500320','N','C2','5','33500332','N','C1','5','33500344','N','C2','5','33500356','S','B2','9','33500368','S','B1','9','33500370','S','C2','5','33500381','S','C1','5','33500393','S','C1','5','33500400','S','B1','9','33500411','N','C2','5','33500423','N','C1','5','33500435','N','C2','5','33500447','S','A','5','33500459','S','B2','9','33500472','N','C2','5','33500484','N','C1','5','33500496','N','C2','5','33500526','N','C2','5','33500538','N','C1','5','33500540','N','C2','5','33500551','N','C1','5','33500563','N','C2','5','33500575','N','C2','5','33500587','N','C1','5','33500599','N','C2','5','33500605','N','C2','5','33500642','N','D','5','33500654','N','C2','5','33500666','N','B2','9','33500678','N','B1','9','33500680','N','C1','5','33500691','S','C1','5','33500848','N','C1','5','33500915','N','B2','9','33500927','N','C1','5','33500940','N','C2','5','33500952','N','D','5','33500964','N','C1','5','33500976','N','D','5','33500988','N','D','5','33501002','S','A','5','33501040','N','C2','5','33501233','N','C2','5','33501282','N','C1','5','33501415','N','C2','5','33501440','N','A','5','33501452','N','C2','5','33501464','N','C2','5','33501476','N','B1','9','33501506','N','C2','5','33501520','N','C2','5','33501567','N','C1','5','33501610','N','C1','5','33501660','N','C1','5','33501671','N','C2','5','33501683','N','C2','5','33501695','S','B2','9','33501701','N','C2','5','33501713','N','C2','5','33501750','N','C2','5','33501762','N','B2','9','33501774','N','B2','9','33501786','N','D','5','33501804','N','C2','5','33501828','N','C2','5','33501830','N','C1','5','33501841','N','C1','5','33501889','N','A','5','33501932','N','C2','5','33502006','N','C2','5','33502109','N','C2','5','33502158','N','D','5','33502191','S','B2','9','33502389','N','C1','5','33502470','N','N','5','33502602','N','D','5','33502663','N','D','5','33502675','N','C2','5','33502687','N','C2','5','33502699','N','C2','5','33502705','N','C2','5','33502717','N','D','5','33502791','N','D','5','33502924','N','N','5','33502936','N','B1','9','33503000','N','B2','9','33503011','N','C1','5','33503023','N','A','5','33503035','S','B2','9','33503047','S','C1','5','33503059','S','C1','5','33503060','N','B1','9','33503084','N','B2','9','33503140','N','C2','5','33503230','N','C1','5','33503394','N','C1','5','33503485','N','C2','5','33503527','N','B1','9','33503539','N','C2','5','33503618','N','N','5','33503643','N','D','5','33503758','N','B2','9','33503771','N','C1','5','33503801','N','B2','9','33503837','N','C2','5','33503849','N','C2','5','33503989','N','C1','5','33504271','N','D','5','33504362','N','C1','5','33504416','N','C2','5','33504428','N','C2','5','33504684','N','D','5','33504714','N','N','5','33504805','N','B1','4','33504817','N','C1','5','33504829','N','B2','9','33504854','S','N','5','33504878','N','C2','5','33504880','N','C2','5','33504891','N','D','5','33504957','N','N','5','33505068','N','D','5','33505159','N','D','5','33505172','N','N','5','33505391','N','C2','5','33505421','N','C2','5','33505615','N','B2','9','33505627','N','D','5','33505780','N','C2','5','33505834','N','D','5','33505974','N','C1','5','33506085','N','D','5','33506127','N','D','5','33506255','N','B1','9','33506516','N','N','5','33506577','N','C1','5','33506589','N','N','5','33506620','N','C2','5','33506632','N','C2','5','33506656','N','C2','5','33506693','N','D','5','33506802','N','C2','5','33507028','N','N','5','33507041','N','N','5','33507170','N','D','5','33507181','N','A','5','33507752','N','N','5','33507788','N','C2','5','33507831','N','A','5','33507983','N','N','5','33508094','N','D','5','33508100','N','C2','5','33508355','N','D','5','33508641','N','C2','5','33509001','S','B2','9','33509025','N','A','4','33509037','N','A','4','33509165','N','C2','5','33509177','N','C1','5','33509189','N','C2','5','33509311','S','B1','9','33509323','N','B2','9','33509414','N','C2','5','33509440','N','C2','5','33509487','N','D','5','33509505','N','D','5','33509517','N','D','5','33509530','N','C2','5','33509580','N','D','5','33509610','N','D','5','33509621','N','D','5','33509682','N','A','5','33509712','N','C2','5','33509724','N','C2','5','33509748','N','C1','5','33509750','N','C1','5','33509815','N','C1','5','33509840','N','C2','5','33510027','N','C2','5','33510131','N','C2','5','33510386','N','C2','5','33510556','N','C1','5','33511032','N','C2','5','33511100','N','C2','5','33511743','N','C2','5','33512085','N','D','5','33512164','N','N','5','33512279','N','N','5','33512280','N','N','5','33512322','N','N','5','33512334','N','N','5','33512346','N','N','5','33512371','N','N','5','33512413','N','N','5','33512425','N','N','5','33512437','N','N','5','33512449','N','N','5','33512450','N','N','5','33512462','N','N','5','33512474','N','N','5','33512486','N','N','5','33512498','N','N','5','33512541','N','N','5','33512565','N','N','5','33512577','N','N','5','33512589','N','N','5','33512590','N','N','5','33512620','S','N','5','33512632','N','N','5','33512991','N','C1','5','33513820','S','N','5','33513831','S','N','5','33513855','S','N','5','33514549','N','N','5','33515633','N','N','5','33516157','N','N','5','33516170','N','N','5','33516182','N','N','5','33516601','N','C2','5','33517459','N','N','5','33517666','N','N','5','33518026','N','D','5','33518051','N','C2','5','33518099','N','C2','5','33518105','N','C2','5','33518130','N','N','5','33518245','N','C1','5','33519249','N','N','5','33519250','S','N','5','33519304','N','N','5','33519316','N','N','5','33519328','N','N','5','33519353','V','N','5','33519365','N','N','5','33519377','N','N','5','33519389','N','N','5','33519390','N','N','5','33519407','N','N','5','33519419','N','N','5','33519420','N','N','5','33519432','N','N','5','33519444','N','N','5','33519535','S','N','5','33519559','N','N','5','33519560','S','N','5','33519948','N','N','5','33520082','N','N','5','33520215','N','D','5','33520239','N','N','5','33524014','N','A','5','33524026','N','B2','9','33528767','N','N','5','33529681','N','N','5','33530464','N','N','5','33533556','N','N','5','33534639','N','D','5','33535243','N','D','5','33535401','N','C2','5','33537744','N','N','5','33539741','N','N','5','33540019','N','C2','5','33540020','N','C1','5','33540032','N','C2','5','33540160','N','B2','9','33540240','N','N','5','33540275','N','C1','5','33541322','N','C2','5','33541772','N','N','5','33541802','N','N','5','33541851','N','N','5','33542594','N','C2','5','33542600','N','C2','5','33542831','N','N','5','33543264','N','D','5','33544177','N','D','5','33544232','N','B2','9','33544268','N','C2','5','33544270','N','C2','5','33544300','N','D','5','33544311','N','D','5','33544359','N','C2','5','33544360','N','C1','5','33544440','N','C1','5','33544530','N','D','5','33544542','N','C2','5','33548730','N','D','5','33549710','N','N','5','33549722','N','N','5','33549734','S','N','5','33549965','N','C1','5','33550207','N','N','5','33550300','N','B2','9','33550566','N','C1','5','33551066','N','A','5','33551467','N','N','5','33552472','N','N','5','33552496','N','C2','5','33553415','V','N','5','33553427','N','N','5','33553762','N','C1','5','33554572','N','C2','5','33554663','N','B2','9','33556039','N','C1','5','33556143','N','D','5','33557196','N','N','5','33557901','N','C2','5','33557913','N','C1','5','33558693','N','N','5','33558784','N','N','5','33559715','N','C2','5','33560158','N','C2','5','33560365','N','C1','5','33560377','N','A','5','33560614','N','D','5','33561023','N','C1','5','33561059','N','C1','5','33561280','N','D','5','33561369','N','C2','5','33561424','N','C2','5','33561680','N','N','5','33561709','N','C2','5','33561710','N','C2','5','33562143','N','C1','5','33562167','N','N','5','33562740','N','C2','5','33563032','N','C2','5','33563081','N','D','5','33563093','N','D','5','33563585','N','D','5','33563986','N','C2','5','33564000','N','N','5','33564012','N','C2','5','33564206','N','N','5','33564632','N','D','5','33564978','N','C2','5','33564980','N','C2','5','33565077','N','C1','5','33565983','N','C1','5','33566008','N','C2','5','33566010','N','C2','5','33566100','N','C2','5','33566136','N','C2','5','33566173','N','C2','5','33566197','N','D','5','33566215','N','C1','5','33566239','N','C2','5','33566276','N','C2','5','33568080','S','N','5','33568091','N','D','5','33568108','N','C1','5','33568145','N','C2','5','33568297','N','D','5','33568420','N','D','5','33568431','N','C2','5','33568443','N','C2','5','33568455','N','C2','5','33568479','N','N','5','33569538','N','C2','5','33569757','N','D','5','33569769','N','D','5','33569873','N','C2','5','33570176','N','D','5','33570188','N','D','5','33570322','N','C1','5','33570371','N','C1','5','33570413','N','C2','5','33570450','N','C2','5','33570530','N','C2','5','33570553','N','D','5','33570589','N','C2','5','33570590','N','C2','5','33570670','N','C2','5','33570700','N','D','5','33570747','N','C1','5','33570759','N','B2','9','33570899','N','C2','5','33571144','N','C2','5','33571235','N','B1','9','33571594','N','B1','9','33571600','N','C2','5','33571612','N','C2','5','33571806','N','C1','5','33571831','N','N','5','33571879','N','C1','5','33572124','N','C2','5','33572203','N','C2','5','33572355','N','N','5','33572537','N','B2','9','33572550','N','C1','5','33572562','N','D','5','33572574','N','C1','5','33572926','N','C2','5','33575046','S','N','5','33575757','N','D','5','33575800','S','B2','9','33576294','N','N','5','33577067','N','B2','9','33577754','N','D','5','33577791','PN','B2','9','33577808','N','C2','5','33577810','N','D','5','33577821','N','C2','5','33580029','N','C2','5','33580042','N','C2','5','33580080','N','N','5','33580121','N','B1','9','33580133','N','N','5','33580145','N','C1','5','33580157','V','N','5','33580169','N','D','5','33580194','N','B1','9','33580297','N','C2','5','33580303','N','C2','5','33580959','N','N','5','33581812','N','C2','5','33582040','N','C2','5','33588119','N','N','5','33590151','N','C2','5','33590187','N','C2','5','33590199','N','B2','9','33590205','N','C2','5','33590217','N','C2','5','33590280','N','D','5','33590308','N','C2','5','33590310','N','C2','5','33590321','N','C2','5','33590333','N','C2','5','33590357','N','N','5','33590369','N','C2','5','33590370','N','C2','5','33590382','N','C2','5','33590394','N','C2','5','33590400','N','C2','5','33590412','N','C2','5','33590424','N','C2','5','33590436','N','C2','5','33590448','N','C2','5','33590450','N','C2','5','33590461','N','C2','5','33590473','N','C2','5','33590631','N','C2','5','33590643','N','C2','5','33590941','N','C2','5','33591015','N','C2','5','33591090','N','D','5','33591106','N','D','5','33591118','N','D','5','33591143','N','C2','5','33591167','N','C2','5','33591180','N','C2','5','33591209','N','D','5','33591234','N','C2','5','33591258','N','D','5','33591260','N','C2','5','33591301','N','D','5','33591337','N','C2','5','33591362','N','C2','5','33591374','N','C1','5','33591386','N','C2','5','33591404','N','D','5','33591416','N','C2','5','33591428','N','D','5','33591430','N','D','5','33591453','N','D','5','33591465','N','D','5','33591477','N','D','5','33591489','N','C2','5','33591490','N','D','5','33591507','N','D','5','33591519','N','D','5','33591520','N','D','5','33591532','N','D','5','33591570','N','D','5','33591593','N','D','5','33591611','N','D','5','33591623','N','D','5','33591635','N','D','5','33591866','N','C2','5','33591994','N','A','5','33592019','N','B2','9','33592020','N','C2','5','33592044','N','B1','9','33592056','N','D','5','33592159','N','C2','5','33592160','N','C2','5','33592251','N','C2','5','33593565','N','C1','5','33594004','N','N','5','33594818','N','C1','5','33595628','N','N','5','33595720','N','D','5','33596700','N','D','5','33597110','N','C2','5','33597145','N','C2','5','33597169','N','C2','5','33597170','N','B1','9','33597182','S','C1','5','33597194','S','B2','9','33597200','S','C2','5','33597236','N','C1','5','33597248','N','B2','9','33597261','N','B1','9','33597923','N','C2','5','33598022','N','C2','5','33598046','N','C2','5','33598060','N','C2','5','33598083','N','C2','5','33598368','N','D','5','33598393','N','C2','5','33598400','N','C2','5','33598411','N','C2','5','33598435','N','C1','5','33598447','N','D','5','33598460','N','D','5','33598538','N','C2','5','33598812','N','C2','5','33598848','N','C2','5','33598861','N','C2','5','33599014','N','C2','5','33599026','N','C2','5','33599038','N','C2','5','33599269','N','C2','5','33599397','N','C2','5','33599403','N','C2','5','33599452','N','C1','5','33599592','S','B1','9','33599609','N','C2','5','33599658','N','C2','5','33599660','N','C2','5','33599920','N','C2','5','33600790','N','C1','5','33600806','N','C1','5','33601665','N','C2','5','33601756','N','N','5','33601940','N','N','5','33601951','N','N','5','33602232','N','N','5','33602244','N','N','5','33603250','N','C2','5','33607564','N','N','5','33607576','N','N','5','33608908','N','C2','5','33609925','N','D','5','33610861','N','C2','5','33611853','N','C2','5','33612109','N','C2','5','33612249','N','C2','5','33612250','N','D','5','33612470','N','C1','5','33612717','N','C1','5','33613382','N','C2','5','33613618','N','C2','5','33613953','N','C2','5','33613977','N','C2','5','33614155','N','C2','5','33614568','N','D','5','33614635','N','C2','5','33615329','N','D','5','33615688','N','D','5','33616619','N','N','5','33617259','N','N','5','33617971','N','D','5','33618069','N','N','5','33618124','N','C2','5','33618197','N','C2','5','33618902','N','N','5','33619967','N','C2','5','33630082','N','C1','5','33630185','N','C2','5','33630240','N','C2','5','33631268','N','N','5','33633575','N','N','5','33643234','N','N','5','33643362','N','N','5','33647781','N','N','5','33649832','N','N','5','33649947','N','C2','5','33660530','N','C1','5','33670146','N','C2','5','33670160','N','C2','5','33670171','N','C2','5','33670237','N','C2','5','33670250','N','C2','5','33670419','N','C2','5','33670470','N','C2','5','33670500','N','C2','5','33670535','N','C2','5','33670572','N','C1','5','33670602','N','C2','5','33670626','N','C2','5','33670638','N','C2','5','33670705','N','C2','5','33670810','N','C2','5','33670845','N','C2','5','33670857','N','C2','5','33670882','N','C2','5','33670900','N','C1','5','33670924','N','C2','5','33670948','N','C2','5','33671000','N','C2','5','33671035','N','C2','5','33671096','N','C2','5','33671114','N','C2','5','33671175','N','C2','5','33671187','N','C2','5','33671199','N','C2','5','33671266','N','C1','5','33671310','N','C2','5','33671357','N','C2','5','33671424','N','D','5','33671503','N','N','5','33671618','N','C2','5','33671825','N','C2','5','33672064','N','C2','5','33672258','N','C2','5','33672349','N','C2','5','33672416','N','C2','5','33672441','N','C2','5','33672568','N','C2','5','33672593','N','C2','5','33672611','N','C1','5','33672623','N','C2','5','33672635','N','C1','5','33672647','N','C1','5','33672830','N','C2','5','33672970','N','C2','5','33673391','N','N','5','33673470','N','N','5','33673494','N','N','5','33673792','N','D','5','33674176','N','N','5','33674188','S','N','5','33674218','N','D','5','33674220','N','N','5','33674681','N','N','5','33674693','N','N','5','33676033','S','N','5','33676495','N','N','5','33676690','N','N','5','33677300','N','D','5','33679721','N','N','5','33679745','N','N','5','33679885','N','N','5','33680073','N','C1','5','33680383','N','D','5','33680401','N','C1','5','33680486','N','D','5','33680899','N','C2','5','33681144','N','N','5','33681223','N','N','5','33681235','N','C2','5','33681247','N','C2','5','33681259','N','C2','5','33681363','N','N','5','33681387','S','C2','5','33681697','N','N','5','33681764','N','D','5','33681909','N','N','5','33682203','N','C2','5','33682756','N','D','5','33682781','N','N','5','33682835','N','N','5','33682859','N','N','5','33683104','N','N','5','33683402','N','N','5','33683888','N','N','5','33685277','N','C2','5','33686993','N','N','5','33687006','N','D','5','33687160','N','N','5','33687493','N','N','5','33689957','N','N','5','33689969','N','N','5','33690674','N','D','5','33691289','N','C2','5','33691368','N','N','5','33691472','N','C1','5','33691484','N','C1','5','33692658','N','N','5','33692701','N','N','5','33692750','N','N','5','33692774','N','D','5','33693316','N','N','5','33694450','S','D','5','33694461','N','C2','5','33695878','N','N','5','33699173','N','N','5','33699525','N','N','5','33699987','N','N','5','33709816','N','D','5','33709828','N','D','5','33710193','N','N','5','33712414','N','N','5','33712580','N','N','5','33719457','N','N','5','33719469','N','N','5','33799921','N','D','5','33870597','N','C2','5','33970117','N','C1','5','33990748','N','D','5','33990750','N','D','5','34400000','N','C2','9','35040038','S','N','9','35160202','N','D','9','35160251','N','D','9','35160305','N','C2','9','35160354','N','C2','9','35160410','N','C2','9','35160858','N','C2','9','35160925','N','C1','9','35160937','N','B2','9','35160950','N','N','9','35160962','S','D','9','35160986','S','N','9','35161036','S','N','9','35161188','S','N','9','35162405','N','C1','9','35163100','N','C2','9','35163239','N','C2','9','35163240','N','C2','9','35164610','N','C2','9','35167051','N','C1','9','35169485','N','C1','9','35169643','V','N','9','35169655','V','N','9','35169667','N','N','9','35169679','V','N','9','35169680','V','N','9','35169692','N','N','9','35390141','N','C2','9','35390153','V','N','9','35860080','S','N','9','35860224','N','N','9','35930056','N','C2','9','36011083','N','C2','9','36017668','N','C2','9','36108030','N','C2','9','36108054','N','C2','9','36137741','N','C2','9','36210122','N','C2','9','36407148','N','C2','9','36407501','N','D','9','36410020','N','C2','9','36410123','N','D','9','36420037','N','C2','9','36420049','N','C2','9','36430018','N','C1','9','36430286','N','C2','9','36430304','N','C2','9','36437256','N','C2','9','36437610','N','D','9','36437670','PN','C2','9','36437682','N','C2','9','36437852','N','B2','9','36438492','N','D','9','36438509','N','D','9','36438522','N','C2','9','36438534','N','C2','9','36438546','N','C2','9','36438558','N','C2','9','36438571','N','C2','9','36438595','N','C2','9','36438650','N','C1','9','36438662','N','C1','9','36450042','N','C1','9','36450108','N','C2','9','36450145','N','C2','9','36458004','N','C1','9','36459884','N','C1','9','36630019','N','D','9','37128188','N','D','9','37128190','N','D','9','37130912','N','B2','9','37131060','N','B2','9','37134036','N','C2','9','37134139','N','C2','9','37147985','N','D','9','37154515','N','C1','9','37157218','N','C1','9','37320634','N','C2','9','37451923','N','C2','9','37452022','N','C2','9','37452149','N','D','9','37453452','N','C1','9','37551577','N','C2','9','37554037','N','D','9','37554220','N','C2','9','37554402','MC','C2','9','37555893','N','C2','9','37555972','N','D','12','37556540','N','C1','9','37559473','N','D','9','37982084','N','D','9','38016850','N','C2','5','38030019','N','C1','5','38030032','N','C1','5','38034633','MC','B2','9','38034645','S','C2','5','38034748','N','C2','5','38034750','V','N','5','38037350','S','A','4','38037452','S','A','4','38040177','S','B2','9','38040189','S','A','5','38040190','N','B2','9','38040864','N','D','5','38064510','N','D','4','38064522','S','D','4','38100174','N','B2','9','38100241','V','N','5','38100538','N','B1','9','38100540','N','C1','5','38100575','N','A','5','38100587','N','B1','9','38100630','N','D','5','38101336','N','B1','9','38101385','N','C1','5','38101397','N','C2','5','38101567','N','C2','5','38106097','MC','A','5','38106127','S','C1','5','38106139','S','C1','5','38106140','S','B1','9','38106152','S','C2','5','38106164','S','C2','5','38106188','N','B1','9','38106231','N','C1','5','38106309','N','A','5','38106310','S','B1','9','38106322','S','A','5','38106334','S','B1','9','38106346','S','A','5','38106360','S','C2','5','38106371','S','B2','9','38106401','S','A','5','38106437','N','C2','5','38106449','N','C1','5','38106504','N','B2','9','38106516','N','A','5','38106530','N','A','5','38106802','N','B2','9','38106814','V','N','5','38107120','N','C1','5','38107168','N','A','5','38107193','N','C2','5','38121050','N','C2','5','38123204','N','B1','9','38123228','N','C2','5','38123230','N','C2','5','38124105','N','C2','5','38124129','N','C2','5','38124130','N','C2','5','38124142','N','C2','5','38124154','N','C2','5','38124166','N','C2','5','38124178','N','C2','5','38124180','N','C2','5','38124282','N','C2','5','38124439','N','D','5','38125006','S','C1','5','38125018','S','C1','5','38125020','S','C2','5','38125031','N','C1','5','38125067','N','C1','5','38125110','N','C2','5','38125122','S','C2','5','38125134','S','C2','5','38125160','N','C2','5','38125171','S','B2','9','38125183','S','C2','5','38125225','S','B2','9','38125328','S','B2','9','38125511','S','C2','5','38125523','S','C2','5','38125584','N','B2','9','38125614','N','C2','5','38125651','S','C1','5','38125663','S','C1','5','38125705','N','C1','5','38125717','S','B2','9','38130026','N','A','5','38130350','N','C1','5','38130361','N','C2','5','38130397','N','A','5','38130403','N','D','5','38130713','N','A','5','38130725','N','A','5','38130750','N','A','5','38130762','N','C1','5','38130774','N','A','5','38130798','S','N','5','38130816','N','B1','9','38130828','N','C2','5','38130830','N','C2','5','38130841','N','C2','5','38131511','N','C2','5','38134100','N','D','5','38134299','N','N','5','38135000','N','C2','5','38135917','N','C2','5','38136077','N','B2','9','38136168','MC','A','5','38136181','S','B2','9','38136326','N','C1','5','38136338','N','C2','5','38137677','N','D','5','38140093','N','C1','5','38140135','N','B2','9','38140251','N','C2','5','38140305','N','C2','5','38140330','N','D','5','38140354','N','C2','5','38140469','N','N','5','38140536','N','C2','5','38140548','N','C2','5','38140550','N','C1','5','38140561','N','B2','9','38140573','N','B2','9','38140585','N','C2','5','38140597','N','C2','5','38140603','N','C2','5','38140615','N','B2','9','38140718','N','C2','5','38140767','N','C2','5','38140780','N','D','5','38140809','S','A','5','38140810','N','C2','5','38140834','N','C2','5','38140937','N','C2','5','38140949','S','B1','9','38141024','N','C2','5','38141073','N','C2','5','38141097','N','C1','5','38141127','N','C2','5','38141139','N','B2','9','38141176','N','C2','5','38141188','N','C2','5','38141190','N','C1','5','38141243','N','C2','5','38141267','N','C2','5','38141360','N','C2','5','38141772','N','C2','5','38141802','N','C2','5','38141929','N','C2','5','38142077','N','C1','5','38142089','N','B2','9','38142090','N','C1','5','38142107','N','C1','5','38142119','N','C1','5','38142120','N','B1','9','38142132','N','C1','5','38142144','N','C2','5','38142156','N','C2','5','38142168','N','C2','5','38142170','N','C2','5','38142181','N','C2','5','38142200','N','C2','5','38142776','N','C2','5','38142922','N','N','5','38142995','N','D','5','38143021','N','D','5','38143124','N','D','5','38143136','N','N','5','38143161','N','C2','5','38143215','N','C1','5','38143240','N','B2','9','38143290','N','C1','5','38145110','N','B2','9','38145224','N','D','5','38145595','N','C2','5','38145601','N','C1','5','38145820','N','C2','5','38145870','N','C1','5','38145893','S','C1','5','38145900','S','A','5','38145911','N','C2','5','38146605','S','B1','9','38146629','S','C2','5','38146630','S','C2','5','38146642','S','C1','5','38146654','N','C2','5','38146691','N','B2','9','38146708','N','C1','5','38146710','N','D','5','38146721','N','B2','9','38146733','N','C1','5','38147336','N','C1','5','38147403','N','C2','5','38147415','N','C2','5','38149370','N','C2','5','38149400','S','A','5','38149503','N','C2','5','38149515','S','C2','5','38149618','N','C2','5','38160110','N','C2','5','38160249','N','C2','5','38160262','N','D','5','38160432','N','C2','5','38160729','N','B2','9','38160894','N','C2','5','38160900','N','C2','5','38160948','N','C1','5','38160961','N','C2','5','38160973','N','C2','5','38160985','N','B2','9','38161000','S','C2','5','38161035','S','C2','5','38161047','S','C2','5','38161059','S','D','5','38161084','N','D','5','38161102','N','D','5','38161151','S','C2','5','38161163','S','B2','9','38161175','S','D','5','38161217','S','C2','5','38161278','S','D','5','38161308','N','C2','5','38161321','N','C1','5','38161333','N','C2','5','38161357','N','C2','5','38161369','N','C1','5','38161370','N','C2','5','38161382','N','B2','9','38161394','N','C2','5','38161850','N','N','5','38161928','N','C2','5','38162374','N','C1','5','38162404','N','A','5','38162416','N','C1','5','38162428','N','D','5','38162441','N','A','5','38162568','V','N','5','38162702','N','C2','5','38163044','N','N','5','38163240','S','C2','5','38163251','S','C2','5','38163287','N','C2','5','38163317','S','C2','5','38163329','S','C2','5','38163378','S','C2','5','38163391','N','C2','5','38163421','S','B1','9','38163445','S','B2','9','38163585','S','B2','9','38163615','S','C1','5','38163652','N','C1','5','38163822','S','A','5','38163834','S','C1','5','38163860','S','C1','5','38163871','S','B2','9','38164267','N','C2','5','38164413','MC','C1','5','38164425','N','B2','9','38164437','N','C2','5','38164498','N','B2','9','38164668','N','B1','9','38164670','N','A','5','38164681','S','A','5','38164693','S','D','5','38164723','S','C2','5','38164735','N','C2','5','38164899','N','C2','5','38164991','S','C1','5','38165156','N','C1','5','38165168','S','C2','5','38165211','S','B2','9','38165223','S','B2','9','38165235','N','C2','5','38165247','N','C1','5','38165260','S','D','5','38165272','S','D','5','38165430','N','C2','5','38165510','N','C2','5','38165648','N','D','5','38165650','N','C2','5','38165739','N','D','5','38166094','N','C2','5','38166100','N','C1','5','38169095','N','C2','5','38210010','N','C1','5','38230070','N','C2','5','38230082','N','C2','5','38230094','N','C2','5','38230100','N','C2','5','38230112','N','C2','5','38230124','N','C2','5','38230136','N','C2','5','38230148','N','C2','5','38230150','N','C1','5','38230173','N','C1','5','38290017','N','C2','5','38300217','N','B1','9','38300242','N','C2','5','38300280','N','C1','5','38300345','N','B2','9','38310016','N','D','5','38320071','N','C2','5','38320101','N','C2','5','38320630','N','C2','5','38320642','S','C2','5','38320654','N','C2','5','38320666','N','C2','5','38320678','N','C2','5','38320800','S','C1','5','38324180','MC','C1','5','38327200','N','C2','5','38330040','N','D','5','38354123','N','C2','5','38380018','N','C2','5','38380020','N','C2','5','38407590','N','D','5','38450094','N','C2','5','38450100','N','C2','5','38450112','N','C1','5','38450136','N','D','5','38450148','N','D','5','38450150','S','C1','5','38450161','N','C1','5','38450185','N','C2','5','38450197','N','D','5','38450203','S','C1','5','38450215','N','D','5','38450239','N','C2','5','38450240','N','D','5','38450252','N','C2','5','38450264','N','D','5','38450276','N','D','5','38450306','N','D','5','38450318','S','C2','5','38450367','S','C2','5','38450379','N','C2','5','38450409','N','B2','9','38450471','N','A','5','38450501','N','D','5','38450616','N','C2','5','38450770','N','C1','5','38450835','N','C2','5','38450872','N','B2','9','38450884','N','B1','9','38451347','N','N','5','38452029','N','C2','5','38452169','N','C2','5','38452212','N','C2','5','38452250','N','C2','5','38452352','N','C1','5','38452364','N','C2','5','38452376','N','C2','5','38452662','N','C2','5','38452819','N','C2','5','38454130','N','C2','5','38456035','N','C1','5','38456059','N','C2','5','38456060','N','B2','9','38456072','S','C1','5','38456084','S','C2','5','38457027','N','A','5','38457143','N','C2','5','38457155','N','C2','5','38457192','N','C1','5','38457209','N','C2','5','38457222','N','C2','5','38982444','N','D','5','38987119','N','D','5','38987170','N','D','5','38987296','N','D','5','38987405','N','D','5','38990271','N','D','5','38990295','N','D','5','38990313','N','D','5'];

		let setRelativePositioning = () => {
			var childElements = document.querySelectorAll("#CanvassHolder")[0].children;
			var numVisibleElements = 0;
			var firstVisibleChild;
			var firstVisibleChildName = "";
			var secondVisibleChild;
			var secondVisibleChildName = "";

			for (var i = 0; i < childElements.length; i++) {
				if (childElements[i].style.display == "block" || childElements[i].style.display == "flex") {
					if (numVisibleElements == 0) {
						firstVisibleChild = childElements[i];
						firstVisibleChildName = childElements[i].id;
					}
					if (numVisibleElements == 1) {
						secondVisibleChild = childElements[i];
						secondVisibleChildName = childElements[i].id;
					}
					numVisibleElements++;
				}
			}

			if (numVisibleElements == 2) {
				if (numVisibleElements == 2) {
					if ((firstVisibleChild.id == "s_2" && secondVisibleChild.id == "s_3") || (firstVisibleChild.id == "s_3" && secondVisibleChild.id == "s_4") || (firstVisibleChild.id == "s_2" && secondVisibleChild.id == "s_4")) {
						firstVisibleChild.style.position = "relative";
						secondVisibleChild.style.position = "relative";
					}
				}
			}
		};

		async function checkUrl(url) {
			try {
				const response = await fetch(url, { method: "HEAD" });

				if (response.ok) {
					return true;
				} else {
					return false;
				}
			} catch (error) {
				return false;
			}
		}

		let getDealerByPl = (pl) => {
			var plTrimmed = pl.substring(0, 4);
			var dealerName = "-";

			if (isNaN(pl) || pl.length > 8) {
				if (pl.substring(0, 2) == "33") {
					dealerName = "Ashok Kumar";
				}
				if (pl.substring(0, 2) == "38") {
					dealerName = "Surendra Prasad";
				}
			} else if (specialPlArray.includes(pl.substring(0, 8))) {
				dealerName = specialPlArray[specialPlArray.indexOf(pl.substring(0, 8)) + 1];
			} else {
				dealerPlArray.every((dealerPl) => {
					var plStart = dealerPl[0];
					var plEnd = dealerPl[1];

					if ((+plStart - +plTrimmed) * (+plEnd - +plTrimmed) <= 0) {
						dealerName = dealerPl[2];
						return false;
					} else {
						return true;
					}
				});
			}

			return dealerName;
		};

		let getItemNature = (pl) => {
			var itemNature = "";

			if (itemNatureArray.includes(pl)) {
				itemNature = itemNatureArray[itemNatureArray.indexOf(pl) + 1];
			}

			return itemNature;
		};

		let getItemCategory = (pl) => {
			var itemCategory = "";

			if (itemNatureArray.includes(pl)) {
				itemCategory = itemNatureArray[itemNatureArray.indexOf(pl) + 2];
			}

			return itemCategory;
		};

		let getItemCP = (pl) => {
			var itemCP = "";

			if (itemNatureArray.includes(pl)) {
				itemCP = itemNatureArray[itemNatureArray.indexOf(pl) + 3];
			}

			return +itemCP;
		};

		let showHistorySheet = (pl) => {
			var req = new XMLHttpRequest();
			req.open("GET", "https://ireps.gov.in/iMMS/depot/itempos/gethistsheet?rly=" + currentZoneCode + "&plno=" + pl, false);
			req.send(null);

			if (req.status == 200) {
				var parser = new DOMParser();
				var html = parser.parseFromString(req.responseText, "text/html");

				if (document.querySelectorAll(".hs_div")[0] == null || document.querySelectorAll(".hs_div")[0] == undefined) {
					var hs_div = document.createElement("div");
					hs_div.classList.add("hs_div");
					body.appendChild(hs_div);
				}

				var scrollTop = window.pageYOffset || document.body.scrollTop;

				document.querySelectorAll(".hs_div")[0].innerHTML = req.responseText;
				document.querySelectorAll(".hs_div")[0].style.display = "block";
				document.querySelectorAll(".hs_div")[0].style.top = scrollTop + "px";

				var button = document.createElement("button");
				var buttonText = document.createTextNode("Hide");
				button.addEventListener("click", (e) => {
					document.querySelectorAll(".hs_div")[0].style.display = "none";
				});

				button.appendChild(buttonText);
				document.querySelectorAll(".hs_div")[0].prepend(button);
			}
		};

		if (document.title != "System Start Page" && document.title != "Output of Report - LISTPOS") {
			setRelativePositioning();

			document.addEventListener("click", (e) => {
				setRelativePositioning();
			});

			titleBar = document.querySelectorAll("#TitleBar")[0];
			currentDepotCode = titleBar.querySelectorAll("td")[0].innerText.split(":")[2].substring(3, 5);
			currentZoneCode = titleBar.querySelectorAll("td")[0].innerText.split(":")[0].substring(1, 3);
			currentZone = "ECR";
			currentYear = new Date().getFullYear().toString();
		}

		if (document.title == "System Start Page") {
			document.addEventListener("click", (e) => {
				if (e.target.id.startsWith("Menu")) {
					var menuId = e.target.id;
					var menuContainer = e.target.closest("tr");
					var listContainer = menuContainer.nextElementSibling;

					var menuIndex;
					for (var i = 1; i < menuContainer.children.length; i++) {
						if (menuContainer.children[i].children[0] === e.target) {
							menuIndex = i;
						}
					}

					for (var j = 1; j < listContainer.children.length; j++) {
						if (j != menuIndex && j < +menuContainer.children.length - 2) {
							listContainer.children[j].querySelectorAll("span")[0].style.display = "none";
						}
					}

					var listOffsetTop;
					var listOffsetLeft;
					listOffsetTop = e.target.closest("tr").offsetHeight + 5;

					if (+e.target.offsetTop == 0 && +e.target.offsetLeft == 0) {
						listOffsetLeft = +e.clientX;
					} else if (+e.target.offsetTop > 0 && +e.target.offsetTop < 25) {
						listOffsetLeft = +e.target.offsetLeft;
					} else {
						listOffsetLeft = +e.target.offsetLeft;
					}

					if (menuIndex < +menuContainer.children.length - 2) {
						listContainer.children[menuIndex].style.cssText = "position: absolute !important; left: " + listOffsetLeft + "px !important; top: " + listOffsetTop + "px !important";
						listContainer.children[menuIndex].querySelectorAll("table")[0].removeAttribute("border");
						listContainer.children[menuIndex].querySelectorAll("table")[0].removeAttribute("cellpadding");
						listContainer.children[menuIndex].querySelectorAll("table")[0].removeAttribute("cellspacing");
					}
				}
			});
		}

		if (document.title == "Search Purchase Orders" || document.title == "Run Form - IMMIS/PUR/POSEARCH") {
			body.classList.add("po_search");

			var s_2 = document.querySelectorAll("#s_2")[0];
			var s_3 = document.querySelectorAll("#s_3")[0];

			var rlyButton = body.querySelectorAll("input[name='RLY_BTN_0']")[0];
			rlyButton.click();

			var LovDiv = document.querySelectorAll("#LovDiv")[0];
			var LovTable = body.querySelectorAll("#_LovTable")[0];
			LovTable.querySelectorAll("tbody")[0].lastChild.querySelectorAll("a")[0].click();

			var stockNS = document.querySelectorAll('select[name="STKNS_0"]')[0];
			stockNS.value = "%";

			var poSource = document.querySelectorAll('select[name="PO_SLOT_0"]')[0];
			poSource.value = "1";

			var poTo = document.querySelectorAll("#LBL_TB_DT_TO")[0].nextElementSibling.value;
			var poToArray = poTo.split("-");

			var poFromDay = +poToArray[0];
			var poFromMonth = poToArray[1];
			var poFromYear = +poToArray[2] - 1;

			poFromDay = poFromDay.toString().length == 2 ? poFromDay : "0" + poFromDay;

			var poFrom = poFromDay + "-" + poFromMonth + "-" + poFromYear;
			document.querySelectorAll("#LBL_TB_DT_FR")[0].nextElementSibling.value = poFrom;

			body.querySelectorAll("#s_2")[0].querySelectorAll("table")[0].querySelectorAll("tbody")[0].querySelectorAll("tr")[2].querySelectorAll("td")[3].setAttribute("colspan", "2");
			body.querySelectorAll("#s_2")[0].querySelectorAll("table")[0].querySelectorAll("tbody")[0].querySelectorAll("tr")[2].querySelectorAll("td")[4].setAttribute("colspan", "1");
			body.querySelectorAll("#s_2")[0].querySelectorAll("table")[0].querySelectorAll("tbody")[0].querySelectorAll("tr")[3].querySelectorAll("td")[4].setAttribute("colspan", "1");
			body.querySelectorAll("#s_2")[0].querySelectorAll("table")[0].querySelectorAll("tbody")[0].querySelectorAll("tr")[3].querySelectorAll("td")[4].style.display = "none";
			body.querySelectorAll("#s_2")[0].querySelectorAll("table")[0].querySelectorAll("tbody")[0].querySelectorAll("tr")[3].querySelectorAll("td")[5].setAttribute("colspan", "3");

			var buttonRow = body.querySelectorAll("#s_2")[0].querySelectorAll("table")[0].querySelectorAll("tbody")[0].querySelectorAll("tr")[3].lastChild;

			var button1 = document.createElement("button");
			var text1 = document.createTextNode("Backward 1 Year");
			button1.appendChild(text1);
			button1.classList.add("button");
			button1.classList.add("btnSunflower");

			var button2 = document.createElement("button");
			var text2 = document.createTextNode("Forward 1 Year");
			button2.appendChild(text2);
			button2.classList.add("button");
			button2.classList.add("btnSunflower");

			var button3 = document.createElement("button");
			var text3 = document.createTextNode("Last 6 Months");
			button3.appendChild(text3);
			button3.classList.add("button");
			button3.classList.add("btnSunflower");

			buttonRow.insertBefore(button2, buttonRow.children[0]);
			buttonRow.insertBefore(button1, buttonRow.children[0]);
			buttonRow.insertBefore(button3, buttonRow.children[0]);

			button1.addEventListener("click", function (event) {
				var dateFrom = body.querySelectorAll("#LBL_TB_DT_FR")[0].nextElementSibling.value;
				var dateTo = body.querySelectorAll("#LBL_TB_DT_TO")[0].nextElementSibling.value;

				var dateFromArray = dateFrom.split("-");
				var dateToArray = dateTo.split("-");
				var dateFromNew = dateFromArray[0] + "-" + dateFromArray[1] + "-" + (+dateFromArray[2] - 1);
				var dateToNew = dateFrom;

				body.querySelectorAll("#LBL_TB_DT_FR")[0].nextElementSibling.value = dateFromNew;
				body.querySelectorAll("#LBL_TB_DT_TO")[0].nextElementSibling.value = dateToNew;
				buttonRow.parentElement.previousElementSibling.previousElementSibling.lastChild.querySelectorAll("input")[0].click();
			});

			button2.addEventListener("click", function (event) {
				var dateFrom = body.querySelectorAll("#LBL_TB_DT_FR")[0].nextElementSibling.value;
				var dateTo = body.querySelectorAll("#LBL_TB_DT_TO")[0].nextElementSibling.value;

				var dateFromArray = dateFrom.split("-");
				var dateToArray = dateTo.split("-");
				var dateFromNew = dateTo;
				var dateToNew = dateToArray[0] + "-" + dateToArray[1] + "-" + (+dateToArray[2] + 1);

				body.querySelectorAll("#LBL_TB_DT_FR")[0].nextElementSibling.value = dateFromNew;
				body.querySelectorAll("#LBL_TB_DT_TO")[0].nextElementSibling.value = dateToNew;
				buttonRow.parentElement.previousElementSibling.previousElementSibling.lastChild.querySelectorAll("input")[0].click();
			});

			button3.addEventListener("click", function (event) {
				var dateFrom = body.querySelectorAll("#LBL_TB_DT_FR")[0].nextElementSibling.value;
				var dateTo = body.querySelectorAll("#LBL_TB_DT_TO")[0].nextElementSibling.value;

				var today = new Date();
				var currentDate = today.getDate();
				var currentMonth = today.getMonth();
				var currentYear = today.getFullYear().toString().substring(2, 4);
				var currentMonthName = monthArray[currentMonth];

				var newMonth = currentMonth >= 6 ? currentMonth - 6 : 12 + currentMonth - 6;
				var newYear = currentMonth >= 6 ? currentYear : +currentYear - 1;
				var newMonthName = monthArray[newMonth];

				var dateFromNew = currentDate + "-" + newMonthName + "-" + newYear;
				var dateToNew = currentDate + "-" + currentMonthName + "-" + currentYear;

				body.querySelectorAll("#LBL_TB_DT_FR")[0].nextElementSibling.value = dateFromNew;
				body.querySelectorAll("#LBL_TB_DT_TO")[0].nextElementSibling.value = dateToNew;
				buttonRow.parentElement.previousElementSibling.previousElementSibling.lastChild.querySelectorAll("input")[0].click();
			});

			document.addEventListener("click", (e) => {
				if (e.target.id == "s_0_7") {
					var table = LovDiv.querySelectorAll("#_LovTable")[0].querySelectorAll("tbody")[0];
					var lastRow = table.lastChild.cloneNode(true);
					table.prepend(lastRow);
				}
				if (e.target.name == "SHOW_BTN_0" || e.target.name == "FPAGE_0" || e.target.name == "PPAGE_0" || e.target.name == "NPAGE_0" || e.target.name == "LPAGE_0") {
					var poTable = document.querySelectorAll("#s_3")[0].querySelectorAll("table")[2];

					/*
                    var td1 = document.createElement("td");
                    var text1 = document.createTextNode("Bill Details");
                    td1.appendChild(text1);
                    poTable.querySelectorAll("thead")[0].querySelectorAll("tr")[0].appendChild(td1);
                    poTable.querySelectorAll("thead")[0].querySelectorAll("tr")[0].children[2].setAttribute("width", "5%");
                    poTable.querySelectorAll("thead")[0].querySelectorAll("tr")[0].children[5].setAttribute("width", "5%");
                    poTable.querySelectorAll("thead")[0].querySelectorAll("tr")[0].children[6].setAttribute("width", "10%");
                    poTable.querySelectorAll("thead")[0].querySelectorAll("tr")[0].children[12].setAttribute("width", "7%");
                    */

					var poRows = poTable.querySelectorAll("tbody")[1].children;
					/*
                    for (var i = 0; i < poRows.length - 1; i++) {
                        var poRow = poRows[i];
                        var poNo;
                        var poSerial;
                        var purchaseType;
                        var linkHref;

                        if (poRow.children.length == 13) {
                            poNo = poRow.children[1].innerText.split(" ")[0];
                            poSerial = poRow.children[5].innerText;
                            purchaseType = poNo.substring(8, 9) == "2" ? "GM" : "TN";

                            linkHref = "https://ireps.gov.in/iMMS/caseHistoryBillPOPopUp?poNumber=" + poNo + "&poSr=" + poSerial + "&rly=10&purType=" + purchaseType;
                        }

                        if (poRow.children.length == 10) {
                            var url = poRow.previousElementSibling.lastChild.querySelectorAll("a")[0].getAttribute("href");
                            var urlPart1 = url.substring(0, url.search("&poSr=") + 6);
                            var urlPart2 = url.substring(url.search("&rly="));
                            poSerial = poRow.children[2].innerText;

                            linkHref = urlPart1 + poSerial + urlPart2;
                        }

                        if (poRow.children.length == 8) {
                            var url = poRow.previousElementSibling.lastChild.querySelectorAll("a")[0].getAttribute("href");
                            var urlPart1 = url.substring(0, url.search("&poSr=") + 6);
                            var urlPart2 = url.substring(url.search("&rly="));
                            poSerial = poRow.children[0].innerText;

                            linkHref = urlPart1 + poSerial + urlPart2;
                        }

                        if (poRow.children.length == 13 || poRow.children.length == 10 || poRow.children.length == 8) {
                            var td2 = document.createElement("td");
                            var link = document.createElement("a");
                            var linkText = document.createTextNode("Bill Status");
                            link.appendChild(linkText);
                            link.title = "Check Bill Status";
                            link.href = linkHref;
                            link.target = "_blank";
                            td2.appendChild(link);
                            td2.setAttribute("align", "right");
                            poRow.appendChild(td2);
                        }
                    }
                    */
				}
				if (e.target.id.search("_LOV_PONO") != -1 || (e.target.tagName == "A" && e.target.closest("tr").children[0].children[0].id.search("_LOV_PONO") != -1)) {
					var rly = e.target.closest("tr").children[0].children[0].innerText;
					rlyButton.click();

					var rlys = LovTable.querySelectorAll("tbody")[0].children;

					for (var i = 0; i < rlys.length; i++) {
						if (rlys[i].children[0].innerText == rly) {
							rlys[i].children[0].querySelectorAll("a")[0].click();
							s_2.querySelectorAll("input[name='SHOW_BTN_0']")[0].click();
						}
					}
				}
			});

			var poNoInput = document.querySelectorAll("input[name='PO_NO_0']")[0];
			var descInput2 = document.querySelectorAll("input[name='DESC2_0']")[0];

			poNoInput.addEventListener("keyup", (e) => {
				if (s_2.querySelectorAll("input[name='RLYNM_0']")[0].value != "IR") {
					rlyButton.click();
					LovTable.querySelectorAll("tbody")[0].lastChild.querySelectorAll("a")[0].click();
					poNoInput.focus();
				}
			});

			poNoInput.addEventListener("paste", (e) => {
				if (s_2.querySelectorAll("input[name='RLYNM_0']")[0].value != "IR") {
					rlyButton.click();
					LovTable.querySelectorAll("tbody")[0].lastChild.querySelectorAll("a")[0].click();
					poNoInput.focus();
				}
			});

			poNoInput.addEventListener("keydown", (e) => {
				if (e.key === "Tab" || e.key === "Enter") {
					poNoInput.blur();
					poNoInput.nextElementSibling.click();
				}
			});

			descInput2.addEventListener("keydown", (e) => {
				if (e.key === "Tab" || e.key === "Enter") {
					document.querySelectorAll("input[name='SHOW_BTN_0']")[0].focus();
				}
			});
		}

		if (document.title == "Depot Transfer Transactions" || document.title == "Run Form - IMMIS/DEP/DTBT") {
			body.classList.add("depot_transfer");
		}

		if (document.title == "Availability Status of Items" || document.title == "Run Form - IMMIS/DEP/AVAILSTAT") {
			body.classList.add("availability");

			var s_2 = document.querySelectorAll("#s_2")[0];
			var divShowHtml1 = document.querySelectorAll("#divShowHtml1")[0];
			var divShowHtml2 = document.querySelectorAll("#divShowHtml2")[0];

			s_2.querySelectorAll("input[name='RLYNAME_0']")[0].removeAttribute("readonly");
			s_2.querySelectorAll("input[name='btn_LovRly_0']")[0].removeAttribute("disabled");

			var buttonShowStatus = s_2.querySelectorAll("input[name='btn_Stat_0']")[0];

			buttonShowStatus.addEventListener("click", (e) => {
				var availabilityTable = s_2.querySelectorAll(":scope > table")[1].querySelectorAll("div")[0].querySelectorAll(":scope > table")[1].querySelectorAll("tbody")[0].children;

				if (s_2.querySelectorAll("input[name='STKBASIS']")[2].checked == true) {
					for (var i = 0; i < availabilityTable.length - 1; i++) {
						var row = availabilityTable[i];

						if (i == 0) {
							row.querySelectorAll("th")[4].setAttribute("colspan", "12");
						} else if (i == 1) {
							var th = row.querySelectorAll("th")[6].cloneNode(true);
							th.innerText = "Adequacy";
							row.appendChild(th);
						} else if (i < availabilityTable.length - 2) {
							var numTotal = row.querySelectorAll("td")[2].innerText;
							var numZero = row.querySelectorAll("td")[4].innerText;
							var num0to1 = row.querySelectorAll("td")[5].innerText;
							var num1to2 = row.querySelectorAll("td")[6].innerText;
							var num2to3 = row.querySelectorAll("td")[7].innerText;
							var num3to6 = row.querySelectorAll("td")[8].innerText;
							var num6to12 = row.querySelectorAll("td")[9].innerText;
							var numAbove12 = row.querySelectorAll("td")[10].innerText;
							var numBelowAdequacy = +numZero + +num0to1 + +num1to2 + +num2to3 + +num3to6;
							var numAboveAdequacy = +num6to12 + +numAbove12;

							var adequacy = Math.round((+numAboveAdequacy / +numTotal) * 100);
							var td = row.querySelectorAll("td")[8].cloneNode(true);
							td.innerText = adequacy + "%";
							row.appendChild(td);
						} else {
							var numTotal = row.querySelectorAll("td")[1].innerText;
							var numZero = row.querySelectorAll("td")[3].innerText;
							var num0to1 = row.querySelectorAll("td")[4].innerText;
							var num1to2 = row.querySelectorAll("td")[5].innerText;
							var num2to3 = row.querySelectorAll("td")[6].innerText;
							var num3to6 = row.querySelectorAll("td")[7].innerText;
							var num6to12 = row.querySelectorAll("td")[8].innerText;
							var numAbove12 = row.querySelectorAll("td")[9].innerText;
							var numBelowAdequacy = +numZero + +num0to1 + +num1to2 + +num2to3 + +num3to6;
							var numAboveAdequacy = +num6to12 + +numAbove12;

							var adequacy = Math.round((+numAboveAdequacy / +numTotal) * 100);
							var td = row.querySelectorAll("td")[8].cloneNode(true);
							td.innerText = adequacy + "%";
							row.appendChild(td);
						}
					}
				}
			});

			document.addEventListener("click", (e) => {
				var id = e.target.id;
				if (id.startsWith("btnHSRow_")) {
					var today = new Date();

					var printButton = divShowHtml1.querySelectorAll("div")[0].querySelectorAll("input[value='Print']")[0];
					var printButtonOnClick = printButton.getAttribute("onclick");
					printButtonOnClick = printButtonOnClick.replace("Item Card for PL NO:", "HS");
					printButton.setAttribute("onclick", printButtonOnClick);

					var section_udm = divShowHtml1.querySelectorAll("#section_udm")[0];

					var tables = divShowHtml1.querySelectorAll(":scope > div")[1].querySelectorAll(":scope > table");
					var consumptionTable, uncoveredDuesTable, coveredDuesTable, underTransitTable, icTable, orderPlacedTable;

					for (i = 0; i < tables.length; i++) {
						if (tables[i].querySelectorAll("td")[0].innerText.trim() == "STOCK, AAC AND CONSUMPTION DETAILS") {
							consumptionTable = tables[i];
						}
						if (tables[i].querySelectorAll("td")[0].innerText.trim() == "UN-COVERED DUES DETAILS") {
							uncoveredDuesTable = tables[i];
						}
						if (tables[i].querySelectorAll("td")[0].innerText.trim() == "COVERED DUES DETAILS") {
							coveredDuesTable = tables[i];
							coveredDuesTable.classList.add("covered_dues_table");
						}
						if (tables[i].querySelectorAll("td")[0].innerText.trim() == "MATERIAL UNDER TRANSIT") {
							underTransitTable = tables[i];
						}
						if (tables[i].querySelectorAll("td")[0].innerText.trim() == "INSPECTION CERTIFICATE DETAILS") {
							icTable = tables[i];
						}
						if (tables[i].querySelectorAll("td")[0].innerText.trim() == "ORDERS PLACED DURING LAST 3 YEARS" || tables[i].querySelectorAll("td")[0].innerText.trim() == "ORDERS PLACED DURING LAST 5 YEARS") {
							orderPlacedTable = tables[i];
							orderPlacedTable.classList.add("orders_placed_table");
						}
					}

					var historySheetZone = tables[0].querySelectorAll("td")[0].innerText.split(":")[1].trim();
					var totalConsumptionLY = consumptionTable.querySelectorAll("tbody")[0].querySelectorAll("#stockdata_total")[0].children[3].innerText;
					var totalConsumptionCY = consumptionTable.querySelectorAll("tbody")[0].querySelectorAll("#stockdata_total")[0].children[4].innerText;
					var totalAAC = consumptionTable.querySelectorAll("tbody")[0].querySelectorAll("#stockdata_total")[0].children[5].innerText.split("(")[0];
					var totalStock = consumptionTable.querySelectorAll("tbody")[0].querySelectorAll("#stockdata_total")[0].children[6].innerText.split("(")[0].trim();
					var currentFY = consumptionTable.querySelectorAll("tbody")[0].querySelectorAll("tr")[2].querySelectorAll("td")[3].innerText;
					var dateFY = new Date("20" + currentFY.split("-")[0], 3, 1);
					var numDays = (today - dateFY) / (1000 * 60 * 60 * 24);
					var consumptionRateLY = Math.round(+totalConsumptionLY / 12);
					var consumptionRateCY = Math.round((+totalConsumptionCY / numDays) * 30);

					var uncoveredDues = uncoveredDuesTable.querySelectorAll("tbody")[0].children;

					for (i = 2; i < uncoveredDues.length; i++) {
						if (uncoveredDues[i].children[8]) {
							var dueDate = uncoveredDues[i].children[8].innerText;

							if (dueDate != "") {
								var tenderDueDate = new Date("20" + dueDate.split("/")[2], dueDate.split("/")[1] - 1, dueDate.split("/")[0]);
								var today = new Date();

								var dateDiff = Math.floor((today - tenderDueDate) / 86400000);

								uncoveredDues[i].children[8].innerText = dueDate + " (" + dateDiff + " days)";
							}
						}
					}

					var coveredDues = coveredDuesTable.querySelectorAll("tbody")[0].children;
					var cummulativeDueQty = 0;

					var receiptMonthArray = [];
					var receiptQtyArray = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
					var cbArray = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
					var consumptionRateArray = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];

					for (i = 0; i < 15; i++) {
						var mm = +today.getMonth() + i - Math.floor((today.getMonth() + i) / 12) * 12;
						var yy = +today.getFullYear().toString().substring(2, 4) + Math.floor((today.getMonth() + i) / 12);
						var mmyy = monthArray[mm] + ", " + yy;
						receiptMonthArray.push(mmyy);
					}

					for (i = 2; i < coveredDues.length; i++) {
						var coveredDue = coveredDues[i];
						var dueQty = 0;
						var dueDateText = "";
						var dueDate, dueMonth;

						if (coveredDue.children.length == 10) {
							dueQty = +coveredDue.children[7].innerText;
							dueDateText = coveredDue.children[9].innerText;

							dueDate = new Date("20" + dueDateText.split("/")[2], +dueDateText.split("/")[1] - 1, dueDateText.split("/")[0]);
							dueMonth = monthArray[+dueDateText.split("/")[1] - 1] + ", " + dueDateText.split("/")[2];

							var poHistoryButton = coveredDue.children[0].querySelectorAll("a")[1];
							coveredDue.children[0].appendChild(poHistoryButton);

							if (dueQty > 0 && dueDate < today) {
								coveredDue.children[7].style.color = "red";
								coveredDue.children[9].style.color = "red";
							}
						}

						if (coveredDue.children.length == 9) {
							dueQty = +coveredDue.children[6].innerText;
							dueDateText = coveredDue.children[8].innerText;

							dueDate = new Date("20" + dueDateText.split("/")[2], +dueDateText.split("/")[1] - 1, dueDateText.split("/")[0]);
							dueMonth = monthArray[+dueDateText.split("/")[1] - 1] + ", " + dueDateText.split("/")[2];

							if (dueQty > 0 && dueDate < today) {
								coveredDue.children[6].style.color = "red";
								coveredDue.children[8].style.color = "red";
							}
						}

						if (dueDate >= today && receiptMonthArray.includes(dueMonth)) {
							receiptQtyArray[receiptMonthArray.indexOf(dueMonth)] = receiptQtyArray[receiptMonthArray.indexOf(dueMonth)] + dueQty;
						}

						cummulativeDueQty += dueQty;
					}

					var cb = +totalStock;
					for (i = 0; i < cbArray.length; i++) {
						cb = +cb + +receiptQtyArray[i] - (+consumptionRateCY + +consumptionRateLY) / 2;
						cbArray[i] = cb;
						consumptionRateArray[i] = ((+consumptionRateCY + +consumptionRateLY) / 2) * 3;
					}

					if (cummulativeDueQty > 0) {
						var duesUnit = coveredDues[2].children[5].innerText;
						var coveredDuesHeader = coveredDues[0].querySelectorAll("strong")[0].innerText;
						var coveredDuesHeader2 = coveredDues[0].querySelectorAll("strong")[0].cloneNode(true);
						coveredDuesHeader2.innerText = " ( " + cummulativeDueQty + " " + duesUnit + " | " + Math.round((+cummulativeDueQty / +totalAAC) * 12 * 10) / 10 + " months )";
						coveredDues[0].children[0].appendChild(coveredDuesHeader2);
					}

					if (icTable != null && icTable != undefined) {
						var ic = icTable.querySelectorAll("tbody")[0].children;
						var orderPlaced = orderPlacedTable.querySelectorAll("tbody")[0].children;

						var td = document.createElement("td");
						var tdText = document.createTextNode("Depot");
						td.appendChild(tdText);
						td.setAttribute("width", "10%");
						ic[1].insertBefore(td, ic[1].children[4]);

						for (i = 2; i < ic.length; i++) {
							var poNo = ic[i].children[1].innerText.trim().substring(0, 14);
							var poSrNo = ic[i].children[3].innerText;
							var consignee;

							for (j = 2; j < orderPlaced.length; j++) {
								if (orderPlaced[j].children.length == 13 && orderPlaced[j].children[0].querySelectorAll("a")[0].innerText == poNo) {
									if (orderPlaced[j].children[1].innerText == poSrNo) {
										consignee = orderPlaced[j].children[2].innerText;
									} else {
										var k = 1;
										while (orderPlaced[j + k].children.length != 13) {
											if (orderPlaced[j + k].children[0].innerText == poSrNo) {
												consignee = orderPlaced[j + k].children[1].innerText;
											}
											k++;
										}
									}
								}
							}

							var td = document.createElement("td");
							var tdText = document.createTextNode(consignee);
							td.appendChild(tdText);
							ic[i].insertBefore(td, ic[i].children[4]);
						}
					}

					if (underTransitTable != null && underTransitTable != undefined) {
						var underTransit = underTransitTable.querySelectorAll("tbody")[0].children;
						var orderPlaced = orderPlacedTable.querySelectorAll("tbody")[0].children;

						var td = document.createElement("td");
						var tdText = document.createTextNode("Depot");
						td.appendChild(tdText);
						td.setAttribute("width", "10%");
						underTransit[1].insertBefore(td, underTransit[1].children[3]);

						for (i = 2; i < underTransit.length; i++) {
							var poNo = underTransit[i].children[1].innerText.trim().substring(8, 22);
							var poSrNo = underTransit[i].children[2].innerText;
							var consignee;

							for (j = 2; j < orderPlaced.length; j++) {
								if (orderPlaced[j].children.length == 13 && orderPlaced[j].children[0].querySelectorAll("a")[0].innerText == poNo) {
									if (orderPlaced[j].children[1].innerText == poSrNo) {
										consignee = orderPlaced[j].children[2].innerText;
									} else {
										var k = 1;
										while (orderPlaced[j + k].children.length != 13) {
											if (orderPlaced[j + k].children[0].innerText == poSrNo) {
												consignee = orderPlaced[j + k].children[1].innerText;
											}
											k++;
										}
									}
								}
							}

							var td = document.createElement("td");
							var tdText = document.createTextNode(consignee);
							td.appendChild(tdText);
							underTransit[i].insertBefore(td, underTransit[i].children[3]);
						}
					}

					if (orderPlacedTable != null && orderPlacedTable != undefined) {
						var orders = orderPlacedTable.querySelectorAll("tbody")[0].children;

						for (i = 2; i < orders.length; i++) {
							var order = orders[i];

							if (order.children.length == 13) {
								var poNo = order.children[0].querySelectorAll("a")[0].innerText;

								var a = document.createElement("a");
								a.setAttribute("href", "#");
								a.style.textDecoration = "underline";
								a.style.color = "red";
								a.setAttribute("onclick", "showIcHistReq('" + zoneJson[historySheetZone] + "', '" + poNo + "')");
								var img = document.createElement("img");
								img.setAttribute("src", "/ireps/images/common/GenerateLOA.png");
								img.setAttribute("height", "15");
								img.setAttribute("width", "15");
								img.setAttribute("border", "0");
								img.setAttribute("title", "Historical data of inspection and dispatch");

								a.appendChild(img);
								order.children[0].appendChild(a);

								if (+order.children[6].innerText > 0) {
									order.children[6].style.color = "red";
									order.children[6].style.fontWeight = "bold";
								}
								if (+order.children[7].innerText > 0) {
									order.children[7].style.color = "red";
									order.children[7].style.fontWeight = "bold";
								}
							}

							if (order.children.length == 12) {
								if (+order.children[5].innerText > 0) {
									order.children[5].style.color = "red";
									order.children[5].style.fontWeight = "bold";
								}
								if (+order.children[6].innerText > 0) {
									order.children[6].style.color = "red";
									order.children[6].style.fontWeight = "bold";
								}
							}
						}
					}
				}
			});
		}

		if (document.title == "Review / Act on Pending Demands" || document.title == "Run Form - IMMIS/PUR/DEMREVIEW") {
			body.classList.add("review_process_demand");

			var s_2 = document.querySelectorAll("#s_2")[0];
			var s_3 = document.querySelectorAll("#s_3")[0];
			var s_5 = document.querySelectorAll("#s_5")[0];

			document.addEventListener("click", (e) => {
				var id = e.target.id;
				if (id.includes("DropBtn")) {
					var scrollTop = window.pageYOffset || e.target.scrollTop || document.body.scrollTop;
					var s__cnvs5 = document.querySelectorAll("#s__cnvs5")[0];

					s_5.style.top = scrollTop + "px";
					s__cnvs5.style.top = scrollTop + "px";
				}

				if (e.target.name == "btn_Start_0") {
					var table = document.createElement("table");
					table.classList.add("dealer_wise_demand");
					var tbody = document.createElement("tbody");
					var tr1 = document.createElement("tr");
					var th1 = document.createElement("th");
					var th1Text = document.createTextNode("Name");
					th1.appendChild(th1Text);
					var th2 = document.createElement("th");
					var th2Text = document.createTextNode("< 1 Month");
					th2.appendChild(th2Text);
					var th3 = document.createElement("th");
					var th3Text = document.createTextNode("1 - 3 Months");
					th3.appendChild(th3Text);
					var th4 = document.createElement("th");
					var th4Text = document.createTextNode("3 - 6 Months");
					th4.appendChild(th4Text);
					var th5 = document.createElement("th");
					var th5Text = document.createTextNode("6 - 12 Months");
					th5.appendChild(th5Text);
					var th6 = document.createElement("th");
					var th6Text = document.createTextNode("> 12 Months");
					th6.appendChild(th6Text);
					var th7 = document.createElement("th");
					var th7Text = document.createTextNode("Total");
					th7.appendChild(th7Text);
					tr1.appendChild(th1);
					tr1.appendChild(th2);
					tr1.appendChild(th3);
					tr1.appendChild(th4);
					tr1.appendChild(th5);
					tr1.appendChild(th6);
					tr1.appendChild(th7);
					tbody.appendChild(tr1);

					var totalMonths0to1 = 0;
					var totalMonths1to3 = 0;
					var totalMonths3to6 = 0;
					var totalMonths6to12 = 0;
					var totalMonthsAbove12 = 0;

					var demandTable = s_3.querySelectorAll("div")[0].querySelectorAll("table")[0];
					var demandList = demandTable.querySelectorAll("tbody")[0].querySelectorAll("tr[id^=DemTR]");
					var demandPL = "";
					var dealerArray = [];
					var demandDistributionArray = [];

					for (var i = 0; i < demandList.length; i++) {
						var demandRow = demandList[i];
						var demandNo = demandRow.children[1].innerText;
						var demandDateText = demandRow.children[2].innerText;
						var demandDate = new Date("20" + demandDateText.split("-")[2], monthArray.indexOf(demandDateText.split("-")[1]), demandDateText.split("-")[0]);

						var today = new Date();
						var demandDays = Math.floor((today - demandDate) / 86400000);

						if (demandRow.previousElementSibling.querySelectorAll("th")[0] != undefined) {
							demandPL = demandRow.previousElementSibling.previousElementSibling.querySelectorAll("td")[0].querySelectorAll("strong")[0].innerText;
						} else if (demandRow.previousElementSibling.querySelectorAll("td")[0] != undefined && demandRow.previousElementSibling.querySelectorAll("td").length == 1) {
							demandPL = demandRow.previousElementSibling.querySelectorAll("td")[0].querySelectorAll("strong")[0].innerText;
						}

						var dealer = getDealerByPl(demandPL);
						var itemCP = getItemCP(demandPL);

						if (+itemCP <= 12) {
							if (dealerArray.includes(dealer)) {
								var distribution = demandDistributionArray[dealerArray.indexOf(dealer)];

								if (demandDays <= 30) {
									demandDistributionArray[dealerArray.indexOf(dealer)][1] = demandDistributionArray[dealerArray.indexOf(dealer)][1] + 1;
									totalMonths0to1++;
								} else if (demandDays > 30 && demandDays <= 90) {
									demandDistributionArray[dealerArray.indexOf(dealer)][2] = demandDistributionArray[dealerArray.indexOf(dealer)][2] + 1;
									totalMonths1to3++;
								} else if (demandDays > 90 && demandDays <= 180) {
									demandDistributionArray[dealerArray.indexOf(dealer)][3] = demandDistributionArray[dealerArray.indexOf(dealer)][3] + 1;
									totalMonths3to6++;
								} else if (demandDays > 180 && demandDays <= 365) {
									demandDistributionArray[dealerArray.indexOf(dealer)][4] = demandDistributionArray[dealerArray.indexOf(dealer)][4] + 1;
									totalMonths6to12++;
								} else if (demandDays > 365) {
									demandDistributionArray[dealerArray.indexOf(dealer)][5] = demandDistributionArray[dealerArray.indexOf(dealer)][5] + 1;
									totalMonthsAbove12++;
								}

								demandDistributionArray[dealerArray.indexOf(dealer)][6] = demandDistributionArray[dealerArray.indexOf(dealer)][6] + 1;
							} else {
								if (demandDays <= 30) {
									var distribution = [dealer, 1, 0, 0, 0, 0, 1];
									demandDistributionArray.push(distribution);
									dealerArray.push(dealer);
									totalMonths0to1++;
								} else if (demandDays > 30 && demandDays <= 90) {
									var distribution = [dealer, 0, 1, 0, 0, 0, 1];
									demandDistributionArray.push(distribution);
									dealerArray.push(dealer);
									totalMonths1to3++;
								} else if (demandDays > 90 && demandDays <= 180) {
									var distribution = [dealer, 0, 0, 1, 0, 0, 1];
									demandDistributionArray.push(distribution);
									dealerArray.push(dealer);
									totalMonths3to6++;
								} else if (demandDays > 180 && demandDays <= 365) {
									var distribution = [dealer, 0, 0, 0, 1, 0, 1];
									demandDistributionArray.push(distribution);
									dealerArray.push(dealer);
									totalMonths6to12++;
								} else if (demandDays > 365) {
									var distribution = [dealer, 0, 0, 0, 1, 0, 1];
									demandDistributionArray.push(distribution);
									dealerArray.push(dealer);
									totalMonthsAbove12++;
								}
							}
						}
					}

					demandDistributionArray.forEach((distribution) => {
						var dealer = distribution[0];
						var months0to1 = distribution[1];
						var months1to3 = distribution[2];
						var months3to6 = distribution[3];
						var months6to12 = distribution[4];
						var monthsAbove12 = distribution[5];
						var totalDemands = distribution[6];

						var tr2 = document.createElement("tr");
						var td1 = document.createElement("td");
						var td1Text = document.createTextNode(dealer);
						td1.appendChild(td1Text);
						var td2 = document.createElement("td");
						var td2Text = document.createTextNode(months0to1);
						td2.appendChild(td2Text);
						var td3 = document.createElement("td");
						var td3Text = document.createTextNode(months1to3);
						td3.appendChild(td3Text);
						var td4 = document.createElement("td");
						var td4Text = document.createTextNode(months3to6);
						td4.appendChild(td4Text);
						var td5 = document.createElement("td");
						var td5Text = document.createTextNode(months6to12);
						td5.appendChild(td5Text);
						var td6 = document.createElement("td");
						var td6Text = document.createTextNode(monthsAbove12);
						td6.appendChild(td6Text);
						var td7 = document.createElement("td");
						var td7Text = document.createTextNode(totalDemands);
						td7.appendChild(td7Text);
						tr2.appendChild(td1);
						tr2.appendChild(td2);
						tr2.appendChild(td3);
						tr2.appendChild(td4);
						tr2.appendChild(td5);
						tr2.appendChild(td6);
						tr2.appendChild(td7);
						tbody.appendChild(tr2);
					});

					var tr3 = document.createElement("tr");
					var td1 = document.createElement("td");
					var td1Text = document.createTextNode("Total");
					td1.appendChild(td1Text);
					var td2 = document.createElement("td");
					var td2Text = document.createTextNode(totalMonths0to1);
					td2.appendChild(td2Text);
					var td3 = document.createElement("td");
					var td3Text = document.createTextNode(totalMonths1to3);
					td3.appendChild(td3Text);
					var td4 = document.createElement("td");
					var td4Text = document.createTextNode(totalMonths3to6);
					td4.appendChild(td4Text);
					var td5 = document.createElement("td");
					var td5Text = document.createTextNode(totalMonths6to12);
					td5.appendChild(td5Text);
					var td6 = document.createElement("td");
					var td6Text = document.createTextNode(totalMonthsAbove12);
					td6.appendChild(td6Text);
					var td7 = document.createElement("td");
					var td7Text = document.createTextNode(+totalMonths0to1 + +totalMonths1to3 + +totalMonths3to6 + +totalMonths6to12 + +totalMonthsAbove12);
					td7.appendChild(td7Text);
					tr3.appendChild(td1);
					tr3.appendChild(td2);
					tr3.appendChild(td3);
					tr3.appendChild(td4);
					tr3.appendChild(td5);
					tr3.appendChild(td6);
					tr3.appendChild(td7);
					tbody.appendChild(tr3);

					table.appendChild(tbody);
					s_3.insertBefore(table, s_3.children[1]);
				}
			});
		}

		if (document.title == "IMMIS Proposal GeM PO Mapping" || document.title == "Run Form - IMMIS/PUR/GEM_PO_MAP") {
			body.classList.add("gem_po_mapping");

			document.addEventListener("click", (e) => {
				var id = e.target.id;
				if (id.includes("s_0_73")) {
					var s_9 = document.querySelectorAll("#s_9")[0];

					var poNo = s_9.querySelectorAll("table")[4].querySelectorAll("tr")[2].querySelectorAll("td")[0];
					var poYear = s_9.querySelectorAll("table")[4].querySelectorAll("tr")[2].querySelectorAll("td")[1].innerText.split("-")[2];

					var link = document.createElement("a");
					var linkText = document.createTextNode(poNo.innerText);
					link.appendChild(linkText);
					link.title = poNo.innerText;
					link.href = "https://ireps.gov.in/ireps/etender/pdfdocs/MMIS/PO/20" + poYear + "/" + zoneJson["ECR"] + "/" + poNo.innerText + ".pdf";
					link.target = "_blank";
					poNo.innerHTML = "";
					poNo.appendChild(link);
				}
			});
		}

		if (document.title == "Demand Registration (Non-Stock)" || document.title == "Run Form - IMMIS/PUR/DMDREGNS") {
			document.addEventListener("click", (e) => {
				var scrollTop = window.pageYOffset || e.target.scrollTop || document.body.scrollTop;

				if (e.target.title == "Return this Demand") {
                    var s_2 = document.querySelectorAll("#s_2")[0];
                    var s__cnvs4 = document.querySelectorAll("#s__cnvs4")[0];
                    scrollTop += 150;

                    s__cnvs4.style.top = scrollTop + "px";
                }
				if (e.target.title == "View Demand Details") {
					var divShowHtml1 = document.querySelectorAll("#divShowHtml1")[0];

					divShowHtml1.style.top = scrollTop + "px";
					divShowHtml1.style.maxWidth = "1024px";
					divShowHtml1.style.marginLeft = "calc(50% - 512px)";
				}
				if (e.target.title == "Click to See List of Values") {
					var LovDiv = document.querySelectorAll("#LovDiv")[0];

					LovDiv.style.top = e.target.getBoundingClientRect().top + 250 + "px";
					LovDiv.style.left = e.clientX + "px";

					LovDiv.scrollIntoView({ block: "end", inline: "nearest" });
				}
			});
		}

		if (document.title == "PO Modification" || document.title == "Run Form - IMMIS/PUR/POMA") {
			body.classList.add("po_modification");

			var s_2 = document.querySelectorAll("#s_2")[0];
			var s_3 = document.querySelectorAll("#s_3")[0];
			var s_4 = document.querySelectorAll("#s_4")[0];
			var s_6 = document.querySelectorAll("#s_6")[0];
			var s_7 = document.querySelectorAll("#s_7")[0];
			var s_8 = document.querySelectorAll("#s_8")[0];

			var buttonExit = s_2.querySelectorAll("input[name='btn_Exit_0']")[0];
			var buttonView = s_2.querySelectorAll("input[name='btn_ViewAuth_0']")[0];
			var buttonAuthorization = s_4.querySelectorAll("input[name='btn_MaNumber_0']")[0];

			let assignMAtoDealer = () => {
				var maList = s_6.querySelectorAll("[id^=TrMAList_]");
				var maNum = maList.length;

				var th = document.createElement("th");
				var thText = document.createTextNode("Dealer");
				th.appendChild(thText);
				th.style.textAlign = "left";
				maList[0].previousElementSibling.insertBefore(th, maList[0].previousElementSibling.children[6]);
				var maArray = [];
				var dealerArray = [];
				var poArray = [];

				for (i = 0; i < maList.length; i++) {
					var maRow = maList[i];
					var maReqDateText = maRow.children[3].innerText;
					var maReqDate = new Date("20" + maReqDateText.split("/")[2] + "-" + maReqDateText.split("/")[1] + "-" + maReqDateText.split("/")[0]);
					var today = new Date();
					var maDays = Math.floor((today - maReqDate) / 86400000);

					var poNo = maRow.children[5].innerText.substring(0, 15);
					var plNo = maRow.children[7].innerText.split("[")[1].split("]")[0];
					var dealer = getDealerByPl(plNo);

					maRow.children[5].querySelectorAll("a")[0].setAttribute("target", "_blank");

					var dealerText = "";

					if (poArray.includes(poNo)) {
						dealerText = dealer + " (*)";
					} else {
						dealerText = dealer;
					}

					var td = document.createElement("td");
					var tdText = document.createTextNode(dealerText);
					td.appendChild(tdText);
					maRow.insertBefore(td, maRow.children[6]);

					var maArray1 = [];
					maArray1.push(dealer);
					maArray1.push(maDays);
					maArray.push(maArray1);
					poArray.push(poNo);

					if (!dealerArray.includes(dealer)) {
						dealerArray.push(dealer);
					}
				}

				var maNumP = document.createElement("h3");
				var maNumText = document.createTextNode("PO Modification Requests Pending : " + maNum);
				maNumP.appendChild(maNumText);
				maNumP.addEventListener("click", (e) => {
					s_6.querySelectorAll(".dealer_wise_ma")[0].classList.toggle("visible");
				});
				maList[0].closest("div").insertBefore(maNumP, maList[0].closest("div").children[0]);

				var table = document.createElement("table");
				table.classList.add("dealer_wise_ma");
				var tbody = document.createElement("tbody");
				var tr1 = document.createElement("tr");
				var th1 = document.createElement("th");
				var th1Text = document.createTextNode("Name");
				th1.appendChild(th1Text);
				var th2 = document.createElement("th");
				var th2Text = document.createTextNode("0 - 7 days");
				th2.appendChild(th2Text);
				var th3 = document.createElement("th");
				var th3Text = document.createTextNode("8 - 14 days");
				th3.appendChild(th3Text);
				var th4 = document.createElement("th");
				var th4Text = document.createTextNode("15 - 28 days");
				th4.appendChild(th4Text);
				var th5 = document.createElement("th");
				var th5Text = document.createTextNode("> 28 days");
				th5.appendChild(th5Text);
				var th6 = document.createElement("th");
				var th6Text = document.createTextNode("Total");
				th6.appendChild(th6Text);
				var th7 = document.createElement("th");
				var th7Text = document.createTextNode("Avg Pendency (in days)");
				th7.appendChild(th7Text);
				tr1.appendChild(th1);
				tr1.appendChild(th2);
				tr1.appendChild(th3);
				tr1.appendChild(th4);
				tr1.appendChild(th5);
				tr1.appendChild(th6);
				tr1.appendChild(th7);
				tbody.appendChild(tr1);

				var totalDays0to7 = 0;
				var totalDays8to14 = 0;
				var totalDays15to28 = 0;
				var totalDaysAbove28 = 0;

				dealerArray.forEach((dealer) => {
					var days0to7 = 0;
					var days8to14 = 0;
					var days15to28 = 0;
					var daysAbove28 = 0;
					var totalMAPending = 0;
					var totalMADays = 0;
					var avgPendency = 0;

					maArray.forEach((ma) => {
						var maDealer = ma[0];
						var maDays = ma[1];

						if (maDealer == dealer) {
							if (maDays <= 7) {
								days0to7++;
								totalDays0to7++;
							}
							if (maDays > 7 && maDays <= 14) {
								days8to14++;
								totalDays8to14++;
							}
							if (maDays > 14 && maDays <= 28) {
								days15to28++;
								totalDays15to28++;
							}
							if (maDays > 28) {
								daysAbove28++;
								totalDaysAbove28++;
							}
							totalMADays += maDays;
							totalMAPending++;
						}
					});

					avgPendency = Math.round(totalMADays / totalMAPending);

					var tr2 = document.createElement("tr");
					var td1 = document.createElement("td");
					var td1Text = document.createTextNode(dealer);
					td1.appendChild(td1Text);
					var td2 = document.createElement("td");
					var td2Text = document.createTextNode(days0to7);
					td2.appendChild(td2Text);
					var td3 = document.createElement("td");
					var td3Text = document.createTextNode(days8to14);
					td3.appendChild(td3Text);
					var td4 = document.createElement("td");
					var td4Text = document.createTextNode(days15to28);
					td4.appendChild(td4Text);
					var td5 = document.createElement("td");
					var td5Text = document.createTextNode(daysAbove28);
					td5.appendChild(td5Text);
					var td6 = document.createElement("td");
					var td6Text = document.createTextNode(totalMAPending);
					td6.appendChild(td6Text);
					var td7 = document.createElement("td");
					var td7Text = document.createTextNode(avgPendency);
					td7.appendChild(td7Text);
					tr2.appendChild(td1);
					tr2.appendChild(td2);
					tr2.appendChild(td3);
					tr2.appendChild(td4);
					tr2.appendChild(td5);
					tr2.appendChild(td6);
					tr2.appendChild(td7);
					tbody.appendChild(tr2);
				});

				var tr3 = document.createElement("tr");
				var td1 = document.createElement("td");
				var td1Text = document.createTextNode("Total");
				td1.appendChild(td1Text);
				var td2 = document.createElement("td");
				var td2Text = document.createTextNode(totalDays0to7);
				td2.appendChild(td2Text);
				var td3 = document.createElement("td");
				var td3Text = document.createTextNode(totalDays8to14);
				td3.appendChild(td3Text);
				var td4 = document.createElement("td");
				var td4Text = document.createTextNode(totalDays15to28);
				td4.appendChild(td4Text);
				var td5 = document.createElement("td");
				var td5Text = document.createTextNode(totalDaysAbove28);
				td5.appendChild(td5Text);
				var td6 = document.createElement("td");
				var td6Text = document.createTextNode(maNum);
				td6.appendChild(td6Text);
				tr3.appendChild(td1);
				tr3.appendChild(td2);
				tr3.appendChild(td3);
				tr3.appendChild(td4);
				tr3.appendChild(td5);
				tr3.appendChild(td6);
				tbody.appendChild(tr3);

				table.appendChild(tbody);
				maList[0].closest("div").insertBefore(table, maList[0].closest("div").children[1]);
			};

			assignMAtoDealer();

			var maKeyInput = document.querySelectorAll("#s_2")[0].querySelectorAll("input[name='MAKEY_0']")[0];

			document.addEventListener("click", (e) => {
				if (e.target.name == "btn_Refresh_0") {
					assignMAtoDealer();
				}
				if (e.target.name == "btn_Hide_0") {
					maKeyInput.focus();
				}
                if (e.target.title == "View/Authorize M.A.") {
                    var scrollTop = window.pageYOffset || e.target.scrollTop || document.body.scrollTop;
                    var s__cnvs26 = document.querySelectorAll("#s__cnvs26")[0];
                    s_7.style.top = scrollTop + "px";
                    s__cnvs26.style.top = scrollTop + "px";
                    var s_7cssText = s_7.style.cssText;
                    var s_7cssTextNew = s_7cssText.slice(0, s_7cssText.indexOf("width:") - 2) + " !important" + s_7cssText.slice(s_7cssText.indexOf("width:") - 2);
                    s_7.style.cssText = s_7cssTextNew;
                }
				if (e.target.name == "btn_ViewAuth_0") {
					buttonAuthorization.focus();
				}
			});

			maKeyInput.addEventListener("keydown", (e) => {
				if (e.key === "Tab" || e.key === "Enter") {
					s_2.querySelectorAll("input[name='btn_ViewAuth_0']")[0].focus();
				}
			});

			document.addEventListener("keydown", (e) => {
				if (e.key === "Escape") {
					if (s_4.style.display == "block") {
						s_4.style.display = "none";
						s_8.style.display = "none";
					} else if (s_6.style.display == "block") {
						s_6.style.display = "none";
					} else {
						buttonExit.click();
						maKeyInput.focus();
					}
				}
			});
		}

		if ((document.title == "Purchase Order Generation" || document.title == "Run Form - IMMIS/PUR/ORDERGEN") && document.querySelectorAll("input[name='BTN_SHOW_0']")[0] != undefined) {
            body.classList.add("po_generation");

            var s_4 = document.querySelectorAll("#s_4")[0];
            var s_10 = document.querySelectorAll("#s_10")[0];
            var s_15 = document.querySelectorAll("#s_15")[0];
            var s_18 = document.querySelectorAll("#s_18")[0];

            var poKeyInput = document.querySelectorAll("#s_3")[0].querySelectorAll("#s_0_147")[0];

            if (poKeyInput != null && poKeyInput != undefined) {
                poKeyInput.focus();
                poKeyInput.addEventListener("keydown", (e) => {
                    if (e.key === "Tab" || e.key === "Enter") {
                        document.querySelectorAll("#s_2")[0].querySelectorAll("#s_0_27")[0].focus();
                    }
                });
            }

            var buttonExit = s_4.querySelectorAll("input[name='EXIT_BTN_0']")[0];
            var buttonView = s_4.querySelectorAll("input[name='NUM_BTN_0']")[0];
            var buttonAuthorization = s_10.querySelectorAll("input[name='btn_PoNumber_0']")[0];
            var buttonfundConfirmation = s_18.querySelectorAll("input[name='PROCEED_0']")[0];

            document.addEventListener("keydown", (e) => {
                if (e.key === "Escape") {
                    if (s_10.style.display == "block") {
                        s_10.style.display = "none";
                        s_15.style.display = "none";
                        buttonExit.click();
                    } else {
                        buttonExit.click();
                    }
                }
            });

            document.addEventListener("click", (e) => {
                if (e.target.id.search("_LOV_PO") != -1 || (e.target.tagName == "A" && e.target.closest("tr").children[0].children[0].id.search("_LOV_PO") != -1)) {
                    buttonView.focus();
                }
            });

            buttonView.addEventListener("click", (e) => {
                buttonAuthorization.focus();
            });

            buttonAuthorization.addEventListener("click", (e) => {
                s_15.querySelectorAll("input[name='btn_Ok_0']")[0].focus();
            });

            buttonfundConfirmation.addEventListener("click", (e) => {
                s_15.querySelectorAll("input[name='btn_Ok_0']")[0].focus();
            });
        }

        if ((document.title == "Purchase Order Generation" || document.title == "Run Form - IMMIS/PUR/ORDER") && document.querySelectorAll("input[name='BTN_SHOW_0']")[0] == undefined) {
            body.classList.add("po_preparation");
        }

		if (document.title == "Publish Tender Document" || document.title == "Run Form - IMMIS/PUR/TENDERNEW") {
			body.classList.add("tender_publishing");

			var s_2 = document.querySelectorAll("#s_2")[0];
			var s_6 = document.querySelectorAll("#s_6")[0];
			var s_13 = document.querySelectorAll("#s_13")[0];
			var s_17 = document.querySelectorAll("#s_17")[0];
			var s_23 = document.querySelectorAll("#s_23")[0];

			document.addEventListener("click", (e) => {
				if (e.target.title == "Click OK to publish tender to IREPS") {
					var tenderNo = body.querySelectorAll("input[name='TENDER_NO_0']")[0].value;
					var tenderValue = +body.querySelectorAll("input[name='ESTD_VALUE_0']")[0].value;
					var tod = body.querySelectorAll("input[name='DUE_DATE_0']")[0].value;
					var tenderType = "";

					if (+tenderValue > 0 && +tenderValue <= 1000000) {
						tenderType = "SS DA";
					} else if (+tenderValue > 1000000 && +tenderValue <= 5000000) {
						tenderType = "JAG DA";
					} else if (+tenderValue > 5000000 && +tenderValue <= 10000000) {
						tenderType = "SS TC";
					} else if (+tenderValue > 10000000 && +tenderValue <= 100000000) {
						tenderType = "JAG TC";
					} else if (+tenderValue > 100000000 && +tenderValue <= 500000000) {
						tenderType = "SAG TC";
					}

					window.open("https://docs.google.com/forms/d/e/1FAIpQLSerWA27snuLdU5MPDlW_NFkQuWm7lNONd9VBOfkOOiF8k13dw/formResponse?usp=pp_url&entry.735724294=" + tenderNo + "&entry.801071618=" + tenderValue + "&entry.252628659=" + tod + "&submit=Submit", "_blank");
				}

				if (e.target.id.search("_LOV_TENDER") != -1 || (e.target.tagName == "A" && e.target.closest("tr").children[0].children[0].id.search("_LOV_TENDER") != -1)) {
					var tenderValue = document.querySelectorAll("input[name='ESTD_VALUE_0']")[0].value;
					var tenderType = "";

					if (+tenderValue > 0 && +tenderValue <= 1000000) {
						tenderType = "SS DA";
					} else if (+tenderValue > 1000000 && +tenderValue <= 5000000) {
						tenderType = "JAG DA";
					} else if (+tenderValue > 5000000 && +tenderValue <= 10000000) {
						tenderType = "SS TC";
					} else if (+tenderValue > 10000000 && +tenderValue <= 100000000) {
						tenderType = "JAG TC";
					} else if (+tenderValue > 100000000 && +tenderValue <= 500000000) {
						tenderType = "SAG TC";
					}

					if (document.querySelectorAll("input[name='ESTD_VALUE_0']")[0].parentElement.children.length == 1) {
						var span = document.createElement("span");
						var spanText = document.createTextNode(tenderType);
						span.appendChild(spanText);
						span.style.marginLeft = "10px";
						span.style.fontWeight = "bold";

						if (+document.querySelectorAll("input[name='ESTD_VALUE_0']")[0].value > 2500000) {
							span.style.color = "red";
						} else {
							span.style.color = "black";
						}
						document.querySelectorAll("input[name='ESTD_VALUE_0']")[0].parentElement.appendChild(span);
					} else {
						document.querySelectorAll("input[name='ESTD_VALUE_0']")[0].nextElementSibling.innerText = tenderType;

						if (+document.querySelectorAll("input[name='ESTD_VALUE_0']")[0].value > 2500000) {
							document.querySelectorAll("input[name='ESTD_VALUE_0']")[0].nextElementSibling.style.color = "red";
						} else {
							document.querySelectorAll("input[name='ESTD_VALUE_0']")[0].nextElementSibling.style.color = "black";
						}
					}

					var accountingUnitSelect = s_2.querySelectorAll("input[name='BTN_AUCODE_0']")[0];
					accountingUnitSelect.click();
					document.querySelectorAll("#LovDiv")[0].querySelectorAll("a")[0].click();
					var buttonAuthorization = s_2.querySelectorAll("input[name='btn_ViewAuth_0']")[0];
					buttonAuthorization.focus();
				}

				if (e.target.classList.contains("enter_standard_details")) {
					var insp_agency_0 = document.querySelectorAll("select[name='INSP_AGENCY_0']")[0];
					insp_agency_0.selectedIndex = 0;

					var insp_type_0 = document.querySelectorAll("select[name='INSP_TYPE_0']")[0];
					insp_type_0.selectedIndex = 0;

					var prod_cat_0 = document.querySelectorAll("select[name='PROD_CAT_0']")[0];
					prod_cat_0.selectedIndex = 0;

					var stage_yn_0 = document.querySelectorAll("select[name='STAGE_YN_0']")[0];
					stage_yn_0.selectedIndex = 0;

					var stage_no_0 = document.querySelectorAll("select[name='STAGE_NO_0']")[0];
					stage_no_0.selectedIndex = 0;

					var qty_tol_aplcbl_0 = document.querySelectorAll("select[name='QTY_TOL_APLCBL_0']")[0];
					qty_tol_aplcbl_0.selectedIndex = 0;

					var qty_tol_itemcat_0 = document.querySelectorAll("select[name='QTY_TOL_ITEMCAT_0']")[0];
					qty_tol_itemcat_0.selectedIndex = 0;

					var qty_tol_prnct_0 = document.querySelectorAll("input[name='QTY_TOL_PRNCT_0']")[0];
					qty_tol_prnct_0.value = 5;
				}

				if (e.target.getAttribute("name") == "btn_ViewAuth_0") {
					s_13.querySelectorAll("input[name='btn_Auth_0']")[0].focus();
				}

				if (e.target.getAttribute("name") == "btn_Auth_0") {
					var div1 = document.createElement("div");
					var span1 = document.createElement("span");
					var span1Text = document.createTextNode("Tender Value: Rs " + document.querySelectorAll("input[name='ESTD_VALUE_0']")[0].value);
					span1.appendChild(span1Text);
					var span2 = document.querySelectorAll("input[name='ESTD_VALUE_0']")[0].nextElementSibling.cloneNode(true);
					div1.appendChild(span1);
					div1.appendChild(span2);
					div1.style.paddingTop = "15px";
					div1.style.textAlign = "center";
					s_17.querySelectorAll("#optTable1")[0].parentElement.appendChild(div1);
				}

				if (e.target.id.search("btnItemRow_") != -1) {
					var lineItemTable = s_6.querySelectorAll("table")[0].querySelectorAll("tbody")[0];

					lineItemTable.children[0].children[0].setAttribute("colspan", "14");
					lineItemTable.children[2].children[0].setAttribute("colspan", "1");
					lineItemTable.children[2].children[1].setAttribute("colspan", "2");
					lineItemTable.children[3].children[0].setAttribute("colspan", "1");
					lineItemTable.children[3].children[1].setAttribute("colspan", "1");
					lineItemTable.children[3].children[2].setAttribute("colspan", "1");
					lineItemTable.children[3].children[3].setAttribute("colspan", "5");
					lineItemTable.children[4].children[0].setAttribute("colspan", "1");
					lineItemTable.children[4].children[1].setAttribute("colspan", "13");
					lineItemTable.children[5].children[0].setAttribute("colspan", "1");
					lineItemTable.children[5].children[1].setAttribute("colspan", "13");
					lineItemTable.children[6].children[0].setAttribute("colspan", "1");
					lineItemTable.children[6].children[1].setAttribute("colspan", "13");
					lineItemTable.children[7].children[0].setAttribute("colspan", "1");
					lineItemTable.children[7].children[1].setAttribute("colspan", "5");
					lineItemTable.children[7].children[2].setAttribute("colspan", "1");
					lineItemTable.children[7].children[3].setAttribute("colspan", "1");
					lineItemTable.children[7].children[4].setAttribute("colspan", "1");
					lineItemTable.children[7].children[5].setAttribute("colspan", "1");
					lineItemTable.children[8].children[0].setAttribute("colspan", "1");
					lineItemTable.children[8].children[1].setAttribute("colspan", "1");
					lineItemTable.children[9].children[0].setAttribute("colspan", "4");
					lineItemTable.children[9].children[1].setAttribute("colspan", "2");
					lineItemTable.children[9].children[2].setAttribute("colspan", "2");
					lineItemTable.children[9].children[3].setAttribute("colspan", "1");
					lineItemTable.children[9].children[4].setAttribute("colspan", "1");
					lineItemTable.children[10].children[0].setAttribute("colspan", "4");
					lineItemTable.children[10].children[1].setAttribute("colspan", "2");
					lineItemTable.children[10].children[2].setAttribute("colspan", "2");
					lineItemTable.children[10].children[3].setAttribute("colspan", "6");
					lineItemTable.children[11].children[0].setAttribute("colspan", "4");

					lineItemTable.children[5].children[1].querySelectorAll("input[name='BTN_ADD_EDIT_INSPDTLS_0']")[0].value = "Inspection/Tolerance";
					lineItemTable.children[5].children[1].querySelectorAll("input[name='BTN_UVM_LNK_0']")[0].value = "Link UVAM ID";
				}
			});

			var tenderNoInput = document.querySelectorAll("input[name='TENDER_NO_0']")[0];
			tenderNoInput.focus();
			tenderNoInput.addEventListener("keydown", (e) => {
				if (e.key === "Tab" || e.key === "Enter") {
					var tenderValue = document.querySelectorAll("input[name='ESTD_VALUE_0']")[0].value;
					var tenderType = "";

					if (+tenderValue > 0 && +tenderValue <= 1000000) {
						tenderType = "SS DA";
					} else if (+tenderValue > 1000000 && +tenderValue <= 5000000) {
						tenderType = "JAG DA";
					} else if (+tenderValue > 5000000 && +tenderValue <= 10000000) {
						tenderType = "SS TC";
					} else if (+tenderValue > 10000000 && +tenderValue <= 100000000) {
						tenderType = "JAG TC";
					} else if (+tenderValue > 100000000 && +tenderValue <= 500000000) {
						tenderType = "SAG TC";
					}

					if (document.querySelectorAll("input[name='ESTD_VALUE_0']")[0].parentElement.children.length == 1) {
						var span = document.createElement("span");
						var spanText = document.createTextNode(tenderType);
						span.appendChild(spanText);
						span.style.marginLeft = "10px";
						span.style.fontWeight = "bold";

						if (+document.querySelectorAll("input[name='ESTD_VALUE_0']")[0].value > 2500000) {
							span.style.color = "red";
						} else {
							span.style.color = "black";
						}
						document.querySelectorAll("input[name='ESTD_VALUE_0']")[0].parentElement.appendChild(span);
					} else {
						document.querySelectorAll("input[name='ESTD_VALUE_0']")[0].nextElementSibling.innerText = tenderType;

						if (+document.querySelectorAll("input[name='ESTD_VALUE_0']")[0].value > 2500000) {
							document.querySelectorAll("input[name='ESTD_VALUE_0']")[0].nextElementSibling.style.color = "red";
						} else {
							document.querySelectorAll("input[name='ESTD_VALUE_0']")[0].nextElementSibling.style.color = "black";
						}
					}

					if (tenderValue > 0) {
						var accountingUnitSelect = s_2.querySelectorAll("input[name='BTN_AUCODE_0']")[0];
						accountingUnitSelect.click();
						document.querySelectorAll("#LovDiv")[0].querySelectorAll("a")[0].click();
						var buttonAuthorization = s_2.querySelectorAll("input[name='btn_ViewAuth_0']")[0];
						buttonAuthorization.focus();
					}
				}
			});
            tenderNoInput.addEventListener("keyup", (e) => {
				var pastedContent = tenderNoInput.value;
                var trimmedContent = pastedContent.trim();
                tenderNoInput.value = trimmedContent;
			});

			var s_25 = document.querySelectorAll("#s_25")[0];
			var buttonSave = s_25.querySelectorAll("input[name='BTN_SAVE_0']")[0];

			var button1 = document.createElement("button");
			var text1 = document.createTextNode("Enter Standard Details");
			button1.appendChild(text1);
			button1.classList.add("button");
			button1.classList.add("btnSunflower");
			button1.classList.add("enter_standard_details");
			buttonSave.parentElement.insertBefore(button1, buttonSave);

			var s_13 = document.querySelectorAll("#s_13")[0];
			var buttonExit = s_2.querySelectorAll("input[name='btn_Exit_0']")[0];
			document.addEventListener("keydown", (e) => {
				if (e.key === "Escape") {
					if (s_13.style.display == "block") {
						s_13.style.display = "none";
						s_23.style.display = "none";
					} else {
						buttonExit.click();
						tenderNoInput.focus();
					}
				}
			});
		}

		if (document.title == "Coverage Status of Non-Stock Demands" || document.title == "Run Form - IMMIS/PUR/NSDMDSTAT") {
			body.classList.add("ns_demand_status");
		}

		if (document.title == "Coverage Status of stock Demands" || document.title == "Run Form - IMMIS/PUR/STKDMDSTAT") {
			body.classList.add("ns_demand_status");
		}

		if (document.title == "Position of Items" || document.title == "Run Form - IMMIS/PUR/ITEMPOS") {
			body.classList.add("item_position");
			var divShowHtml1 = document.querySelectorAll("#divShowHtml1")[0];
			var divShowHtml2 = document.querySelectorAll("#divShowHtml2")[0];

			GM_xmlhttpRequest({
				method: "GET",
				url: "https://cdn.jsdelivr.net/npm/chart.js",
				onload: (ev) => {
					let e = document.createElement("script");
					e.innerText = ev.responseText;
					document.head.appendChild(e);
				},
			});

			var canvas_div = document.createElement("div");
			canvas_div.id = "canvas_div";
			var canvas = document.createElement("canvas");
			canvas.id = "chart_canvas";
			canvas_div.appendChild(canvas);
			body.appendChild(canvas_div);

			var consigneeArray = ["C&W/SUPDT/OBRADAM", "H.TXR/PATRATU", "Sr.SE/C&W/IC/PEH", "CWS/BOXN/ROH/BRWD", "SRSE/CS/RS/DHN"];

			var i, j;

			document.addEventListener("click", (e) => {
				if (e.target.closest("div") !== null && e.target.closest("div").id == "section_udm") {
					var consigneeTable = divShowHtml1.querySelectorAll("div")[1].querySelectorAll("tbody")[0].querySelectorAll("tr");

					for (var i = 2; i < consigneeTable.length; i++) {
						var consigneeRow = consigneeTable[i];
						var consignee = consigneeRow.querySelectorAll("td")[0].innerText;
						var consigneeName = consignee.split(" ")[2];

						/*if (!consigneeArray.includes(consigneeName)) {
                                        consigneeRow.style.display = "none";
                                    }*/
					}
				}

				if ((e.target.tagName == "INPUT" && e.target.name == "BTN_HST_0" && divShowHtml1.querySelectorAll("table")[0].querySelectorAll("tr")[0].innerText.startsWith("Item Card for PL NO:")) || (e.target.tagName == "INPUT" && e.target.name.includes("HS") && e.target.name.includes("_0") && divShowHtml1.querySelectorAll("table")[0].querySelectorAll("tr")[0].innerText.startsWith("Item Card for PL NO:"))) {
					var today = new Date();

					var printButton = divShowHtml1.querySelectorAll("div")[0].querySelectorAll("input[value='Print']")[0];
					var printButtonOnClick = printButton.getAttribute("onclick");
					printButtonOnClick = printButtonOnClick.replace("Item Card for PL NO:", "HS");
					printButton.setAttribute("onclick", printButtonOnClick);

					var section_udm = divShowHtml1.querySelectorAll("#section_udm")[0];

					var tables = divShowHtml1.querySelectorAll(":scope > div")[1].querySelectorAll(":scope > table");
					var consumptionTable, uncoveredDuesTable, coveredDuesTable, underTransitTable, icTable, orderPlacedTable;

					for (i = 0; i < tables.length; i++) {
						if (tables[i].querySelectorAll("td")[0].innerText.trim() == "STOCK, AAC AND CONSUMPTION DETAILS") {
							consumptionTable = tables[i];
						}
						if (tables[i].querySelectorAll("td")[0].innerText.trim() == "UN-COVERED DUES DETAILS") {
							uncoveredDuesTable = tables[i];
						}
						if (tables[i].querySelectorAll("td")[0].innerText.trim() == "COVERED DUES DETAILS") {
							coveredDuesTable = tables[i];
							coveredDuesTable.classList.add("covered_dues_table");
						}
						if (tables[i].querySelectorAll("td")[0].innerText.trim() == "MATERIAL UNDER TRANSIT") {
							underTransitTable = tables[i];
						}
						if (tables[i].querySelectorAll("td")[0].innerText.trim() == "INSPECTION CERTIFICATE DETAILS") {
							icTable = tables[i];
						}
						if (tables[i].querySelectorAll("td")[0].innerText.trim() == "ORDERS PLACED DURING LAST 3 YEARS" || tables[i].querySelectorAll("td")[0].innerText.trim() == "ORDERS PLACED DURING LAST 5 YEARS") {
							orderPlacedTable = tables[i];
							orderPlacedTable.classList.add("orders_placed_table");
						}
					}

					var historySheetZone = tables[0].querySelectorAll("td")[0].innerText.split(":")[1].trim();
					var totalConsumptionLY = consumptionTable.querySelectorAll("tbody")[0].querySelectorAll("#stockdata_total")[0].children[3].innerText;
					var totalConsumptionCY = consumptionTable.querySelectorAll("tbody")[0].querySelectorAll("#stockdata_total")[0].children[4].innerText;
					var totalAAC = consumptionTable.querySelectorAll("tbody")[0].querySelectorAll("#stockdata_total")[0].children[5].innerText.split("(")[0];
					var totalStock = consumptionTable.querySelectorAll("tbody")[0].querySelectorAll("#stockdata_total")[0].children[6].innerText.split("(")[0].trim();
					var currentFY = consumptionTable.querySelectorAll("tbody")[0].querySelectorAll("tr")[2].querySelectorAll("td")[3].innerText;
					var dateFY = new Date("20" + currentFY.split("-")[0], 3, 1);
					var numDays = (today - dateFY) / (1000 * 60 * 60 * 24);
					var consumptionRateLY = Math.round(+totalConsumptionLY / 12);
					var consumptionRateCY = Math.round((+totalConsumptionCY / numDays) * 30);

					var uncoveredDues = uncoveredDuesTable.querySelectorAll("tbody")[0].children;

					for (i = 2; i < uncoveredDues.length; i++) {
						if (uncoveredDues[i].children[8]) {
							var dueDate = uncoveredDues[i].children[8].innerText;

							if (dueDate != "") {
								var tenderDueDate = new Date("20" + dueDate.split("/")[2], dueDate.split("/")[1] - 1, dueDate.split("/")[0]);
								var today = new Date();

								var dateDiff = Math.floor((today - tenderDueDate) / 86400000);

								uncoveredDues[i].children[8].innerText = dueDate + " (" + dateDiff + " days)";
							}
						}
					}

					var coveredDues = coveredDuesTable.querySelectorAll("tbody")[0].children;
					var cummulativeDueQty = 0;

					var receiptMonthArray = [];
					var receiptQtyArray = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
					var cbArray = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
					var consumptionRateArray = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];

					for (i = 0; i < 15; i++) {
						var mm = +today.getMonth() + i - Math.floor((today.getMonth() + i) / 12) * 12;
						var yy = +today.getFullYear().toString().substring(2, 4) + Math.floor((today.getMonth() + i) / 12);
						var mmyy = monthArray[mm] + ", " + yy;
						receiptMonthArray.push(mmyy);
					}

					for (i = 2; i < coveredDues.length; i++) {
						var coveredDue = coveredDues[i];
						var dueQty = 0;
						var dueDateText = "";
						var dueDate, dueMonth;

						if (coveredDue.children.length == 10) {
							dueQty = +coveredDue.children[7].innerText;
							dueDateText = coveredDue.children[9].innerText;

							dueDate = new Date("20" + dueDateText.split("/")[2], +dueDateText.split("/")[1] - 1, dueDateText.split("/")[0]);
							dueMonth = monthArray[+dueDateText.split("/")[1] - 1] + ", " + dueDateText.split("/")[2];

							var poHistoryButton = coveredDue.children[0].querySelectorAll("a")[1];
							coveredDue.children[0].appendChild(poHistoryButton);

							if (dueQty > 0 && dueDate < today) {
								coveredDue.children[7].style.color = "red";
								coveredDue.children[9].style.color = "red";
							}
						}

						if (coveredDue.children.length == 9) {
							dueQty = +coveredDue.children[6].innerText;
							dueDateText = coveredDue.children[8].innerText;

							dueDate = new Date("20" + dueDateText.split("/")[2], +dueDateText.split("/")[1] - 1, dueDateText.split("/")[0]);
							dueMonth = monthArray[+dueDateText.split("/")[1] - 1] + ", " + dueDateText.split("/")[2];

							if (dueQty > 0 && dueDate < today) {
								coveredDue.children[6].style.color = "red";
								coveredDue.children[8].style.color = "red";
							}
						}

						if (dueDate >= today && receiptMonthArray.includes(dueMonth)) {
							receiptQtyArray[receiptMonthArray.indexOf(dueMonth)] = receiptQtyArray[receiptMonthArray.indexOf(dueMonth)] + dueQty;
						}

						cummulativeDueQty += dueQty;
					}

					var cb = +totalStock;
					for (i = 0; i < cbArray.length; i++) {
						cb = +cb + +receiptQtyArray[i] - (+consumptionRateCY + +consumptionRateLY) / 2;
						cbArray[i] = cb;
						consumptionRateArray[i] = ((+consumptionRateCY + +consumptionRateLY) / 2) * 3;
					}

					if (cummulativeDueQty > 0) {
						var duesUnit = coveredDues[2].children[5].innerText;
						var coveredDuesHeader = coveredDues[0].querySelectorAll("strong")[0].innerText;
						var coveredDuesHeader2 = coveredDues[0].querySelectorAll("strong")[0].cloneNode(true);
						coveredDuesHeader2.innerText = " ( " + cummulativeDueQty + " " + duesUnit + " | " + Math.round((+cummulativeDueQty / +totalAAC) * 12 * 10) / 10 + " months )";
						coveredDues[0].children[0].appendChild(coveredDuesHeader2);
					}

					var button1 = document.createElement("button");
					var button1Text = document.createTextNode("Show Flow");
					button1.appendChild(button1Text);
					button1.style.marginRight = "16px";
					button1.addEventListener("click", (el) => {
						document.querySelectorAll("#canvas_div")[0].style.display = "block";

						let chartStatus = Chart.getChart("chart_canvas"); // <canvas> id
						if (chartStatus != undefined) {
							chartStatus.destroy();
						}

						var chart = new Chart(canvas, {
							data: {
								labels: receiptMonthArray,
								datasets: [
									{
										label: "Closing Balance",
										type: "line",
										data: cbArray,
										borderWidth: 1,
									},
									{
										label: "Receipt",
										type: "bar",
										data: receiptQtyArray,
										borderWidth: 1,
									},
									{
										label: "Optimum Inventory",
										type: "line",
										data: consumptionRateArray,
										borderWidth: 1,
										pointRadius: 0,
									},
								],
							},
							options: {
								scales: {
									y: {
										beginAtZero: true,
									},
								},
							},
						});
					});

					var button2 = document.createElement("button");
					var button2Text = document.createTextNode("Hide Flow");
					button2.appendChild(button2Text);
					button2.style.marginRight = "16px";
					button2.addEventListener("click", (el) => {
						document.querySelectorAll("#canvas_div")[0].style.display = "none";
					});

					divShowHtml1.querySelectorAll(":scope > div")[0].querySelectorAll("td")[1].insertBefore(button1, divShowHtml1.querySelectorAll(":scope > div")[0].querySelectorAll("td")[1].children[0]);
					divShowHtml1.querySelectorAll(":scope > div")[0].querySelectorAll("td")[1].insertBefore(button2, divShowHtml1.querySelectorAll(":scope > div")[0].querySelectorAll("td")[1].children[0]);

					if (icTable != null && icTable != undefined) {
						var ic = icTable.querySelectorAll("tbody")[0].children;
						var orderPlaced = orderPlacedTable.querySelectorAll("tbody")[0].children;

						var td = document.createElement("td");
						var tdText = document.createTextNode("Depot");
						td.appendChild(tdText);
						td.setAttribute("width", "10%");
						ic[1].insertBefore(td, ic[1].children[4]);

						for (i = 2; i < ic.length; i++) {
							var poNo = ic[i].children[1].innerText.trim().substring(0, 14);
							var poSrNo = ic[i].children[3].innerText;
							var consignee;

							for (j = 2; j < orderPlaced.length; j++) {
								if (orderPlaced[j].children.length == 13 && orderPlaced[j].children[0].querySelectorAll("a")[0].innerText == poNo) {
									if (orderPlaced[j].children[1].innerText == poSrNo) {
										consignee = orderPlaced[j].children[2].innerText;
									} else {
										var k = 1;
										while (orderPlaced[j + k].children.length != 13) {
											if (orderPlaced[j + k].children[0].innerText == poSrNo) {
												consignee = orderPlaced[j + k].children[1].innerText;
											}
											k++;
										}
									}
								}
							}

							var td = document.createElement("td");
							var tdText = document.createTextNode(consignee);
							td.appendChild(tdText);
							ic[i].insertBefore(td, ic[i].children[4]);
						}
					}

					if (underTransitTable != null && underTransitTable != undefined) {
						var underTransit = underTransitTable.querySelectorAll("tbody")[0].children;
						var orderPlaced = orderPlacedTable.querySelectorAll("tbody")[0].children;

						var td = document.createElement("td");
						var tdText = document.createTextNode("Depot");
						td.appendChild(tdText);
						td.setAttribute("width", "10%");
						underTransit[1].insertBefore(td, underTransit[1].children[3]);

						for (i = 2; i < underTransit.length; i++) {
							var poNo = underTransit[i].children[1].innerText.trim().substring(8, 22);
							var poSrNo = underTransit[i].children[2].innerText;
							var consignee;

							for (j = 2; j < orderPlaced.length; j++) {
								if (orderPlaced[j].children.length == 13 && orderPlaced[j].children[0].querySelectorAll("a")[0].innerText == poNo) {
									if (orderPlaced[j].children[1].innerText == poSrNo) {
										consignee = orderPlaced[j].children[2].innerText;
									} else {
										var k = 1;
										while (orderPlaced[j + k].children.length != 13) {
											if (orderPlaced[j + k].children[0].innerText == poSrNo) {
												consignee = orderPlaced[j + k].children[1].innerText;
											}
											k++;
										}
									}
								}
							}

							var td = document.createElement("td");
							var tdText = document.createTextNode(consignee);
							td.appendChild(tdText);
							underTransit[i].insertBefore(td, underTransit[i].children[3]);
						}
					}

					if (orderPlacedTable != null && orderPlacedTable != undefined) {
						var orders = orderPlacedTable.querySelectorAll("tbody")[0].children;

						for (i = 2; i < orders.length; i++) {
							var order = orders[i];

							if (order.children.length == 13) {
								var poNo = order.children[0].querySelectorAll("a")[0].innerText;

								var a = document.createElement("a");
								a.setAttribute("href", "#");
								a.style.textDecoration = "underline";
								a.style.color = "red";
								a.setAttribute("onclick", "showIcHistReq('" + zoneJson[historySheetZone] + "', '" + poNo + "')");
								var img = document.createElement("img");
								img.setAttribute("src", "/ireps/images/common/GenerateLOA.png");
								img.setAttribute("height", "15");
								img.setAttribute("width", "15");
								img.setAttribute("border", "0");
								img.setAttribute("title", "Historical data of inspection and dispatch");

								a.appendChild(img);
								order.children[0].appendChild(a);

								if (+order.children[6].innerText > 0) {
									order.children[6].style.color = "red";
									order.children[6].style.fontWeight = "bold";
								}
								if (+order.children[7].innerText > 0) {
									order.children[7].style.color = "red";
									order.children[7].style.fontWeight = "bold";
								}
							}

							if (order.children.length == 12) {
								if (+order.children[5].innerText > 0) {
									order.children[5].style.color = "red";
									order.children[5].style.fontWeight = "bold";
								}
								if (+order.children[6].innerText > 0) {
									order.children[6].style.color = "red";
									order.children[6].style.fontWeight = "bold";
								}
							}
						}
					}
				}

				if (e.target.name == "OTHER_RLY_0" && divShowHtml1.querySelectorAll("table")[0].querySelectorAll("tr")[0].innerText.startsWith("Item Card for PL NO:")) {
					var otherRailwayTable = divShowHtml1.children[1].lastElementChild;
					var otherRailwayTableRows = otherRailwayTable.querySelectorAll("tr");
					var pl = divShowHtml1.querySelectorAll("table")[0].querySelectorAll("tr")[0].innerText.trim().slice(-8);

					for (i = 3; i < otherRailwayTableRows.length; i++) {
						var otherRailwayTableRow = otherRailwayTableRows[i];
						if (otherRailwayTableRow.getAttribute("bgcolor") == "#ffffff" && otherRailwayTableRow.nextElementSibling !== null) {
							var tableHeader1 = otherRailwayTable.querySelectorAll("tr")[1].cloneNode(true);
							var tableHeader2 = otherRailwayTable.querySelectorAll("tr")[2].cloneNode(true);

							otherRailwayTableRow.nextElementSibling.insertAdjacentElement("afterend", tableHeader2);
							otherRailwayTableRow.nextElementSibling.insertAdjacentElement("afterend", tableHeader1);
						}

						if (otherRailwayTableRow.getAttribute("bgcolor") == "#E8F1D4" && otherRailwayTableRow.children.length == 13) {
							var aac = otherRailwayTableRow.children[8].innerText;
							var stock = otherRailwayTableRow.children[9].innerText;
							var stock_mm = Math.round((stock / (aac / 12)) * 10) / 10;
							otherRailwayTableRow.children[9].innerText = stock + " (" + stock_mm + ")";
						}

						if (otherRailwayTableRow.children.length == 2) {
							var rly = otherRailwayTableRow.children[0].innerText;
							var rlyCode = rly.substring(0, rly.indexOf("-"));

							var link = document.createElement("a");
							var linkText = document.createTextNode(rly);
							link.appendChild(linkText);
							link.title = "Item position for " + rly;
							link.href = "javascript:void(FORM.PLPosition('" + rlyCode + "','" + pl + "','Y'));";
							otherRailwayTableRow.children[0].innerText = "";
							otherRailwayTableRow.children[0].appendChild(link);
						}
					}

					var tableChildren = divShowHtml1.children[1].children;

					for (j = 3; j < tableChildren.length; j++) {
						if (tableChildren[j].nextElementSibling != null) {
							tableChildren[j].style.display = "none";
						}
					}
				}

				if (e.target.name == "BTN_Report_0" && divShowHtml1.querySelectorAll("table")[0].querySelectorAll("tr")[0].innerText.startsWith("Item Position")) {
					var tables = divShowHtml1.querySelectorAll("table");

					for (i = 0; i < tables.length; i++) {
						tables[i].setAttribute("border", 1);
						tables[i].style.borderCollapse = "collapse";
					}
				}

				if (e.target.title == "view consignee wise breakup of this AAC") {
					var aacTable = divShowHtml2.querySelectorAll("table")[3];
					var aacRows = aacTable.querySelectorAll("tbody")[0].children;
					var totalAAC = 0;

					for (var i = 3; i < aacRows.length; i++) {
						var aacRow = aacRows[i];
						var consigneeAAC = aacRow.children[2].innerText;
						totalAAC += +consigneeAAC;
					}

					var tr = document.createElement("tr");
					var td1 = document.createElement("td");
					var text1 = document.createTextNode("TOTAL");
					td1.appendChild(text1);
					td1.setAttribute("colspan", "2");
					td1.style.textAlign = "right";
					tr.setAttribute("bgcolor", aacRows[0].getAttribute("bgcolor"));
					var td2 = document.createElement("td");
					var text2 = document.createTextNode(totalAAC);
					td2.appendChild(text2);
					td2.style.textAlign = "right";
					tr.appendChild(td1);
					tr.appendChild(td2);
					aacTable.querySelectorAll("tbody")[0].appendChild(tr);
				}

				if (e.target.value == "Hide") {
					document.querySelectorAll("#canvas_div")[0].style.display = "none";
				}
			});

			var plInput = document.querySelectorAll("#s_2")[0].querySelectorAll("#s_0_11")[0];
			plInput.focus();
			plInput.addEventListener("keydown", (e) => {
				if (e.key === "Tab" || e.key === "Enter") {
					document.querySelectorAll("#s_2")[0].querySelectorAll("#s_0_15")[0].focus();
				}
			});
            plInput.addEventListener("keyup", (e) => {
				var pastedContent = plInput.value;
                var trimmedContent = pastedContent.trim();
                plInput.value = trimmedContent;
			});

			document.addEventListener("keydown", (e) => {
				if (e.key === "Escape") {
					if (divShowHtml1.querySelectorAll("table")[0].querySelectorAll("tr")[0].innerText.startsWith("Consignee stock for PL NO:")) {
						divShowHtml1.querySelectorAll("table")[divShowHtml1.querySelectorAll("table").length - 1].querySelectorAll("input")[0].click();
						plInput.focus();
						document.querySelectorAll("#canvas_div")[0].style.display = "none";
					} else {
						document.querySelectorAll("#divShowHtml1")[0].style.display = "none";
						document.querySelectorAll("#canvas_div")[0].style.display = "none";
						plInput.focus();
					}
				}
			});
		}

		if (document.title == "Purchase Proposal" || document.title == "Run Form - IMMIS/PUR/PURPROP") {
			body.classList.add("purchase_proposal");

			var s_3 = document.querySelectorAll("#s_3")[0];
			var s_16 = document.querySelectorAll("#s_16")[0];
			var s_22 = document.querySelectorAll("#s_22")[0];

			var ppInput = s_3.querySelectorAll("input[name='PROPOSAL_NO_0']")[0];
			var buttonView = s_3.querySelectorAll("input[name='btn_Auth_0']")[0];
			ppInput.focus();
			ppInput.addEventListener("keydown", (e) => {
				if (e.key === "Tab" || e.key === "Enter") {
					buttonView.focus();
				}
			});
			ppInput.addEventListener("keyup", (e) => {
				var pastedContent = ppInput.value;
				var trimmedContent = pastedContent.trim();
				ppInput.value = trimmedContent;
			});

			var buttonAuthorization = s_16.querySelectorAll("input[name='btn_Auth_0']")[0];
			var divShowHtml2 = document.querySelectorAll("#divShowHtml2")[0];

			buttonView.addEventListener("click", (e) => {
				divShowHtml2.querySelectorAll("input[value='Hide']")[0].focus();
			});

			document.addEventListener("click", (e) => {
				if (e.target.value == "Hide") {
					s_16.querySelectorAll("input[name='btn_Auth_0']")[0].focus();
				}
			});

			buttonAuthorization.addEventListener("click", (e) => {
				var ppValue = s_3.querySelectorAll("input[name='PROP_VALUE_0']")[0].value.trim();

				if (+ppValue >= 1000000 && document.querySelectorAll("#DivAlertBox")[0].querySelectorAll("input[value='A']")[0] != null) {
					document.querySelectorAll("#DivAlertBox")[0].querySelectorAll("input[value='A']")[0].disabled = "true";
				}
			});

			var buttonExit = s_3.querySelectorAll("input[name='btn_Exit1_0']")[0];
			document.addEventListener("keydown", (e) => {
				if (e.key === "Escape") {
					if (s_16.style.display == "block") {
						s_16.style.display = "none";
					} else {
						buttonExit.click();
						ppInput.focus();
					}
				}
			});

			let getData = () => {
				var qwsDiv = s_22.querySelectorAll("#QWSDiv")[0];

				var date = qwsDiv.querySelectorAll(":scope > table")[0].querySelectorAll("tr")[0].querySelectorAll("th")[1].innerText.substring(7, 15);
				var plNo = qwsDiv.querySelectorAll(":scope > table")[0].querySelectorAll("tr")[1].querySelectorAll("td")[0].querySelectorAll("b")[1].innerText.substring(7);
				var itemDescription = qwsDiv.querySelectorAll(":scope > table")[0].querySelectorAll("tr")[1].querySelectorAll("td")[1].innerText;
				var descriptionText = qwsDiv.querySelectorAll(":scope > table")[0].querySelectorAll("tr")[2].querySelectorAll("td")[2].innerText;
				var unit = descriptionText.substring(descriptionText.indexOf("BU:") + 4, descriptionText.indexOf("Pur.Sec:") - 1);
				var category = descriptionText.substring(descriptionText.indexOf("ABC-Cat:") + 9, descriptionText.indexOf("V/S :"));
				var nature = descriptionText.substring(descriptionText.indexOf("V/S :") + 5);

				var consumptionTable = qwsDiv.querySelectorAll(":scope > table")[1].querySelectorAll("table")[0];
				var consumptionRows = consumptionTable.querySelectorAll("tbody")[0].children;
				var depotArray = [];
				var stockArray = [];
				var barArray = [];
				var consumptionArray = [];
				var consumptionYearsArray = [];
				var aacArray = [];
				var mcArray = [];
				var ipRequirementsArray = [];
				var cpRequirementsArray = [];
				var bpRequirementsArray = [];
				var netRequirementsArray = [];

				for (var i = 2; i < Math.max(consumptionRows.length - 1, 3); i++) {
					var row1 = consumptionRows[i];
					depotArray.push(row1.querySelectorAll("td")[0].innerText);
					stockArray.push(+row1.querySelectorAll("td")[4].innerText);
					barArray.push(+row1.querySelectorAll("td")[2].innerText);
					var array1 = [];
					array1.push(+row1.querySelectorAll("td")[7].innerText);
					array1.push(+row1.querySelectorAll("td")[8].innerText);
					array1.push(+row1.querySelectorAll("td")[9].innerText);
					array1.push(+row1.querySelectorAll("td")[10].innerText);
					consumptionArray.push(array1);
					aacArray.push(+row1.querySelectorAll("td")[12].innerText);
					mcArray.push(+row1.querySelectorAll("td")[12].innerText / 12);
				}

				consumptionYearsArray.push(consumptionTable.querySelectorAll("tr")[1].children[0].innerText);
				consumptionYearsArray.push(consumptionTable.querySelectorAll("tr")[1].children[1].innerText);
				consumptionYearsArray.push(consumptionTable.querySelectorAll("tr")[1].children[2].innerText);
				consumptionYearsArray.push(consumptionTable.querySelectorAll("tr")[1].children[3].innerText);

				var coveredDuesTable = qwsDiv.querySelectorAll(":scope > table")[1].querySelectorAll("table")[4];
				var coveredRows = coveredDuesTable.querySelectorAll("tbody")[0].children;
				var coveredDuesArray = [];
				var array2 = [];

				if (coveredRows.length > 1) {
					for (var i = 1; i < coveredRows.length; i++) {
						var row2 = coveredRows[i];

						if (row2.children[0].innerHTML.search("<br>")) {
							var coveredDepotArray = row2.children[0].innerHTML.split("<br>");
							var coveredPOQtyArray = row2.children[1].innerHTML.split("<br>");
							var coveredDueQtyArray = row2.children[2].innerHTML.split("<br>");
							var coveredDPArray = row2.children[4].innerHTML.split("<br>");
							var coveredPO = row2.children[5].innerText ? row2.children[5].innerText.split("Receipt under Accountal")[0] : "";

							for (var j = 0; j < coveredDepotArray.length; j++) {
								array2 = [];
								array2.push(coveredDepotArray[j]);
								array2.push(+coveredPOQtyArray[j]);
								array2.push(+coveredDueQtyArray[j]);
								array2.push(coveredDPArray[j]);
								array2.push(coveredPO);
								coveredDuesArray.push(array2);
							}
						} else {
							var coveredDepot = row2.children[0].innerText;
							var coveredPOQty = +row2.children[1].innerText;
							var coveredDueQty = +row2.children[2].innerText;
							var coveredDP = row2.children[4].innerText;
							var coveredPO = row2.children[5].innerText ? row2.children[5].innerText.split("Receipt under Accountal")[0] : "";

							array2 = [];
							array2.push(coveredDepot);
							array2.push(+coveredPOQty);
							array2.push(+coveredDueQty);
							array2.push(coveredDP);
							array2.push(coveredPO);
							coveredDuesArray.push(array2);
						}
					}
				}

				var uncoveredDuesTable = qwsDiv.querySelectorAll(":scope > table")[1].querySelectorAll("table")[5];
				var uncoveredRows = uncoveredDuesTable.querySelectorAll("tbody")[0].children;
				var uncoveredDuesArray = [];

				if (uncoveredRows.length > 1) {
					for (var i = 1; i < uncoveredRows.length; i++) {
						var row3 = uncoveredRows[i];

						var uncoveredDepot = row3.children[0].innerText;
						var uncoveredQty = +row3.children[1].innerText;
						var uncoveredDemandNo = row3.children[2].innerText;
						var uncoveredDemandDate = row3.children[3].innerText;
						var uncoveredTenderDetails;
						if (row3.children[4]) {
							uncoveredTenderDetails = row3.children[4].innerText;
						} else {
							uncoveredTenderDetails = "";
						}

						var array3 = [];
						array3.push(uncoveredDepot);
						array3.push(+uncoveredQty);
						array3.push(uncoveredDemandNo);
						array3.push(uncoveredDemandDate);
						array3.push(uncoveredTenderDetails);
						uncoveredDuesArray.push(array3);
					}
				}

				var cpText = qwsDiv.querySelectorAll(":scope > table")[1].querySelectorAll("table")[1].querySelectorAll("tr")[1].textContent;
				var cpFrom = cpText.substring(4, 12);
				var cpTo = cpText.substring(16, 24);
				var cpMM = parseInt(cpText.substring(27, 29));
				var ipFrom = cpText.substring(44, 52);
				var ipTo = cpText.substring(56, 64);
				var ipMM = parseInt(cpText.substring(67, 69));
				var bpMM = parseInt(qwsDiv.querySelectorAll(":scope > table")[1].querySelectorAll("table")[1].querySelectorAll("tr")[1].querySelectorAll("span")[0].innerText);

				var data = new Object();
				data.date = date;
				data.plNo = plNo;
				data.itemDescription = itemDescription;
				data.descriptionText = descriptionText;
				data.unit = unit;
				data.category = category;
				data.nature = nature;

				data.depotArray = depotArray;
				data.stockArray = stockArray;
				data.barArray = barArray;
				data.consumptionArray = consumptionArray;
				data.consumptionYearsArray = consumptionYearsArray;
				data.aacArray = aacArray;
				data.mcArray = mcArray;
				data.coveredDuesArray = coveredDuesArray;
				data.uncoveredDuesArray = uncoveredDuesArray;

				data.cpFrom = cpFrom;
				data.cpTo = cpTo;
				data.cpMM = cpMM;
				data.ipFrom = ipFrom;
				data.ipTo = ipTo;
				data.ipMM = ipMM;
				data.bpMM = bpMM;

				return data;
			};

			let confirmData = () => {
				var data = getData();

				var date = data.date;
				var plNo = data.plNo;
				var itemDescription = data.itemDescription;
				var descriptionText = data.descriptionText;
				var unit = data.unit;
				var category = data.category;
				var nature = data.nature;

				var depotArray = data.depotArray;
				var stockArray = data.stockArray;
				var barArray = data.barArray;
				var consumptionArray = data.consumptionArray;
				var consumptionYearsArray = data.consumptionYearsArray;
				var aacArray = data.aacArray;
				var mcArray = data.mcArray;
				var coveredDuesArray = data.coveredDuesArray;
				var uncoveredDuesArray = data.uncoveredDuesArray;

				var cpFrom = data.cpFrom;
				var cpTo = data.cpTo;
				var cpMM = data.cpMM;
				var ipFrom = data.ipFrom;
				var ipTo = data.ipTo;
				var ipMM = data.ipMM;
				var bpMM = data.bpMM;

				var revisedAacArray = [];
				var revisedMcArray = [];
				var revisedUncoveredDuesArray = [];
				var revisedBP = 0;

				var qwsDiv = s_22.querySelectorAll("#QWSDiv")[0];

				if (qwsDiv.querySelectorAll(".data_review")[0]) {
					qwsDiv.querySelectorAll(".data_review")[0].remove();
				}

				if (qwsDiv.querySelectorAll(".qty_review_div")[0]) {
					qwsDiv.querySelectorAll(".qty_review_div")[0].remove();
				}

				var div = document.createElement("div");
				div.classList.add("data_review");

				var table1 = document.createElement("table");
				var tbody1 = document.createElement("tbody");
				var tr1 = document.createElement("tr");
				var td11 = document.createElement("td");
				var text11 = document.createTextNode("Review AAC");
				td11.appendChild(text11);
				td11.setAttribute("colspan", "8");
				tr1.appendChild(td11);
				tr1.setAttribute("bgcolor", "lightGrey");
				var tr2 = document.createElement("tr");
				var td21 = document.createElement("td");
				var text21 = document.createTextNode("Depot");
				td21.appendChild(text21);
				var td22 = document.createElement("td");
				var text22 = document.createTextNode("Cons " + consumptionYearsArray[0]);
				td22.appendChild(text22);
				var td23 = document.createElement("td");
				var text23 = document.createTextNode("Cons " + consumptionYearsArray[1]);
				td23.appendChild(text23);
				var td24 = document.createElement("td");
				var text24 = document.createTextNode("Cons " + consumptionYearsArray[2]);
				td24.appendChild(text24);
				var td25 = document.createElement("td");
				var text25 = document.createTextNode("Cons " + consumptionYearsArray[3]);
				td25.appendChild(text25);
				var td26 = document.createElement("td");
				var text26 = document.createTextNode("Cons (Max)");
				td26.appendChild(text26);
				var td27 = document.createElement("td");
				var text27 = document.createTextNode("AAC");
				td27.appendChild(text27);
				var td28 = document.createElement("td");
				var text28 = document.createTextNode("Revised AAC");
				td28.appendChild(text28);
				tr2.appendChild(td21);
				tr2.appendChild(td22);
				tr2.appendChild(td23);
				tr2.appendChild(td24);
				tr2.appendChild(td25);
				tr2.appendChild(td26);
				tr2.appendChild(td27);
				tr2.appendChild(td28);
				tbody1.appendChild(tr1);
				tbody1.appendChild(tr2);

				var totalInputAAC = 0;

				for (var i = 0; i < depotArray.length; i++) {
					var trP = document.createElement("tr");
					var tdP1 = document.createElement("td");
					var textP1 = document.createTextNode(depotArray[i]);
					tdP1.appendChild(textP1);
					var tdP2 = document.createElement("td");
					var textP2 = document.createTextNode(consumptionArray[i][0]);
					tdP2.appendChild(textP2);
					var tdP3 = document.createElement("td");
					var textP3 = document.createTextNode(consumptionArray[i][1]);
					tdP3.appendChild(textP3);
					var tdP4 = document.createElement("td");
					var textP4 = document.createTextNode(consumptionArray[i][2]);
					tdP4.appendChild(textP4);
					var tdP5 = document.createElement("td");
					var textP5 = document.createTextNode(consumptionArray[i][3]);
					tdP5.appendChild(textP5);
					var date1 = new Date("20" + date.split("/")[2], +date.split("/")[1] - 1, +date.split("/")[0]);
					var date2 = new Date("20" + consumptionYearsArray[3].split("-")[0], 3, 1);
					var numDays = (date1 - date2) / (1000 * 60 * 60 * 24);
					var maxConsumption = Math.max(+consumptionArray[i][0], +consumptionArray[i][1], +consumptionArray[i][2], Math.round((+consumptionArray[i][3] * 365) / numDays));
					var tdP6 = document.createElement("td");
					var textP6 = document.createTextNode(maxConsumption);
					tdP6.appendChild(textP6);
					var tdP7 = document.createElement("td");
					var textP7 = document.createTextNode(aacArray[i]);
					tdP7.appendChild(textP7);

					var escalationLimit = 1;

					if (category.substring(0, 1) == "A") {
						escalationLimit = 1.5;
					} else if (category.substring(0, 1) == "B") {
						escalationLimit = 1.5;
					} else {
						escalationLimit = 2.0;
					}

					var tdP8 = document.createElement("td");
					var inputP8 = document.createElement("input");
					inputP8.value = Math.min(+aacArray[i], Math.round(escalationLimit * maxConsumption));
					if (aacArray[i] > escalationLimit * maxConsumption) {
						inputP8.style.color = "red";
					}
					totalInputAAC += Math.min(+aacArray[i], Math.round(escalationLimit * maxConsumption));
					
                    inputP8.addEventListener("keyup", (e) => {
						var dataReviewDiv = document.querySelectorAll(".data_review")[0];
						var rows = dataReviewDiv.querySelectorAll("table")[0].querySelectorAll("tr");
						var inputs = dataReviewDiv.querySelectorAll("table")[0].querySelectorAll("input");
						var totalInputAAC = 0;
						var bar = barArray[0];

						for (var i = 0; i < inputs.length; i++) {
							var input = inputs[i];
							totalInputAAC += +inputs[i].value;
						}

						rows[rows.length - 2].querySelectorAll("td")[7].innerText = totalInputAAC;
						rows[rows.length - 1].querySelectorAll("td")[7].innerText = Math.round(+totalInputAAC * +bar);
					});

					tdP8.appendChild(inputP8);
					trP.appendChild(tdP1);
					trP.appendChild(tdP2);
					trP.appendChild(tdP3);
					trP.appendChild(tdP4);
					trP.appendChild(tdP5);
					trP.appendChild(tdP6);
					trP.appendChild(tdP7);
					trP.appendChild(tdP8);
					tbody1.appendChild(trP);
				}

				var trP = document.createElement("tr");
				var tdP1 = document.createElement("td");
				var textP1 = document.createTextNode("Total");
				tdP1.appendChild(textP1);
				var tdP2 = document.createElement("td");
				var tdP3 = document.createElement("td");
				var tdP4 = document.createElement("td");
				var tdP5 = document.createElement("td");
				var tdP6 = document.createElement("td");
				var tdP7 = document.createElement("td");
				var tdP8 = document.createElement("td");
				var textP8 = document.createTextNode(totalInputAAC);
				tdP8.appendChild(textP8);
				trP.appendChild(tdP1);
				trP.appendChild(tdP2);
				trP.appendChild(tdP3);
				trP.appendChild(tdP4);
				trP.appendChild(tdP5);
				trP.appendChild(tdP6);
				trP.appendChild(tdP7);
				trP.appendChild(tdP8);
				tbody1.appendChild(trP);

				var trP = document.createElement("tr");
				var tdP1 = document.createElement("td");
				var textP1 = document.createTextNode("Total AAC Value");
				tdP1.appendChild(textP1);
				var tdP2 = document.createElement("td");
				var tdP3 = document.createElement("td");
				var tdP4 = document.createElement("td");
				var tdP5 = document.createElement("td");
				var tdP6 = document.createElement("td");
				var tdP7 = document.createElement("td");
				var tdP8 = document.createElement("td");
				var textP8 = document.createTextNode(Math.round(totalInputAAC * barArray[0]));
				tdP8.appendChild(textP8);
				trP.appendChild(tdP1);
				trP.appendChild(tdP2);
				trP.appendChild(tdP3);
				trP.appendChild(tdP4);
				trP.appendChild(tdP5);
				trP.appendChild(tdP6);
				trP.appendChild(tdP7);
				trP.appendChild(tdP8);
				tbody1.appendChild(trP);

				table1.appendChild(tbody1);
				div.appendChild(table1);

				var table1 = document.createElement("table");
				var tbody1 = document.createElement("tbody");
				var tr1 = document.createElement("tr");
				var td11 = document.createElement("td");
				var text11 = document.createTextNode("Buffer Months");
				td11.appendChild(text11);
				var td12 = document.createElement("td");
				var input12 = document.createElement("input");
				input12.value = data.bpMM;
				td12.appendChild(input12);
				tr1.appendChild(td11);
				tr1.appendChild(td12);
				tbody1.appendChild(tr1);
				table1.appendChild(tbody1);
				div.appendChild(table1);

				var table1 = document.createElement("table");
				var tbody1 = document.createElement("tbody");
				var tr1 = document.createElement("tr");
				var td11 = document.createElement("td");
				var text11 = document.createTextNode("Review Uncovered Dues");
				td11.appendChild(text11);
				td11.setAttribute("colspan", "6");
				tr1.appendChild(td11);
				tr1.setAttribute("bgcolor", "lightGrey");
				var tr2 = document.createElement("tr");
				var td21 = document.createElement("td");
				var text21 = document.createTextNode("Depot");
				td21.appendChild(text21);
				var td22 = document.createElement("td");
				var text22 = document.createTextNode("Demand No");
				td22.appendChild(text22);
				var td23 = document.createElement("td");
				var text23 = document.createTextNode("Demand Date");
				td23.appendChild(text23);
				var td24 = document.createElement("td");
				var text24 = document.createTextNode("Qty");
				td24.appendChild(text24);
				var td25 = document.createElement("td");
				var text25 = document.createTextNode("Tender Details");
				td25.appendChild(text25);
				var td26 = document.createElement("td");
				var text26 = document.createTextNode("Action");
				td26.appendChild(text26);
				tr2.appendChild(td21);
				tr2.appendChild(td22);
				tr2.appendChild(td23);
				tr2.appendChild(td24);
				tr2.appendChild(td25);
				tr2.appendChild(td26);
				tbody1.appendChild(tr1);
				tbody1.appendChild(tr2);

				for (var i = 0; i < uncoveredDuesArray.length; i++) {
					var trQ = document.createElement("tr");
					var tdQ1 = document.createElement("td");
					var textQ1 = document.createTextNode(uncoveredDuesArray[i][0]);
					tdQ1.appendChild(textQ1);
					var tdQ2 = document.createElement("td");
					var textQ2 = document.createTextNode(uncoveredDuesArray[i][2]);
					tdQ2.appendChild(textQ2);
					var tdQ3 = document.createElement("td");
					var textQ3 = document.createTextNode(uncoveredDuesArray[i][3]);
					tdQ3.appendChild(textQ3);
					var tdQ4 = document.createElement("td");
					var inputQ4 = document.createElement("input");
					inputQ4.value = uncoveredDuesArray[i][1];
					tdQ4.appendChild(inputQ4);
					var tdQ5 = document.createElement("td");
					var textQ5 = document.createTextNode(uncoveredDuesArray[i][4]);
					tdQ5.appendChild(textQ5);
					var tdQ6 = document.createElement("td");
					var selectQ6 = document.createElement("select");
					selectQ6.classList.add("demand_consider");
					var optionQ61 = document.createElement("option");
					optionQ61.value = "Ignore";
					optionQ61.innerHTML = "Ignore";
					selectQ6.appendChild(optionQ61);
					var optionQ62 = document.createElement("option");
					optionQ62.value = "Consider";
					optionQ62.innerHTML = "Consider";
					if (uncoveredDuesArray[i][0].substring(0, 1) == uncoveredDuesArray[i][4].substring(0, 1)) {
						optionQ62.setAttribute("selected", "selected");
						selectQ6.classList.add("considered");
					}
					selectQ6.appendChild(optionQ62);
					tdQ6.appendChild(selectQ6);
					trQ.appendChild(tdQ1);
					trQ.appendChild(tdQ2);
					trQ.appendChild(tdQ3);
					trQ.appendChild(tdQ4);
					trQ.appendChild(tdQ5);
					trQ.appendChild(tdQ6);
					tbody1.appendChild(trQ);
				}

				table1.appendChild(tbody1);
				div.appendChild(table1);

				var button = document.createElement("button");
				button.innerHTML = "Submit";
				button.classList.add("submit_aac_and_dues");
				button.onclick = () => {
					var dataReviewDiv = document.querySelectorAll(".data_review")[0];

					var aacTable = dataReviewDiv.querySelectorAll("table")[0];
					var aacRows = aacTable.children[0].children;

					var originalAacTable = qwsDiv.querySelectorAll(":scope > table")[1].querySelectorAll("table")[0];
					var originalAacRows = originalAacTable.children[0].children;

					for (var i = 2; i < originalAacRows.length; i++) {
						for (var j = 1; j < aacRows.length; j++) {
							if (originalAacRows[i].children[0].innerText == aacRows[j].children[0].innerText) {
								revisedAacArray.push(+aacRows[j].children[7].querySelectorAll("input")[0].value);
								revisedMcArray.push(aacRows[j].children[7].querySelectorAll("input")[0].value / 12);
							}
						}
					}

					//var bpText1 = qwsDiv.children[1].children[10].nextSibling.textContent.substring(0, 8);
					//var bpText2 = qwsDiv.children[1].children[10].nextSibling.textContent.substring(9);
					//qwsDiv.children[1].children[10].nextSibling.textContent = bpText1 + dataReviewDiv.querySelectorAll("table")[1].querySelectorAll("input")[0].value + bpText2;
					revisedBP = dataReviewDiv.querySelectorAll("table")[1].querySelectorAll("input")[0].value;

					qwsDiv.querySelectorAll(":scope > table")[1].querySelectorAll("table")[1].querySelectorAll("tr")[1].querySelectorAll("span")[0].innerText = dataReviewDiv.querySelectorAll("table")[1].querySelectorAll("input")[0].value;

					var uncoveredDuesTable = dataReviewDiv.querySelectorAll("table")[2];
					var uncoveredRows = uncoveredDuesTable.children[0].children;

					var originalUncoveredDuesTable = qwsDiv.querySelectorAll(":scope > table")[1].querySelectorAll("table")[5];
					var originalUncoveredRows = originalUncoveredDuesTable.querySelectorAll("tbody")[0].children;

					var j = 1;
					for (var i = 2; i < uncoveredRows.length; i++) {
						if (uncoveredRows[i].children[5].querySelectorAll("select")[0].value == "Consider") {
							var array3 = [];
							array3.push(uncoveredRows[i].children[0].innerText);
							array3.push(uncoveredRows[i].children[3].querySelectorAll("input")[0].value);
							array3.push(uncoveredRows[i].children[1].innerText);
							array3.push(uncoveredRows[i].children[2].innerText);
							array3.push(uncoveredRows[i].children[4].innerText);
							revisedUncoveredDuesArray.push(array3);
							//originalUncoveredRows[j].querySelectorAll("td")[1].innerText = uncoveredRows[i].children[3].querySelectorAll("input")[0].value;
						} else {
							originalUncoveredRows[j].remove();
							j--;
						}
						j++;
					}

					data.revisedAacArray = revisedAacArray;
					data.revisedMcArray = revisedMcArray;
					data.revisedUncoveredDuesArray = revisedUncoveredDuesArray;
					data.revisedBP = revisedBP;

					qwsDiv.nextElementSibling.style.display = "none";
					showQWS(data);
				};
				div.appendChild(button);

				qwsDiv.parentElement.appendChild(div);
				/*qwsDiv.children[0].querySelectorAll("input[value='Print']")[0].removeAttribute('onclick');*/
			};

			let showQWS = (data) => {
				var date = data.date;
				var plNo = data.plNo;
				var itemDescription = data.itemDescription;
				var descriptionText = data.descriptionText;
				var unit = data.unit;
				var category = data.category;
				var nature = data.nature;

				var depotArray = data.depotArray;
				var stockArray = data.stockArray;
				var consumptionArray = data.consumptionArray;
				var consumptionYearsArray = data.consumptionYearsArray;
				var aacArray = data.aacArray;
				var mcArray = data.mcArray;
				var coveredDuesArray = data.coveredDuesArray;
				var uncoveredDuesArray = data.uncoveredDuesArray;

				var cpFrom = data.cpFrom;
				var cpTo = data.cpTo;
				var cpMM = data.cpMM;
				var ipFrom = data.ipFrom;
				var ipTo = data.ipTo;
				var ipMM = data.ipMM;
				var bpMM = data.bpMM;

				var revisedAacArray = data.revisedAacArray;
				var revisedMcArray = data.revisedMcArray;
				var revisedUncoveredDuesArray = data.revisedUncoveredDuesArray;
				var revisedBP = data.revisedBP;

				var ipRequirementsArray = [];
				var cpRequirementsArray = [];
				var bpRequirementsArray = [];
				var netRequirementsArray = [];

				var qwsDiv = s_22.querySelectorAll("#QWSDiv")[0];

				if (qwsDiv.parentElement.querySelectorAll(".qty_review_div")[0]) {
					qwsDiv.parentElement.querySelectorAll(".qty_review_div")[0].remove();
				}

				var div = document.createElement("div");
				div.classList.add("qty_review_div");

				var table1 = document.createElement("table");
				var tbody1 = document.createElement("tbody");
				var tr1 = document.createElement("tr");
				var td1 = document.createElement("td");
				var text1 = document.createTextNode("QUANTITY REVIEW SHEET");
				td1.appendChild(text1);
				tr1.appendChild(td1);
				tbody1.appendChild(tr1);
				var tr2 = document.createElement("tr");
				var td2 = document.createElement("td");
				var text2 = document.createTextNode("Date: " + date);
				td2.appendChild(text2);
				tr2.appendChild(td2);
				tr1.setAttribute("bgcolor", "lightBlue");
				tbody1.appendChild(tr1);
				tbody1.appendChild(tr2);
				table1.appendChild(tbody1);
				div.appendChild(table1);

				var table1 = document.createElement("table");
				var tbody1 = document.createElement("tbody");
				var tr1 = document.createElement("tr");
				var td1 = document.createElement("td");
				var text1 = document.createTextNode("PL No");
				td1.appendChild(text1);
				var td2 = document.createElement("td");
				var text2 = document.createTextNode(plNo);
				td2.appendChild(text2);
				var td3 = document.createElement("td");
				var text3 = document.createTextNode("Nature");
				td3.appendChild(text3);
				var td4 = document.createElement("td");
				var natureText = nature == "S" ? "Safety" : nature == "V" ? "Vital" : "Ordinary";
				var text4 = document.createTextNode(natureText);
				td4.appendChild(text4);
				var td5 = document.createElement("td");
				var text5 = document.createTextNode("Category");
				td5.appendChild(text5);
				var td6 = document.createElement("td");
				var text6 = document.createTextNode(category);
				td6.appendChild(text6);
				var td7 = document.createElement("td");
				var text7 = document.createTextNode("Unit");
				td7.appendChild(text7);
				var td8 = document.createElement("td");
				var text8 = document.createTextNode(unit);
				td8.appendChild(text8);
				tr1.appendChild(td1);
				tr1.appendChild(td2);
				tr1.appendChild(td3);
				tr1.appendChild(td4);
				tr1.appendChild(td5);
				tr1.appendChild(td6);
				tr1.appendChild(td7);
				tr1.appendChild(td8);
				var tr2 = document.createElement("tr");
				var td9 = document.createElement("td");
				var text9 = document.createTextNode("Description");
				td9.appendChild(text9);
				var td10 = document.createElement("td");
				var text10 = document.createTextNode(itemDescription);
				td10.appendChild(text10);
				td10.setAttribute("colspan", "7");
				tr2.appendChild(td9);
				tr2.appendChild(td10);
				tbody1.appendChild(tr1);
				tbody1.appendChild(tr2);
				table1.appendChild(tbody1);
				div.appendChild(table1);

				var table1 = document.createElement("table");
				var tbody1 = document.createElement("tbody");
				var tr1 = document.createElement("tr");
				var td1 = document.createElement("td");
				var text1 = document.createTextNode("Stock and Consumption History");
				td1.appendChild(text1);
				td1.setAttribute("colspan", 9);
				tr1.appendChild(td1);
				var tr2 = document.createElement("tr");
				var td2 = document.createElement("td");
				var text2 = document.createTextNode("Depot");
				td2.appendChild(text2);
				var td3 = document.createElement("td");
				var text3 = document.createTextNode("Cons " + consumptionYearsArray[0]);
				td3.appendChild(text3);
				var td4 = document.createElement("td");
				var text4 = document.createTextNode("Cons " + consumptionYearsArray[1]);
				td4.appendChild(text4);
				var td5 = document.createElement("td");
				var text5 = document.createTextNode("Cons " + consumptionYearsArray[2]);
				td5.appendChild(text5);
				var td6 = document.createElement("td");
				var text6 = document.createTextNode("Cons " + consumptionYearsArray[3]);
				td6.appendChild(text6);
				var td7 = document.createElement("td");
				var text7 = document.createTextNode("Max Consumption");
				td7.appendChild(text7);
				var td8 = document.createElement("td");
				var text8 = document.createTextNode("AAC");
				td8.appendChild(text8);
				var td9 = document.createElement("td");
				var text9 = document.createTextNode("Revised AAC");
				td9.appendChild(text9);
				var td10 = document.createElement("td");
				var text10 = document.createTextNode("Stock");
				td10.appendChild(text10);
				tr2.appendChild(td2);
				tr2.appendChild(td3);
				tr2.appendChild(td4);
				tr2.appendChild(td5);
				tr2.appendChild(td6);
				tr2.appendChild(td7);
				tr2.appendChild(td8);
				tr2.appendChild(td9);
				tr2.appendChild(td10);
				tr1.setAttribute("bgcolor", "lightBlue");
				tr2.setAttribute("bgcolor", "lightBlue");
				tbody1.appendChild(tr1);
				tbody1.appendChild(tr2);

				for (var i = 0; i < depotArray.length; i++) {
					var tri = document.createElement("tr");
					var tdi1 = document.createElement("td");
					var texti1 = document.createTextNode(depotArray[i]);
					tdi1.appendChild(texti1);
					var tdi2 = document.createElement("td");
					var texti2 = document.createTextNode(consumptionArray[i][0]);
					tdi2.appendChild(texti2);
					var tdi3 = document.createElement("td");
					var texti3 = document.createTextNode(consumptionArray[i][1]);
					tdi3.appendChild(texti3);
					var tdi4 = document.createElement("td");
					var texti4 = document.createTextNode(consumptionArray[i][2]);
					tdi4.appendChild(texti4);
					var tdi5 = document.createElement("td");
					var texti5 = document.createTextNode(consumptionArray[i][3]);
					tdi5.appendChild(texti5);
					var dateArray = date.split("/");
					var numMonths = +dateArray[1] - 4 + +dateArray[0] / 30;
					var date1 = new Date("20" + date.split("/")[2], +date.split("/")[1] - 1, +date.split("/")[0]);
					var date2 = new Date("20" + consumptionYearsArray[3].split("-")[0], 3, 1);
					var numDays = (date1 - date2) / (1000 * 60 * 60 * 24);
					var avgConsumption = Math.round(((+consumptionArray[i][0] * 1 + +consumptionArray[i][1] * 2 + +consumptionArray[i][2] * 3 + +consumptionArray[i][3] * 3) / (6 + (3 * numDays) / 365)) * 100) / 100;
					var maxConsumption = Math.max(+consumptionArray[i][0], +consumptionArray[i][1], +consumptionArray[i][2], Math.round((+consumptionArray[i][3] * 365) / numDays));
					var tdi6 = document.createElement("td");
					var texti6 = document.createTextNode(maxConsumption);
					tdi6.appendChild(texti6);
					var tdi7 = document.createElement("td");
					var texti7 = document.createTextNode(aacArray[i]);
					tdi7.appendChild(texti7);
					var tdi8 = document.createElement("td");
					var texti8 = document.createTextNode(revisedAacArray[i]);
					tdi8.appendChild(texti8);
					var tdi9 = document.createElement("td");
					var texti9 = document.createTextNode(stockArray[i]);
					tdi9.appendChild(texti9);
					tri.appendChild(tdi1);
					tri.appendChild(tdi2);
					tri.appendChild(tdi3);
					tri.appendChild(tdi4);
					tri.appendChild(tdi5);
					tri.appendChild(tdi6);
					tri.appendChild(tdi7);
					tri.appendChild(tdi8);
					tri.appendChild(tdi9);
					tbody1.appendChild(tri);
				}

				var tri = document.createElement("tr");
				var tdi1 = document.createElement("td");
				var texti1 = document.createTextNode("UDM");
				tdi1.appendChild(texti1);
				var tdi2 = document.createElement("td");
				var texti2 = document.createTextNode("-");
				tdi2.appendChild(texti2);
				var tdi3 = document.createElement("td");
				var texti3 = document.createTextNode("-");
				tdi3.appendChild(texti3);
				var tdi4 = document.createElement("td");
				var texti4 = document.createTextNode("-");
				tdi4.appendChild(texti4);
				var tdi5 = document.createElement("td");
				var texti5 = document.createTextNode("-");
				tdi5.appendChild(texti5);
				var tdi6 = document.createElement("td");
				var texti6 = document.createTextNode("-");
				tdi6.appendChild(texti6);
				var tdi7 = document.createElement("td");
				var texti7 = document.createTextNode("-");
				tdi7.appendChild(texti7);
				var tdi8 = document.createElement("td");
				var texti8 = document.createTextNode("-");
				tdi8.appendChild(texti8);
				var tdi9 = document.createElement("td");
				var texti9 = document.createTextNode("-");
				tdi9.appendChild(texti9);
				tri.appendChild(tdi1);
				tri.appendChild(tdi2);
				tri.appendChild(tdi3);
				tri.appendChild(tdi4);
				tri.appendChild(tdi5);
				tri.appendChild(tdi6);
				tri.appendChild(tdi7);
				tri.appendChild(tdi8);
				tri.appendChild(tdi9);
				tbody1.appendChild(tri);

				table1.appendChild(tbody1);
				div.appendChild(table1);

				var table1 = document.createElement("table");
				var tbody1 = document.createElement("tbody");
				var tr1 = document.createElement("tr");
				var td1 = document.createElement("td");
				var text1 = document.createTextNode("Covered Dues");
				td1.appendChild(text1);
				td1.setAttribute("colspan", 3);
				tr1.appendChild(td1);
				var tr2 = document.createElement("tr");
				var td2 = document.createElement("td");
				var text2 = document.createTextNode("Depot");
				td2.appendChild(text2);
				var td30 = document.createElement("td");
				var tr33 = document.createElement("tr");
				var td3 = document.createElement("td");
				var text3 = document.createTextNode("PO Details");
				td3.appendChild(text3);
				var td4 = document.createElement("td");
				var text4 = document.createTextNode("Due Qty");
				td4.appendChild(text4);
				var td5 = document.createElement("td");
				var text5 = document.createTextNode("Total Qty");
				td5.appendChild(text5);
				tr2.appendChild(td2);
				tr33.appendChild(td3);
				tr33.appendChild(td4);
				td30.appendChild(tr33);
				tr2.appendChild(td30);
				tr2.appendChild(td5);
				tr1.setAttribute("bgcolor", "lightBlue");
				tr2.setAttribute("bgcolor", "lightBlue");
				tbody1.appendChild(tr1);
				tbody1.appendChild(tr2);

				var totalCoveredDuesArray = [];

				for (var i = 0; i < depotArray.length; i++) {
					var trJ = document.createElement("tr");
					var tdJ1 = document.createElement("td");
					var textJ1 = document.createTextNode(depotArray[i]);
					tdJ1.appendChild(textJ1);
					var tdJ2 = document.createElement("td");
					var tdJ3 = document.createElement("td");
					var tdJ4 = document.createElement("td");

					var totalDues = 0;
					for (var j = 0; j < coveredDuesArray.length; j++) {
						var row4 = coveredDuesArray[j];

						if (row4[0] == depotArray[i].substring(0, 2) && row4[4].substring(16, 17) != "8" && row4[4].substring(16, 17) != "7") {
							var trK1 = document.createElement("tr");
							var tdK1 = document.createElement("td");
							var textK1 = document.createTextNode(row4[4].slice(0, 35) + " " + row4[4].slice(35));
							var br = document.createElement("br");
							var textK2 = document.createTextNode("DP: " + row4[3]);
							tdK1.appendChild(textK1);
							tdK1.appendChild(br);
							tdK1.appendChild(textK2);
							trK1.appendChild(tdK1);

							var tdK2 = document.createElement("td");
							var textK3 = document.createTextNode(row4[2]);
							tdK2.appendChild(textK3);
							trK1.appendChild(tdK2);
							tdJ3.appendChild(trK1);

							totalDues += +row4[2];
						}
					}

					totalCoveredDuesArray.push(totalDues);
					var textK4 = document.createTextNode(totalDues);
					tdJ4.appendChild(textK4);
					trJ.appendChild(tdJ1);
					trJ.appendChild(tdJ3);
					trJ.appendChild(tdJ4);
					tbody1.appendChild(trJ);
				}

				table1.appendChild(tbody1);
				div.appendChild(table1);

				var table1 = document.createElement("table");
				var tbody1 = document.createElement("tbody");
				var tr1 = document.createElement("tr");
				var td11 = document.createElement("td");
				var text11 = document.createTextNode("Uncovered Dues");
				td11.appendChild(text11);
				td11.setAttribute("colspan", 3);
				tr1.appendChild(td11);
				var tr2 = document.createElement("tr");
				var td21 = document.createElement("td");
				var text21 = document.createTextNode("Depot");
				td21.appendChild(text21);
				var td22 = document.createElement("td");
				var tr3 = document.createElement("tr");
				var td31 = document.createElement("td");
				var text31 = document.createTextNode("Demand No");
				td31.appendChild(text31);
				var td32 = document.createElement("td");
				var text32 = document.createTextNode("Demand Date");
				td32.appendChild(text32);
				var td33 = document.createElement("td");
				var text33 = document.createTextNode("Tender Details");
				td33.appendChild(text33);
				var td34 = document.createElement("td");
				var text34 = document.createTextNode("Qty");
				td34.appendChild(text34);
				tr3.appendChild(td31);
				tr3.appendChild(td32);
				tr3.appendChild(td33);
				tr3.appendChild(td34);
				td22.appendChild(tr3);
				var td23 = document.createElement("td");
				var text23 = document.createTextNode("Total Qty");
				td23.appendChild(text23);
				tr2.appendChild(td21);
				tr2.appendChild(td22);
				tr2.appendChild(td23);
				tr1.setAttribute("bgcolor", "lightBlue");
				tr2.setAttribute("bgcolor", "lightBlue");
				tbody1.appendChild(tr1);
				tbody1.appendChild(tr2);

				var totalUncoveredDuesArray = [];

				for (var i = 0; i < depotArray.length; i++) {
					var trJ = document.createElement("tr");
					var tdJ1 = document.createElement("td");
					var textJ1 = document.createTextNode(depotArray[i]);
					tdJ1.appendChild(textJ1);
					var tdJ2 = document.createElement("td");
					var tdJ3 = document.createElement("td");

					var totalDues = 0;
					for (var j = 0; j < revisedUncoveredDuesArray.length; j++) {
						var row4 = revisedUncoveredDuesArray[j];

						if (row4[0] == depotArray[i]) {
							var trK1 = document.createElement("tr");
							var tdK1 = document.createElement("td");
							var textK1 = document.createTextNode(row4[2]);
							tdK1.appendChild(textK1);
							trK1.appendChild(tdK1);

							var tdK2 = document.createElement("td");
							var textK2 = document.createTextNode(row4[3]);
							tdK2.appendChild(textK2);
							trK1.appendChild(tdK2);

							var tdK3 = document.createElement("td");
							var textK3 = document.createTextNode(row4[4]);
							tdK3.appendChild(textK3);
							trK1.appendChild(tdK3);

							var tdK4 = document.createElement("td");
							var textK4 = document.createTextNode(row4[1]);
							tdK4.appendChild(textK4);
							trK1.appendChild(tdK4);

							tdJ2.appendChild(trK1);
							trK1.appendChild(tdK2);
							trK1.appendChild(tdK3);
							trK1.appendChild(tdK4);
							tdJ2.appendChild(trK1);

							totalDues += +row4[1];
						}
					}

					totalUncoveredDuesArray.push(totalDues);
					var textJ3 = document.createTextNode(totalDues);
					tdJ3.appendChild(textJ3);
					trJ.appendChild(tdJ1);
					trJ.appendChild(tdJ2);
					trJ.appendChild(tdJ3);
					tbody1.appendChild(trJ);
				}

				table1.appendChild(tbody1);
				div.appendChild(table1);

				var table1 = document.createElement("table");
				var tbody1 = document.createElement("tbody");
				var tr1 = document.createElement("tr");
				var td1 = document.createElement("td");
				var text1 = document.createTextNode("Period Under Consideration");
				td1.appendChild(text1);
				td1.setAttribute("colspan", 3);
				tr1.appendChild(td1);
				tr1.setAttribute("bgcolor", "lightBlue");

				var tr2 = document.createElement("tr");
				var td21 = document.createElement("td");
				var text21 = document.createTextNode("IP");
				td21.appendChild(text21);
				var td22 = document.createElement("td");
				var text22 = document.createTextNode(ipFrom + " to " + ipTo);
				td22.appendChild(text22);
				var td23 = document.createElement("td");
				var text23 = document.createTextNode(ipMM + " Months");
				td23.appendChild(text23);
				tr2.appendChild(td21);
				tr2.appendChild(td22);
				tr2.appendChild(td23);

				var tr3 = document.createElement("tr");
				var td31 = document.createElement("td");
				var text31 = document.createTextNode("CP");
				td31.appendChild(text31);
				var td32 = document.createElement("td");
				var text32 = document.createTextNode(cpFrom + " to " + cpTo);
				td32.appendChild(text32);
				var td33 = document.createElement("td");
				var text33 = document.createTextNode(cpMM + " Months");
				td33.appendChild(text33);
				tr3.appendChild(td31);
				tr3.appendChild(td32);
				tr3.appendChild(td33);

				var tr4 = document.createElement("tr");
				var td41 = document.createElement("td");
				var text41 = document.createTextNode("Buffer");
				td41.appendChild(text41);
				var td42 = document.createElement("td");
				var text42 = document.createTextNode("-");
				td42.appendChild(text42);
				var td43 = document.createElement("td");
				var text43 = document.createTextNode(revisedBP + " Months");
				td43.appendChild(text43);
				tr4.appendChild(td41);
				tr4.appendChild(td42);
				tr4.appendChild(td43);

				tbody1.appendChild(tr1);
				tbody1.appendChild(tr2);
				tbody1.appendChild(tr3);
				tbody1.appendChild(tr4);
				table1.appendChild(tbody1);
				div.appendChild(table1);

				var table1 = document.createElement("table");
				var tbody1 = document.createElement("tbody");
				var tr1 = document.createElement("tr");
				var td1 = document.createElement("td");
				var text1 = document.createTextNode("Net Requirements");
				td1.appendChild(text1);
				td1.setAttribute("colspan", 10);
				tr1.appendChild(td1);
				var tr2 = document.createElement("tr");
				var td2 = document.createElement("td");
				var text2 = document.createTextNode("Depot");
				td2.appendChild(text2);
				var td3 = document.createElement("td");
				var text3 = document.createTextNode("AAC");
				td3.appendChild(text3);
				var td4 = document.createElement("td");
				var text4 = document.createTextNode("Monthly Requirement");
				td4.appendChild(text4);
				var td5 = document.createElement("td");
				var text5 = document.createTextNode("IP Requirement");
				td5.appendChild(text5);
				var td6 = document.createElement("td");
				var text6 = document.createTextNode("CP Requirement");
				td6.appendChild(text6);
				var td7 = document.createElement("td");
				var text7 = document.createTextNode("BP Requirement");
				td7.appendChild(text7);
				var td8 = document.createElement("td");
				var text8 = document.createTextNode("CD");
				td8.appendChild(text8);
				var td9 = document.createElement("td");
				var text9 = document.createTextNode("UCD");
				td9.appendChild(text9);
				var td10 = document.createElement("td");
				var text10 = document.createTextNode("Stock");
				td10.appendChild(text10);
				var td11 = document.createElement("td");
				var text11 = document.createTextNode("Total Requirement");
				td11.appendChild(text11);
				tr2.appendChild(td2);
				tr2.appendChild(td3);
				tr2.appendChild(td4);
				tr2.appendChild(td5);
				tr2.appendChild(td6);
				tr2.appendChild(td7);
				tr2.appendChild(td8);
				tr2.appendChild(td9);
				tr2.appendChild(td10);
				tr2.appendChild(td11);
				tr1.setAttribute("bgcolor", "lightBlue");
				tr2.setAttribute("bgcolor", "lightBlue");
				tbody1.appendChild(tr1);
				tbody1.appendChild(tr2);

				for (var i = 0; i <= depotArray.length; i++) {
					var trM = document.createElement("tr");
					var tdM1 = document.createElement("td");
					var textM1;
					if (i == depotArray.length) {
						textM1 = document.createTextNode("Total");
					} else {
						textM1 = document.createTextNode(depotArray[i]);
					}
					tdM1.appendChild(textM1);

					var tdM2 = document.createElement("td");
					var textM2;
					if (i == depotArray.length) {
						textM2 = document.createTextNode(revisedAacArray.reduce((a, b) => a + b, 0));
					} else {
						textM2 = document.createTextNode(revisedAacArray[i]);
					}
					tdM2.appendChild(textM2);

					var tdM3 = document.createElement("td");
					var textM3;
					if (i == depotArray.length) {
						textM3 = document.createTextNode(Math.round(revisedMcArray.reduce((a, b) => a + b, 0) * 100) / 100);
					} else {
						textM3 = document.createTextNode(Math.round(revisedMcArray[i] * 100) / 100);
					}
					tdM3.appendChild(textM3);

					var tdM4 = document.createElement("td");
					var textM4;
					if (i == depotArray.length) {
						textM4 = document.createTextNode(Math.round(ipRequirementsArray.reduce((a, b) => a + b, 0) * 100) / 100);
					} else {
						var ipRequirement = revisedMcArray[i] * ipMM;
						ipRequirementsArray.push(+ipRequirement);
						textM4 = document.createTextNode(Math.round(ipRequirement * 100) / 100);
					}
					tdM4.appendChild(textM4);

					var tdM5 = document.createElement("td");
					var textM5;
					if (i == depotArray.length) {
						textM5 = document.createTextNode(Math.round(cpRequirementsArray.reduce((a, b) => a + b, 0) * 100) / 100);
					} else {
						var cpRequirement = revisedAacArray[i];
						cpRequirementsArray.push(+cpRequirement);
						textM5 = document.createTextNode(Math.round(cpRequirement * 100) / 100);
					}
					tdM5.appendChild(textM5);

					var tdM6 = document.createElement("td");
					var textM6;
					if (i == depotArray.length) {
						textM6 = document.createTextNode(Math.round(bpRequirementsArray.reduce((a, b) => a + b, 0) * 100) / 100);
					} else {
						var bpRequirement = revisedMcArray[i] * revisedBP;
						bpRequirementsArray.push(+bpRequirement);
						textM6 = document.createTextNode(Math.round(bpRequirement * 100) / 100);
					}
					tdM6.appendChild(textM6);

					var tdM7 = document.createElement("td");
					var textM7;
					if (i == depotArray.length) {
						textM7 = document.createTextNode(totalCoveredDuesArray.reduce((a, b) => a + b, 0));
					} else {
						textM7 = document.createTextNode(totalCoveredDuesArray[i]);
					}
					tdM7.appendChild(textM7);

					var tdM8 = document.createElement("td");
					var textM8;
					if (i == depotArray.length) {
						textM8 = document.createTextNode(totalUncoveredDuesArray.reduce((a, b) => a + b, 0));
					} else {
						textM8 = document.createTextNode(totalUncoveredDuesArray[i]);
					}
					tdM8.appendChild(textM8);

					var tdM9 = document.createElement("td");
					var textM9;
					if (i == depotArray.length) {
						textM9 = document.createTextNode(stockArray.reduce((a, b) => a + b, 0));
					} else {
						textM9 = document.createTextNode(stockArray[i]);
					}
					tdM9.appendChild(textM9);

					var tdM10 = document.createElement("td");
					var textM10;
					if (i == depotArray.length) {
						textM10 = document.createTextNode(Math.round(netRequirementsArray.reduce((a, b) => a + b, 0) * 100) / 100);
					} else {
						var netRequirement = +ipRequirement + +cpRequirement + +bpRequirement - +totalCoveredDuesArray[i] - +totalUncoveredDuesArray[i] - +stockArray[i];
						netRequirementsArray.push(+netRequirement);
						textM10 = document.createTextNode(Math.round(netRequirement * 100) / 100);
					}
					tdM10.appendChild(textM10);

					trM.appendChild(tdM1);
					trM.appendChild(tdM2);
					trM.appendChild(tdM3);
					trM.appendChild(tdM4);
					trM.appendChild(tdM5);
					trM.appendChild(tdM6);
					trM.appendChild(tdM7);
					trM.appendChild(tdM8);
					trM.appendChild(tdM9);
					trM.appendChild(tdM10);

					tbody1.appendChild(trM);
				}

				table1.appendChild(tbody1);
				div.appendChild(table1);

				qwsDiv.parentElement.appendChild(div);
			};

			document.addEventListener("click", (e) => {
				if (e.target.name == "btn_QWS_0") {
					confirmData();

					s_22.querySelectorAll("#QWSDiv")[0].style.display = "none";
					s_22.style.top = s_3.offsetHeight + "px";
					var s_22cssText = s_22.style.cssText;
					var s_22cssTextNew = s_22cssText.slice(0, s_22cssText.indexOf("width:") - 2) + " !important" + s_22cssText.slice(s_22cssText.indexOf("width:") - 2);
					s_22.style.cssText = s_22cssTextNew;
				}
			});
		}

		if (document.title == "Demand Generation (Stock)" || document.title == "Run Form - IMMIS/PUR/DEMANDSTK") {
			body.classList.add("demand_generation");
		}

		if (document.title == "Receipt Note Preparation" || document.title == "Run Form - IMMIS/DEP/RNOTE") {
			body.classList.add("rnote");
		}

		if (document.title == "Receipt Inspection Report" || document.title == "Run Form - IMMIS/DEP/RI") {
			body.classList.add("isl");

			var wardSelectButton = body.querySelectorAll("#s_0_13")[0];
			wardSelectButton.click();

			var LovTable = body.querySelectorAll("#_LovTable")[0];
			LovTable.querySelectorAll("a")[0].click();

			var refreshButton = body.querySelectorAll("#s_0_18")[0];
			refreshButton.click();
		}

		if (document.title == "DRR Status Update" || document.title == "Run Form - IMMIS/DEP/DRRDEL") {
			body.classList.add("drop_drr");
		}

		if (document.title == "Status of Stocking Proposals" || document.title == "Run Form - IMMIS/QFSTATUS") {
			body.classList.add("plus_status");
		}

		if (document.title == "STOCKING PROPOSAL" || document.title == "Run Form - IMMIS/DEP/STKPROP") {
			body.classList.add("stocking_proposal");
		}

		if (document.title == "Registers for Purchase Module" || document.title == "Run Form - IMMIS/PUR/HQREGISTERS") {
			body.classList.add("purchase_register");
		}

		if (document.title == "Stock Verification" || document.title == "Run Form - IMMIS/DEP/STKVERIFY") {
			body.classList.add("stock_verification");
		}

		if (document.title == "Book Transfer" || document.title == "Run Form - IMMIS/DEP/BOOKXFER") {
			body.classList.add("book_transfer");
		}

		if (document.title == "Gen Requisition for Material consumed in testing" || document.title == "Run Form - IMMIS/DEP/REQN_GEN_DEPOT") {
			body.classList.add("gen_req_for_consumed");
		}

		if (document.title == "Request for Creation of Vendor" || document.title == "Run Form - IMMIS/PUR/VENDREQ") {
			body.classList.add("new_vendor_request");
		}

		if (document.title == "Advance Intimation/Action for Estimate Sheets" || document.title == "Run Form - IMMIS/DEP/AIS") {
			body.classList.add("ais");
			var LovDiv = document.querySelectorAll("#LovDiv")[0];
			var s__cnvs4 = document.querySelectorAll("#s__cnvs5")[0];

			document.addEventListener("click", (e) => {
				var scrollTop = window.pageYOffset || e.target.scrollTop || document.body.scrollTop;
				var s_3 = document.querySelectorAll("#s_3")[0];
				var DivAlertBox = document.querySelectorAll("#DivAlertBox")[0];
				var divShowHtml1 = document.querySelectorAll("#divShowHtml1")[0];

				if (e.target.value == "AAC") {
					scrollTop += 150;

					s_3.style.cssText = "top: " + scrollTop + "px !important; border: 2px solid black; padding: 5px; background-color: #66ffff;";
				}
				if (e.target.value == "Save/Forward/Authorize") {
					scrollTop += 150;

					DivAlertBox.style.cssText = "top: " + scrollTop + "px !important; border: 2px solid black; padding: 5px; background-color: #66ffff; z-index: 99; position: absolute;";
				}
				if (e.target.value == "Print") {
					scrollTop += 150;

					divShowHtml1.style.cssText = "top: " + scrollTop + "px !important; border: 2px solid black; padding: 5px; background-color: #66ffff; z-index: 99; position: absolute;";
				}

				if (e.target.parentElement.parentElement != null && e.target.parentElement.parentElement.id.includes("AIS_Row_")) {
					scrollTop += 150;

					divShowHtml1.style.cssText = "top: " + scrollTop + "px !important; border: 2px solid black; padding: 5px; background-color: #66ffff; z-index: 99; position: absolute;";
				}

				if (e.target.value == "Select") {
					scrollTop += 150;

					s__cnvs4.style.cssText = "top: " + scrollTop + "px !important; border: 5px solid black; padding: 5px; background-color: #aaaaaa; position: absolute;";
				}

				if (e.target.title == "Click to See List of Values") {
					scrollTop += 150;

					LovDiv.style.cssText = "top: " + e.target.getBoundingClientRect().top + 150 + "px !important; border: 2px solid black; padding: 0; background-color: #aaaaaa; z-index: 99; position: absolute; left: calc(50% - 380px)";

					LovDiv.scrollIntoView();
				}

				if (e.target.id.search("_LOV_AIS") != -1 || (e.target.tagName == "A" && e.target.closest("tr").children[0].children[0].id.search("_LOV_AIS") != -1)) {
					var pl = document.querySelectorAll("#s_2")[0].querySelectorAll("input[name='PLGRP_0']")[0].value;
					var itemNature = getItemNature(pl);

					if (itemNature == "S" || itemNature == "V" || itemNature == "MC" || itemNature == "PN") {
						var p = document.createElement("p");
						var pText = document.createTextNode("This is a safety item");
						p.appendChild(pText);
						p.style.color = "red";
						p.style.fontSize = "18px";
						p.style.fontWeight = "bold";
						p.id = "safety_warning";
						s_3.querySelectorAll("table")[0].querySelectorAll("td")[1].appendChild(p);
					} else {
						if (s_3.querySelectorAll("p#safety_warning")[0] != null) {
							s_3.querySelectorAll("p#safety_warning")[0].remove();
						}
					}

					var aacTable = s_3.querySelectorAll(":scope > table")[1].querySelectorAll("div")[0].querySelectorAll("tbody")[0];

					for (var i = 2; i < aacTable.children.length - 1; i++) {
						var row = aacTable.children[i];
						var aacProposedByDepot = row.children[10].innerText.trim();
						row.children[12].querySelectorAll("input")[0].value = aacProposedByDepot;
					}

					aacTable.lastChild.querySelectorAll("#aac_wef_1")[0].checked = false;
					aacTable.lastChild.querySelectorAll("#aac_wef_2")[0].selectedIndex = 1;
				}
			});

			/*var plInput = document.querySelectorAll("input[name='PLGRP_0']")[0];
                  plInput.addEventListener("keydown", (e) => {
                      if (e.key === "Tab" || e.key === "Enter") {
      
                          LovDiv.querySelectorAll("a")[0].focus();
      
                      }
                  });*/
		}

		if (document.title == "Revision & Closure of Stock Accounts" || document.title == "Run Form - IMMIS/DEP/STKMASTER") {
			body.classList.add("stockmaster_ard");
		}

		if (document.title == "PO Cancellation" || document.title == "Run Form - IMMIS/PUR/POCA") {
			body.classList.add("po_cancellation");

			var caKeyInput = document.querySelectorAll("#s_2")[0].querySelectorAll("#s_0_15")[0];
			caKeyInput.focus();
		}

		if (document.title == "Search / View NIT and Tabulations" || document.title == "Run Form - IMMIS/NITSEARCH") {
			body.classList.add("nit_search");

			document.addEventListener("click", (e) => {
				if (e.target.title == "Download Documents") {
					var scrollTop = window.pageYOffset || e.target.scrollTop || document.body.scrollTop;
					var s_3 = document.querySelectorAll("#s_3")[0];
					var existingStyle = s_3.style.cssText;
					scrollTop += 150;

					s_3.style.cssText = "top: " + scrollTop + "px !important; border: 2px solid black; padding: 5px; background-color: #66ffff;";
				}
			});

			var s_0_14 = body.querySelectorAll("#s_0_14")[0];
			var s_0_16 = body.querySelectorAll("#s_0_16")[0];
			var s_0_17 = body.querySelectorAll("#s_0_17")[0];

			var dateFrom = s_0_16.value.split("-")[0] + "-" + s_0_16.value.split("-")[1] + "-" + (+s_0_16.value.split("-")[2] - 1);
			s_0_16.value = dateFrom;
			s_0_14.selectedIndex = 4;
		}

		if (document.title == "Vendor Performance" || document.title == "Run Form - IMMIS/PUR/VENDPOS") {
			body.classList.add("vendor_performance");
			var vendorNameInput = document.querySelectorAll("input[name='VNAME_0']")[0];
			vendorNameInput.focus();

			var s_2 = document.querySelectorAll("#s_2")[0];
			var s_3 = document.querySelectorAll("#s_3")[0];

			var dateType = s_2.querySelectorAll("select[name='DATE_OPT_0']")[0];

			var dateFromInput = s_2.querySelectorAll("input[name='DtFrom_0']")[0];
			var dateToInput = s_2.querySelectorAll("input[name='DT_TO_0']")[0];

			var dateTo = dateToInput.value;
			var dateToArray = dateToInput.value.split("-");
			var dateFrom;
			if (["JAN", "FEB", "MAR"].includes(dateToArray[1])) {
				dateFrom = "01-APR-" + (+dateToArray[2] - 4);
			} else {
				dateFrom = "01-APR-" + (+dateToArray[2] - 3);
			}
			dateFromInput.value = dateFrom;

			document.addEventListener("click", (e) => {
				if (e.target.id.search("_LOV_VEND") != -1 || (e.target.tagName == "A" && e.target.closest("tr").children[0].children[0].id.search("_LOV_VEND") != -1)) {
					s_2.querySelectorAll("#LBL_B1_SCOPE")[0].nextElementSibling.querySelectorAll("input[value='A']")[0].click();
					s_2.querySelectorAll("input[name='btn_Show_0']")[0].click();
				}

				if (e.target.name == "btn_Show_0") {
					var table = s_2.querySelectorAll("tbody")[0];

					if (!e.target.closest("table").nextSibling) {
						var table1 = document.createElement("table");
						var tbody1 = document.createElement("tbody");

						var tr1 = document.createElement("tr");
						var td1 = document.createElement("th");
						var text1 = document.createTextNode("Total Orders");
						var td2 = document.createElement("th");
						var text2 = document.createTextNode("Fully Completed");
						var td3 = document.createElement("th");
						var text3 = document.createTextNode("Partly Completed");
						var td4 = document.createElement("th");
						var text4 = document.createTextNode("Cancelled");
						var td5 = document.createElement("th");
						var text5 = document.createTextNode("Failed");

						td1.appendChild(text1);
						td2.appendChild(text2);
						td3.appendChild(text3);
						td4.appendChild(text4);
						td5.appendChild(text5);
						tr1.appendChild(td1);
						tr1.appendChild(td2);
						tr1.appendChild(td3);
						tr1.appendChild(td4);
						tr1.appendChild(td5);

						var tr2 = document.createElement("tr");
						var td6 = document.createElement("td");
						var td7 = document.createElement("td");
						var td8 = document.createElement("td");
						var td9 = document.createElement("td");
						var td10 = document.createElement("td");

						tr2.appendChild(td6);
						tr2.appendChild(td7);
						tr2.appendChild(td8);
						tr2.appendChild(td9);
						tr2.appendChild(td10);

						tbody1.appendChild(tr1);
						tbody1.appendChild(tr2);
						table1.appendChild(tbody1);
						table1.setAttribute("border", "1");

						e.target.closest("table").parentElement.appendChild(table1);
					}

					var numTotalPO = 0;
					var numPCPO = 0;
					var numFCPO = 0;
					var numCancelledPO = 0;
					var numFailedPO = 0;

					var poQty = 0;
					var cancelledQty = 0;
					var suppliedQty = 0;
					var poStatus = "";

					var rows = s_3.children[2].children[0].children[1].querySelectorAll("table")[1].children[0].children;

					for (var i = 1; i < rows.length; i++) {
						var row = rows[i];
						numTotalPO++;

						if (row.children[0].innerHTML != "<br>") {
							var poZone = row.children[0].innerText.split(":")[0];
							var poNo = row.children[0].innerText.split(":")[1].split(" ")[0];
							var poDate = row.children[0].innerText.split("dt.")[1];
							var poYear = "20" + poDate.split("-")[2];

							var p1 = document.createElement("p");
							p1.innerText = poZone;
							row.children[0].innerHTML = "";
							row.children[0].appendChild(p1);

							var link = document.createElement("a");
							var linkText = document.createTextNode(poNo);
							link.appendChild(linkText);
							link.title = poNo;
							link.href = "https://ireps.gov.in/ireps/etender/pdfdocs/MMIS/PO/" + poYear + "/" + zoneJson[poZone] + "/" + poNo + ".pdf";
							link.target = "_blank";
							row.children[0].appendChild(link);

							var p2 = document.createElement("p");
							p2.innerText = "dt. " + poDate;
							row.children[0].appendChild(p2);
						}

						poQty = row.children[6].innerText.split(" ")[0];
						cancelledQty = row.children[7].innerText == "-" ? 0 : row.children[7].innerText;
						row.children[7].style.color = "red";
						suppliedQty = row.children[8].innerText == "-" ? 0 : row.children[8].innerText;
						poStatus = row.children[12].innerText;

						if (+suppliedQty > 0 && +suppliedQty < 0.95 * +poQty && cancelledQty < 0.5 * poQty) {
							numPCPO++;
						}

						if (+suppliedQty >= 0.95 * +poQty) {
							numFCPO++;
						}

						if (cancelledQty >= 0.5 * +poQty) {
							numCancelledPO++;
						}

						if (cancelledQty == 0 && suppliedQty == 0 && poStatus == "D/P Expired") {
							numFailedPO++;
						}
					}

					e.target.closest("table").nextElementSibling.querySelectorAll("td")[0].innerText = numTotalPO;
					e.target.closest("table").nextElementSibling.querySelectorAll("td")[1].innerText = numFCPO + " ( " + Math.round((numFCPO / numTotalPO) * 100) + "% )";
					e.target.closest("table").nextElementSibling.querySelectorAll("td")[2].innerText = numPCPO + " ( " + Math.round((numPCPO / numTotalPO) * 100) + "% )";
					e.target.closest("table").nextElementSibling.querySelectorAll("td")[3].innerText = numCancelledPO + " ( " + Math.round((numCancelledPO / numTotalPO) * 100) + "% )";
					e.target.closest("table").nextElementSibling.querySelectorAll("td")[4].innerText = numFailedPO + " ( " + Math.round((numFailedPO / numTotalPO) * 100) + "% )";

					var printButton = s_3.querySelectorAll("table")[0].querySelectorAll("td")[1].querySelectorAll("a")[0];
					var vendorName = vendorNameInput.value.substring(0, 36);
					printButton.setAttribute("onclick", "PrintHtml(GLOBAL.HtmlPos, 'Performance - " + vendorName + "')");
				}

				if (e.target.name == "btn_Exit_0") {
					dateType.selectedIndex = "0";

					var dateFrom;
					if (["JAN", "FEB", "MAR"].includes(dateToArray[1])) {
						dateFrom = "01-APR-" + (+dateToArray[2] - 4);
					} else {
						dateFrom = "01-APR-" + (+dateToArray[2] - 3);
					}

					dateFromInput.value = dateFrom;
					dateToInput.value = dateTo;
				}
			});

			vendorNameInput.addEventListener("keydown", (e) => {
				if (e.key === "Tab" || e.key === "Enter") {
					e.target.nextElementSibling.click();
				}
			});
		}

		if (document.title == "RR/Challan/DRR Registration" || document.title == "Run Form - IMMIS/DEP/DRR") {
			body.classList.add("drr_registration");
		}

		if (document.title == "Inventory Assistant" || document.title == "Run Form - IMMIS/DEP/STKASSIST") {
			body.classList.add("inventory_assistant");
		}

		if (document.title == "GeM Coverage PO Report" || document.title == "Run Form - IMMIS/PUR/GEMORDERS") {
			body.classList.add("gem_orders");

			document.addEventListener("click", (e) => {
				if (e.target.name == "BTN_SHOW_0") {
					var s_3 = document.querySelectorAll("#s_3")[0];
					var table = s_3.querySelectorAll("div")[0].querySelectorAll("tbody")[0];

					var tr1 = document.createElement("tr");
					var td1 = document.createElement("td");
					var td2 = document.createElement("td");
					var td3 = document.createElement("td");
					var td4 = document.createElement("td");
					var td5 = document.createElement("td");
					var text1 = document.createTextNode("Total Value");
					td4.appendChild(text1);
					tr1.appendChild(td1);
					tr1.appendChild(td2);
					tr1.appendChild(td3);
					tr1.appendChild(td4);
					tr1.appendChild(td5);
					table.querySelectorAll("tr")[0].insertAdjacentElement("afterend", tr1);

					var total = 0;

					for (var i = 2; i < table.children.length; i++) {
						var orderValue = table.children[i].querySelectorAll("td")[4].innerText;
						total += +orderValue;
					}

					table.querySelectorAll("tr")[1].querySelectorAll("td")[4].innerText = total.toFixed(2);
					table.querySelectorAll("tr")[1].querySelectorAll("td")[4].style.textAlign = "right";
				}
			});
		}

		if (document.title == "Generate Gate Pass" || document.title == "Run Form - IMMIS/DEP/GATEPASS") {
			body.classList.add("gen_gate_pass");
		}

		if (document.title == "Sale Issue Note" || document.title == "Run Form - IMMIS/DEP/SALEISSUE") {
			body.classList.add("sale_issue_note");
		}

		if (document.title == "E-Gate Entry" || document.title == "Run Form - IMMIS/DEP/EGATE_ENTRY") {
			body.classList.add("egate_entry");

			document.addEventListener("click", (e) => {
				if (e.target.name == "SHOW_EDISP_0") {
					var titleBar = document.querySelectorAll("#TitleBar")[0];
					var depotCode = titleBar.querySelectorAll("td")[0].innerText.split(":")[2].substring(3, 5);
					var zoneCode = titleBar.querySelectorAll("td")[0].innerText.split(":")[0].substring(1, 3);

					var s_3 = document.querySelectorAll("#s_3")[0];
					var rows = s_3.querySelectorAll("div")[0].querySelectorAll("tbody")[0].children;

					for (var i = 1; i < rows.length; i++) {
						var row = rows[i];
						var eDispatchNo = row.querySelectorAll("td")[1].innerText;
						var eDispatchDepot = eDispatchNo.split("/")[1];

						if (eDispatchDepot != "00" + depotCode + "00") {
							row.style.display = "none";
						}

						var poNo = row.querySelectorAll("td")[7].innerText;
						var poDate = row.querySelectorAll("td")[8].innerText;
						var poYear = "20" + poDate.split("-")[2];

						var link = document.createElement("a");
						var linkText = document.createTextNode(poNo);
						link.appendChild(linkText);
						link.title = poNo;
						link.href = "https://ireps.gov.in/ireps/etender/pdfdocs/MMIS/PO/" + poYear + "/" + zoneCode + "/" + poNo + ".pdf";
						link.target = "_blank";
						row.children[7].innerHTML = "";
						row.children[7].appendChild(link);
					}
				}
			});

			var eDispatchButton = body.querySelectorAll("#s_0_12")[0];
			eDispatchButton.click();
		}

		if (document.title == "Issue of Stores against Registered Requisitions" || document.title == "Run Form - IMMIS/DEP/REQNISSUE") {
			body.classList.add("reqn_issue");
		}

		if (document.title == "Stock Balance Report" || document.title == "Run Form - IMMIS/DEP/STOCKMASTER") {
			body.classList.add("stockmaster");

			body.querySelectorAll("textarea[name='report_format_0']")[0].removeAttribute("readonly");
			body.querySelectorAll("textarea[name='report_format_0']")[0].value = "PL No,Description,Long Description,ABC,AAC,CCONS3,CCONS2,CCONS1,CCONS0,Stock,CBQTY PrevYr,BAR";
		}

		if (document.title == "Output of Report - LISTPOS" || document.title == "Output of Report - LISTPOS") {
			body.classList.add("list_position");

			var table1 = body.querySelectorAll("table")[0];
			var table1Rows = table1.querySelectorAll("tbody")[0].children;

			for (var i = 0; i < table1Rows.length; i++) {
				var row = table1Rows[i];

				if (row.querySelectorAll("th")[0] && row.querySelectorAll("th")[0].innerText.startsWith("COVDUES")) {
					var rowTh = row.querySelectorAll("th")[0];

					var tr = document.createElement("tr");
					var th = document.createElement("th");
					var thText = document.createTextNode("Covered Dues");
					th.appendChild(thText);
					tr.appendChild(th);
					rowTh.closest("tbody").insertBefore(th, rowTh.closest("tbody").children[0]);

					var th2 = document.createElement("th");
					var thText2 = document.createTextNode("Depot");
					th2.appendChild(thText2);
					rowTh.parentElement.insertBefore(th2, rowTh);

					var th3 = document.createElement("th");
					var thText3 = document.createTextNode("PO Qty");
					th3.appendChild(thText3);
					rowTh.parentElement.insertBefore(th3, rowTh);

					var th4 = document.createElement("th");
					var thText4 = document.createTextNode("Due Qty");
					th4.appendChild(thText4);
					rowTh.parentElement.insertBefore(th4, rowTh);

					var th5 = document.createElement("th");
					var thText5 = document.createTextNode("Rate");
					th5.appendChild(thText5);
					rowTh.parentElement.insertBefore(th5, rowTh);

					var th6 = document.createElement("th");
					var thText6 = document.createTextNode("Delivery Date");
					th6.appendChild(thText6);
					rowTh.parentElement.insertBefore(th6, rowTh);

					var th7 = document.createElement("th");
					var thText7 = document.createTextNode("PO Serial");
					th7.appendChild(thText7);
					rowTh.parentElement.insertBefore(th7, rowTh);

					rowTh.remove();

					var table2 = row.querySelectorAll("table")[0];
					var table2Rows = table2.querySelectorAll("tbody")[0].children;

					if (table2Rows.length > 1) {
						for (var j = 1; j < table2Rows.length; j++) {
							var row2 = table2Rows[j];
							/*row2.children[7].remove();
                                          row2.children[6].remove();
                                          row2.children[5].remove();
                                          row2.children[3].remove();
                                          row2.children[1].remove();*/
						}
					}
				}

				if (row.querySelectorAll("th")[0] && row.querySelectorAll("th")[0].innerText == "UDM STOCK") {
					row.style.display = "none";
				}

				if (row.querySelectorAll("th")[5] && row.querySelectorAll("th")[5].innerText == "===Consumptions===") {
					var rowTh = row.querySelectorAll("th")[5];
					var table3 = row.querySelectorAll("table")[0];
					var table3Rows = table3.querySelectorAll("tbody")[0].children;

					for (var k = 0; k < table3Rows.length; k++) {
						var row3 = table3Rows[k];

						if (k == 0) {
							var th2 = document.createElement("th");
							var thText2 = document.createTextNode("Cons LY");
							th2.appendChild(thText2);
							rowTh.parentElement.insertBefore(th2, rowTh);

							var th3 = document.createElement("th");
							var thText3 = document.createTextNode("Cons CY");
							th3.appendChild(thText3);
							rowTh.parentElement.insertBefore(th3, rowTh);

							rowTh.remove();
							row3.children[8].remove();
							row3.children[7].remove();
							row3.children[4].remove();
							row3.children[2].remove();

							row3.children[0].removeAttribute("rowspan");
							row3.children[1].removeAttribute("rowspan");
							row3.children[1].innerText = "AAC";
							row3.children[2].removeAttribute("rowspan");
							row3.children[3].removeAttribute("rowspan");
							row3.children[4].removeAttribute("rowspan");
						} else if (k == 1) {
							row3.children[0].remove();
							row3.children[0].remove();
							row3.children[0].remove();
						} else if (k > 1 && k < table3Rows.length - 1) {
							row3.children[1].setAttribute("align", "center");
							row3.children[9].remove();
							row3.children[8].remove();
							row3.children[5].remove();
							row3.children[4].remove();
							row3.children[2].remove();
						} else {
							row3.children[2].remove();
						}
					}

					var table4 = row.querySelectorAll("table")[1];
					var table4Rows = table4.querySelectorAll("tbody")[0].children;

					for (var m = 1; m < table4Rows.length; m++) {
						var row4 = table4Rows[m];
						if (!row4.children[2].innerText.startsWith("T/No.") || row4.children[0].innerText == "") {
							row4.style.display = "none";
						}
					}
				}
			}

			var table5 = body.querySelectorAll("table")[0];
			var table5Rows = table5.querySelectorAll("tbody")[0].children;

			for (var p = 0; p < table5Rows.length; p++) {
				var row5 = table5Rows[p];

				if (row5.querySelectorAll("th")[0] && row5.querySelectorAll("th")[0].innerText == "Covered Dues") {
					var table6 = row5.querySelectorAll("table")[0];
					var table6Rows = table6.querySelectorAll("tbody")[0].children;

					if (table6Rows.length > 1) {
						for (var q = 2; q < table6Rows.length; q++) {
							var row6 = table6Rows[q];

							if (row6.children[0].querySelectorAll("br")) {
								var depotArray = row6.children[0].innerText.split("\n");
								var poQtyArray = row6.children[1].innerText.split("\n");
								var dueQtyArray = row6.children[2].innerText.split("\n");
								var rateArray = row6.children[3].innerText.split("\n");
								var dpArray = row6.children[4].innerText.split("\n");
								var poSerialArray = row6.children[5].innerText.split("\n");

								for (var n = 0; n < depotArray.length; n++) {
									var tr = document.createElement("tr");

									var td1 = document.createElement("td");
									var tdText1 = document.createTextNode(depotArray[n]);
									td1.appendChild(tdText1);
									tr.appendChild(td1);

									var td2 = document.createElement("td");
									var tdText2 = document.createTextNode(poQtyArray[n]);
									td2.appendChild(tdText2);
									tr.appendChild(td2);

									var td3 = document.createElement("td");
									var tdText3 = document.createTextNode(dueQtyArray[n]);
									td3.appendChild(tdText3);
									tr.appendChild(td3);

									var td4 = document.createElement("td");
									var tdText4 = document.createTextNode(rateArray[n]);
									td4.appendChild(tdText4);
									tr.appendChild(td4);

									var td5 = document.createElement("td");
									var tdText5 = document.createTextNode(dpArray[n]);
									td5.appendChild(tdText5);
									tr.appendChild(td5);

									var td6 = document.createElement("td");
									var tdText6 = document.createTextNode(poSerialArray[n]);
									td6.appendChild(tdText6);
									tr.appendChild(td6);

									var td7 = document.createElement("td");
									var tdText7 = row6.children[6].cloneNode(true);
									td7.appendChild(tdText7);
									tr.appendChild(td7);

									row6.parentElement.insertBefore(tr, row6);
								}

								if (row6.children[7] && (row6.children[7].innerText.includes("DRR") || row6.children[7].innerText.includes("ISL"))) {
									var accountalArray = row6.children[7].innerText.split(/DRR:|ISL:|R\/N:|Rej:/);

									for (var i = 1; i < accountalArray.length; i++) {
										var accountalRow = accountalArray[i];

										var tr2 = document.createElement("tr");

										var td1 = document.createElement("td");
										var tdText1 = document.createTextNode("Material under accountal at " + accountalRow.substring(0, accountalRow.indexOf(" ") - 9));
										td1.appendChild(tdText1);
										tr2.appendChild(td1);

										var td2 = document.createElement("td");
										var tdText2 = document.createTextNode("NA");
										td2.appendChild(tdText2);
										tr2.appendChild(td2);

										var td3 = document.createElement("td");
										var tdText3 = document.createTextNode(accountalRow.substring(accountalRow.indexOf("for") + 4));
										td3.appendChild(tdText3);
										tr2.appendChild(td3);

										var td4 = document.createElement("td");
										var tdText4 = document.createTextNode("NA");
										td4.appendChild(tdText4);
										tr2.appendChild(td4);

										var td5 = document.createElement("td");
										var tdText5 = document.createTextNode(accountalRow.substring(accountalRow.indexOf("dt.") + 3, accountalRow.indexOf("dt.") + 11));
										td5.appendChild(tdText5);
										tr2.appendChild(td5);

										var td6 = document.createElement("td");
										var tdText6 = document.createTextNode("NA");
										td6.appendChild(tdText6);
										tr2.appendChild(td6);

										var td7 = document.createElement("td");
										var tdText7 = document.createTextNode(row6.children[6].innerText);
										/*var tdText7 = document.createTextNode(row6.children[7].innerText.substring(row6.children[7].innerText.indexOf("for")+4));*/
										td7.appendChild(tdText7);
										tr2.appendChild(td7);

										row6.parentElement.insertBefore(tr2, row6);
									}
								}

								row6.remove();
							} else {
								var depot = row6.children[0].innerText;
								var dueQty = row6.children[2].innerText;
								var dp = row6.children[4].innerText;

								var tr = document.createElement("tr");

								var td1 = document.createElement("td");
								var tdText1 = document.createTextNode(depot);
								td1.appendChild(tdText1);
								tr.appendChild(td1);

								var td2 = document.createElement("td");
								var tdText2 = document.createTextNode(dueQty);
								td2.appendChild(tdText2);
								tr.appendChild(td2);

								var td3 = document.createElement("td");
								var tdText3 = document.createTextNode(dp);
								td3.appendChild(tdText3);
								tr.appendChild(td3);

								var td4 = document.createElement("td");
								var tdText4 = row6.children[6].cloneNode(true);
								td4.appendChild(tdText4);
								tr.appendChild(td4);

								row6.parentElement.insertBefore(tr, row6);
							}
						}
					}
				}
			}

			for (var p = 0; p < table5Rows.length; p++) {
				var row5 = table5Rows[p];

				if (row5.querySelectorAll("th")[4] && row5.querySelectorAll("th")[4].innerText == "Cons CY") {
					var table6 = row5.querySelectorAll("table")[0];
					var table6Rows = table6.querySelectorAll("tbody")[0].children;
					var coverageTable = row5.nextElementSibling.querySelectorAll("table")[0];
					var coverageRows = coverageTable.querySelectorAll("tbody")[0].children;
					var cummulativeConsumptionCY = 0;
					var cummulativeConsumptionLY = 0;
					var cummulativeCoverage = 0;

					for (var q = 0; q < table6Rows.length; q++) {
						var row6 = table6Rows[q];

						if (row6.children[4]) {
							row6.insertBefore(row6.children[4], row6.children[3]);

							if (!isNaN(parseInt(row6.children[3].innerText))) {
								cummulativeConsumptionCY = cummulativeConsumptionCY + parseInt(row6.children[3].innerText);
							}
							if (!isNaN(parseInt(row6.children[4].innerText))) {
								cummulativeConsumptionLY = cummulativeConsumptionLY + parseInt(row6.children[4].innerText);
							}
						}

						if (q >= 2 && q < table6Rows.length - 1) {
							var depotName = row6.children[0].innerText;
							var totalCoverageQty = 0;
							for (var r = 2; r < coverageRows.length; r++) {
								var coverageDepot = coverageRows[r].children[0].innerText;
								var coverageQty = coverageRows[r].children[2].innerText;
								var coveragePO = coverageRows[r].children[6].innerText;

								if (coverageDepot == depotName && coveragePO.substring(17, 18) != 8 && !isNaN(coverageQty)) {
									totalCoverageQty = +totalCoverageQty + +coverageQty;
								}
							}
							var td = document.createElement("td");
							var tdText = document.createTextNode(Math.round(+totalCoverageQty * 100) / 100);
							td.appendChild(tdText);
							td.style.border = "1px solid black";
							td.setAttribute("align", "center");
							row6.appendChild(td);
						}

						if (q == 0) {
							var th0 = document.createElement("th");
							var thText0 = document.createTextNode("Dues");
							th0.appendChild(thText0);
							row6.appendChild(th0);
							var th1 = document.createElement("th");
							var thText1 = document.createTextNode("Coverage");
							th1.appendChild(thText1);
							th1.setAttribute("colspan", "3");
							row6.appendChild(th1);
							var th2 = document.createElement("th");
							var thText2 = document.createTextNode("Remarks of HQ");
							th2.appendChild(thText2);
							row6.appendChild(th2);
							var th3 = document.createElement("th");
							var thText3 = document.createTextNode("Action taken by depot");
							th3.appendChild(thText3);
							row6.appendChild(th3);
							row6.setAttribute("bgcolor", "lightBlue");
						}

						if (q == 1) {
							row6.style.display = "none";
						}

						if (q == 2) {
							var depotName = row6.children[0].innerText;
							var td0 = document.createElement("td");
							var table = document.createElement("table");
							var tbody = document.createElement("tbody");
							table.style.borderCollapse = "collapse";
							table.setAttribute("width", "100%");
							table.appendChild(tbody);
							td0.appendChild(table);
							td0.setAttribute("rowspan", table6Rows.length - 3);
							td0.setAttribute("colspan", "3");
							row6.appendChild(td0);

							for (var r = 2; r < coverageRows.length; r++) {
								var coverageDepot = coverageRows[r].children[0].innerText;
								var coverageQty = coverageRows[r].children[2].innerText;
								var coverageDP = coverageRows[r].children[4].innerText;
								var coveragePO = coverageRows[r].children[6];
								var coveragePOText = coverageRows[r].children[6].innerText;
								var coveragePOPrev = coverageRows[r - 1].children[6].innerText;
								var coveragePONo = coveragePOText.substring(9, 23);
								var coveragePOPrevNo = coveragePOPrev.substring(9, 23);

								if (coveragePOText.substring(17, 18) != 8 && coveragePONo != coveragePOPrevNo) {
									var tr1 = document.createElement("tr");
									var td1 = document.createElement("td");
									var tdText2;
									if (coverageDepot.startsWith("Material under accountal")) {
										tdText2 = document.createTextNode(coverageDepot + ": " + coverageQty + "; Date: " + coverageDP);
									} else {
										tdText2 = document.createTextNode(coverageDepot + ": " + coverageQty + "; DP: " + coverageDP);
									}
									var br = document.createElement("br");
									td1.setAttribute("colspan", "3");
									td1.style.border = "1px solid black";
									td1.innerHTML = coveragePO.innerHTML;
									td1.appendChild(br);
									var span = document.createElement("span");
									span.appendChild(tdText2);

									var coverageDPDate = new Date("20" + coverageDP.split("/")[2] + "-" + coverageDP.split("/")[1] + "-" + coverageDP.split("/")[0]);
									if (today - coverageDPDate > 30 * 24 * 60 * 60 * 1000 && !span.innerText.startsWith("Material under accountal")) {
										span.style.color = "red";
									}

									td1.appendChild(span);
									tr1.appendChild(td1);
									row6.lastChild.children[0].children[0].appendChild(tr1);

									if (!isNaN(coverageQty)) {
										cummulativeCoverage += +coverageQty;
									}
								}
								if (coveragePOText.substring(17, 18) != 8 && coveragePOText === coveragePOPrev) {
									var tdText1;
									if (coverageDepot.startsWith("Material under accountal")) {
										tdText1 = document.createTextNode(coverageDepot + ": " + coverageQty + "; Date: " + coverageDP);
									} else {
										tdText1 = document.createTextNode(coverageDepot + ": " + coverageQty + "; DP: " + coverageDP);
									}
									var br = document.createElement("br");
									var tdNum = row6.lastChild.children[0].querySelectorAll("td").length;
									row6.lastChild.children[0].querySelectorAll("td")[tdNum - 1].appendChild(br);

									var span = document.createElement("span");
									span.appendChild(tdText1);

									var coverageDPDate = new Date("20" + coverageDP.split("/")[2] + "-" + coverageDP.split("/")[1] + "-" + coverageDP.split("/")[0]);
									if (today - coverageDPDate > 30 * 24 * 60 * 60 * 1000 && !span.innerText.startsWith("Material under accountal")) {
										span.style.color = "red";
									}

									row6.lastChild.children[0].querySelectorAll("td")[tdNum - 1].appendChild(span);

									if (!isNaN(coverageQty)) {
										cummulativeCoverage += +coverageQty;
									}
								}
							}

							row5.nextElementSibling.style.display = "none";

							var uncoveredDuesTable = row5.children[1].querySelectorAll("table")[0];
							var uncoveredRows = uncoveredDuesTable.querySelectorAll("tbody")[0].children;
							var uncoveredTenderNoArray = [];
							var uncoveredTenderDateArray = [];
							var uncoveredTenderTextArray = [];

							if (uncoveredRows.length > 1) {
								for (var r = 1; r < uncoveredRows.length; r++) {
									var uncoveredDepotArray = uncoveredRows[r].children[0].innerText.split("\n");
									var uncoveredQtyArray = uncoveredRows[r].children[1].innerText.split("\n");
									var uncoveredTender = uncoveredRows[r].children[2].innerText;
									var uncoveredTenderDateText = uncoveredTender.substring(uncoveredTender.indexOf("due on ") + 7, uncoveredTender.indexOf("due on ") + 15);
									var uncoveredTenderDate = new Date("20" + uncoveredTenderDateText.split("/")[2] + "-" + uncoveredTenderDateText.split("/")[1] + "-" + uncoveredTenderDateText.split("/")[0]);
									var uncoveredTenderNo = uncoveredTender.split(" ")[1].substring(0, 8);

									if (uncoveredTender.startsWith("T/No.") && !uncoveredTenderNoArray.includes(uncoveredTenderNo)) {
										uncoveredTenderNoArray.push(uncoveredTenderNo);
										uncoveredTenderDateArray.push(uncoveredTenderDate);

										var tr1 = document.createElement("tr");
										var td1 = document.createElement("td");
										var tdText1 = document.createTextNode(uncoveredTender);
										td1.appendChild(tdText1);

										uncoveredDepotArray.forEach((uncoveredDepot, s) => {
											var br = document.createElement("br");
											td1.appendChild(br);
											var tdText2 = document.createTextNode(uncoveredDepotArray[s] + ": " + uncoveredQtyArray[s] + "; ");
											td1.appendChild(tdText2);
										});

										td1.style.border = "1px solid black";
										td1.setAttribute("colspan", "3");
										tr1.appendChild(td1);

										uncoveredTenderTextArray.push(tr1);
									}
									if (uncoveredTender.startsWith("T/No.") && uncoveredTenderNoArray.includes(uncoveredTenderNo)) {
										var x = uncoveredTenderNoArray.indexOf(uncoveredTenderNo);
										if (uncoveredTenderDate > uncoveredTenderDateArray[x]) {
											uncoveredTenderDateArray[x] = uncoveredTenderDate;

											var tr1 = document.createElement("tr");
											var td1 = document.createElement("td");
											var tdText1 = document.createTextNode(uncoveredTender);
											td1.appendChild(tdText1);

											uncoveredDepotArray.forEach((uncoveredDepot, s) => {
												var br = document.createElement("br");
												td1.appendChild(br);
												var tdText2 = document.createTextNode(uncoveredDepotArray[s] + ": " + uncoveredQtyArray[s] + "; ");
												td1.appendChild(tdText2);
											});

											td1.style.border = "1px solid black";
											td1.setAttribute("colspan", "3");
											tr1.appendChild(td1);

											uncoveredTenderTextArray[x] = tr1;
										}
									}
								}
							}

							uncoveredTenderTextArray.forEach((uncoveredText) => {
								row6.lastChild.children[0].children[0].appendChild(uncoveredText);
							});

							var td1 = document.createElement("td");
							var text1 = document.createTextNode("UDM Stock: ");
							td1.setAttribute("rowspan", table6Rows.length - 3);
							td1.appendChild(text1);
							row6.appendChild(td1);

							var td2 = document.createElement("td");
							td2.setAttribute("rowspan", table6Rows.length - 3);
							row6.appendChild(td2);

							var descriptionText = row5.previousElementSibling.querySelectorAll("td")[0].innerText;
							var slNo = descriptionText.split(" ")[0].split(".")[0];
							var pl = descriptionText.split(" ")[1].split("-")[0];
							var itemDescription = descriptionText.substring(descriptionText.indexOf("-") + 1, descriptionText.indexOf("(CP-Start"));
							var cp = descriptionText.substring(descriptionText.indexOf("(CP-Start") + 11, descriptionText.indexOf("Pur.Sec:") - 2);
							var purchaseSection = descriptionText.substr(descriptionText.indexOf("Pur.Sec: ") + 9, 2);

							var td0 = document.createElement("td");
							var table1 = document.createElement("table");
							var tbody1 = document.createElement("tbody");
							var tr1 = document.createElement("tr");
							var th10 = document.createElement("th");
							var text10 = document.createTextNode("Sl No");
							th10.appendChild(text10);
							th10.style.border = "1px solid black";
							th10.setAttribute("bgcolor", "lightBlue");
							var th11 = document.createElement("th");
							var text11 = document.createTextNode("PL No");
							th11.appendChild(text11);
							th11.style.border = "1px solid black";
							th11.setAttribute("bgcolor", "lightBlue");
							var th12 = document.createElement("th");
							var text12 = document.createTextNode("Item Description");
							th12.appendChild(text12);
							th12.style.textAlign = "left";
							th12.style.border = "1px solid black";
							th12.setAttribute("bgcolor", "lightBlue");
							th12.setAttribute("colspan", "4");
							var th13 = document.createElement("th");
							var text13 = document.createTextNode("Vital/Safety");
							th13.appendChild(text13);
							th13.style.border = "1px solid black";
							th13.setAttribute("bgcolor", "lightBlue");
							var th14 = document.createElement("th");
							var text14 = document.createTextNode("Category");
							th14.appendChild(text14);
							th14.style.border = "1px solid black";
							th14.setAttribute("bgcolor", "lightBlue");
							var th15 = document.createElement("th");
							var text15 = document.createTextNode("Raised By");
							th15.appendChild(text15);
							th15.style.border = "1px solid black";
							th15.setAttribute("bgcolor", "lightBlue");
							var th16 = document.createElement("th");
							var text16 = document.createTextNode("Dealer");
							th16.appendChild(text16);
							th16.style.border = "1px solid black";
							th16.setAttribute("bgcolor", "lightBlue");
							tr1.appendChild(th10);
							tr1.appendChild(th11);
							tr1.appendChild(th12);
							tr1.appendChild(th13);
							tr1.appendChild(th14);
							tr1.appendChild(th15);
							tr1.appendChild(th16);

							var itemNature = getItemNature(pl);
							var itemCategory = getItemCategory(pl);
							var dealerName = getDealerByPl(pl);

							var tr2 = document.createElement("tr");
							var td20 = document.createElement("td");
							var text20 = document.createTextNode(slNo);
							td20.appendChild(text20);
							td20.style.border = "1px solid black";
							td20.style.width = "100px";
							td20.setAttribute("bgcolor", "lightBlue");
							td20.setAttribute("align", "center");
							var td21 = document.createElement("td");
							var p21 = document.createElement("p");
							var text21 = document.createTextNode(pl);
							p21.appendChild(text21);
							td21.appendChild(p21);
							td21.style.border = "1px solid black";
							td21.style.width = "100px";
							td21.setAttribute("bgcolor", "lightBlue");
							td21.setAttribute("align", "center");
							/*p21.style.textDecoration = "underline";
							p21.style.cursor = "pointer";
							p21.addEventListener("click", (e) => {
								showHistorySheet(e.target.innerText);
							});*/
							var td22 = document.createElement("td");
							var text22 = document.createTextNode(itemDescription);
							td22.appendChild(text22);
							td22.style.border = "1px solid black";
							td22.style.width = "400px";
							td22.style.textAlign = "left";
							td22.setAttribute("bgcolor", "lightBlue");
							td22.setAttribute("colspan", "4");
							var td23 = document.createElement("td");
							var text23 = document.createTextNode(itemNature);
							td23.appendChild(text23);
							td23.style.border = "1px solid black";
							td23.style.width = "100px";
							td23.setAttribute("bgcolor", "lightBlue");
							td23.setAttribute("align", "center");
							var td24 = document.createElement("td");
							var text24 = document.createTextNode(itemCategory);
							td24.appendChild(text24);
							td24.style.border = "1px solid black";
							td24.style.width = "100px";
							td24.setAttribute("bgcolor", "lightBlue");
							td24.setAttribute("align", "center");
							var td25 = document.createElement("td");
							var text25 = document.createTextNode("");
							td25.appendChild(text25);
							td25.style.border = "1px solid black";
							td25.style.width = "100px";
							td25.setAttribute("bgcolor", "lightBlue");
							td25.setAttribute("align", "center");
							var td26 = document.createElement("td");
							var text26 = document.createTextNode(dealerName);
							td26.appendChild(text26);
							td26.style.border = "1px solid black";
							td26.style.width = "100px";
							td26.setAttribute("bgcolor", "lightBlue");
							td26.setAttribute("align", "center");
							tr2.appendChild(td20);
							tr2.appendChild(td21);
							tr2.appendChild(td22);
							tr2.appendChild(td23);
							tr2.appendChild(td24);
							tr2.appendChild(td25);
							tr2.appendChild(td26);

							/*var tr3 = document.createElement("tr");
                                          var td31 = document.createElement("td");
                                          td31.style.border = "1px solid black";
                                          var td32 = document.createElement("td");
                                          td32.style.border = "1px solid black";
                                          var td33 = document.createElement("td");
                                          var text33 = document.createTextNode(purchaseSection);
                                          td33.appendChild(text33);
                                          td33.style.border = "1px solid black";
                                          var td34 = document.createElement("td");
                                          var text34 = document.createTextNode(cp);
                                          td34.style.border = "1px solid black";
                                          td34.appendChild(text34);
                                          tr3.appendChild(td31);
                                          tr3.appendChild(td32);
                                          tr3.appendChild(td33);
                                          tr3.appendChild(td34);*/

							tbody1.appendChild(tr1);
							tbody1.appendChild(tr2);
							table1.appendChild(tbody1);
							table1.style.borderCollapse = "collapse";
							td0.appendChild(table1);
							row5.previousElementSibling.appendChild(td0);

							uncoveredDuesTable.style.display = "none";
							row5.children[0].setAttribute("width", "100%");
							row5.previousElementSibling.querySelectorAll("td")[0].remove();
						}

						if (q == table6Rows.length - 1) {
							var th1 = document.createElement("th");
							var thText1 = document.createTextNode(cummulativeConsumptionCY);
							th1.appendChild(thText1);
							row6.appendChild(th1);
							var th2 = document.createElement("th");
							var thText2 = document.createTextNode(cummulativeConsumptionLY);
							th2.appendChild(thText2);
							row6.appendChild(th2);
							var th3 = document.createElement("th");
							var thText3 = document.createTextNode(Math.round(cummulativeCoverage));
							th3.appendChild(thText3);
							row6.appendChild(th3);
						}
					}
				}
			}
		}

		if (document.title == "Manage List Groups for Reports" || document.title == "Run Form - IMMIS/LISTGROUPS") {
			body.classList.add("manage_list");

			var plInput = document.querySelectorAll("#s_2")[0].querySelectorAll("#s_0_44")[0];
			var plSubmit = document.querySelectorAll("#s_2")[0].querySelectorAll("#s_0_53")[0];
			plInput.addEventListener("keydown", (e) => {
				if (e.key === "Tab" || e.key === "Enter") {
					document.querySelectorAll("#s_2")[0].querySelectorAll("#s_0_53")[0].focus();
				}
			});
			plSubmit.addEventListener("click", (e) => {
				plInput.focus();
			});

			var summaryButton = document.createElement("input");
			summaryButton.id = "summaryButton";
			summaryButton.classList.add("button");
			summaryButton.classList.add("btnSunflower");
			summaryButton.value = "Summary";
			document.querySelectorAll("#s_2")[0].querySelectorAll("input[name='BTN_Prt_0']")[0].parentElement.insertBefore(summaryButton, document.querySelectorAll("#s_2")[0].querySelectorAll("input[name='BTN_Prt_0']")[0]);

			summaryButton.addEventListener("click", (e) => {
				var positionDiv = document.querySelectorAll("#s_2")[0].querySelectorAll(":scope > table")[2].querySelectorAll("tr")[1].querySelectorAll("div")[0].querySelectorAll(":scope > table");
				console.log(positionDiv);

				for (var i = 0; i < positionDiv.length; i++) {
					if (positionDiv[i].querySelectorAll("td")[0].innerText.trim() == "Sr." && positionDiv[i].querySelectorAll("td")[1].innerText.trim() == "PL. No.") {
						var headerTable, consumptionTable, UDMTable, uncoveredDuesTable, coveredDuesTable, indentTable, remarksTable;

						for (var j = 0; j < Math.min(10, positionDiv.length - i); j++) {
							if (positionDiv[i + j].querySelectorAll("td")[0] != undefined && positionDiv[i + j].querySelectorAll("td")[0].innerText.trim() == "Sr." && positionDiv[i + j].querySelectorAll("td")[1].innerText.trim() == "PL. No.") {
								headerTable = positionDiv[i + j];
							}
							if (positionDiv[i + j].querySelectorAll("td")[0] != undefined && positionDiv[i + j].querySelectorAll("td")[0].innerText.trim() == "STOCK, AAC AND CONSUMPTION DETAILS") {
								consumptionTable = positionDiv[i + j];
							}
							if (positionDiv[i + j].querySelectorAll("th")[0] != undefined && positionDiv[i + j].querySelectorAll("th")[0].innerText.trim() == "Available Stock of selected item in Digital Ledgers maintained by Users / Consignees of IREPS in UDM") {
								UDMTable = positionDiv[i + j];
							}
							if (positionDiv[i + j].querySelectorAll("td")[0] != undefined && positionDiv[i + j].querySelectorAll("td")[0].innerText.trim() == "UN-COVERED DUES DETAILS") {
								uncoveredDuesTable = positionDiv[i + j];
							}
							if (positionDiv[i + j].querySelectorAll("td")[0] != undefined && positionDiv[i + j].querySelectorAll("td")[0].innerText.trim() == "INDENT DETAILS") {
								indentTable = positionDiv[i + j];
							}
							if (positionDiv[i + j].querySelectorAll("td")[0] != undefined && positionDiv[i + j].querySelectorAll("td")[0].innerText.trim() == "COVERED DUES DETAILS") {
								coveredDuesTable = positionDiv[i + j];
							}
							if (positionDiv[i + j].querySelectorAll("td")[0] != undefined && positionDiv[i + j].querySelectorAll("td")[0].innerText.trim() == "Remarks:") {
								remarksTable = positionDiv[i + j];
							}
							if (positionDiv[i + j].nextElementSibling != undefined && positionDiv[i + j].nextElementSibling.tagName == "BR") {
								break;
							}
						}

						var consumptionRows = consumptionTable.querySelectorAll("tbody")[0];

						//set headings
						consumptionRows.children[1].children[7].innerText = "DUES";
						consumptionRows.children[1].children[8].innerText = "COVERAGE";
						consumptionRows.children[1].children[9].innerText = "Remarks of HQ";
						consumptionRows.children[2].children[0].innerText = "CONS " + consumptionRows.children[2].children[0].innerText;
						consumptionRows.children[2].children[1].innerText = "CONS " + consumptionRows.children[2].children[1].innerText;
						consumptionRows.children[2].children[2].innerText = "CONS " + consumptionRows.children[2].children[2].innerText;
						consumptionRows.children[2].children[3].innerText = "CONS " + consumptionRows.children[2].children[3].innerText;

						//check for closed depots
						for (var j = 3; j < consumptionRows.children.length - 1; j++) {
							if (consumptionRows.children[j].children[2].innerText.search("Closed") != -1) {
								consumptionRows.querySelectorAll("tr")[j].remove();
							}
						}

						//covered dues
						var coveredRows = coveredDuesTable.querySelectorAll("tbody")[0];

						//here covered dues shall be appended
						consumptionRows.children[3].children[12].innerText = "";
						consumptionRows.children[3].children[12].setAttribute("align", "left");
						var table = document.createElement("table");
						var tbody = document.createElement("tbody");
						consumptionRows.children[3].children[12].appendChild(table);

						var cummulativeCoveredDues = 0;

						for (var j = 2; j < coveredRows.children.length; j++) {
							var coveredRow = coveredRows.children[j];

							if (coveredRow.children.length == 1 && coveredRow.children[0].innerText.trim() != "NO COVERED DUES FOR THIS ITEM") {
								var dispatchRows = coveredRow.children[0].querySelectorAll("tbody")[0];

								for (var k = 2; k < dispatchRows.children.length; k++) {
									var dispatchRow = dispatchRows.children[k];
									var inspectionCallDate = dispatchRow.children[2].innerText.split("Dt.")[1];
									var inspectionCallQty = dispatchRow.children[3].innerText;
									var inspectionCertificateDate = dispatchRow.children[6].innerText.split("Dt.")[1];
									var inspectionCertificateQty = dispatchRow.children[7].innerText;
									var dispatchDate;
									var dispatchQty;

									var tr = document.createElement("tr");
									var td = document.createElement("td");
									var tdText;

									if (dispatchRow.children[9].innerText != "") {
										dispatchDate = dispatchRow.children[9].innerText.split("Dt.")[1].substring(0, 9);
										dispatchQty = dispatchRow.children[9].innerText.split("(")[1].split(")")[0];
										tdText = document.createTextNode("Material dispatched, Qty: " + dispatchQty + ", Date: " + dispatchDate);
									} else if (inspectionCertificateQty != "" && inspectionCertificateQty != "--") {
										tdText = document.createTextNode("Inspection complete, Qty: " + inspectionCertificateQty + ", Date: " + inspectionCertificateDate);
									} else if (inspectionCallQty != "" && inspectionCallQty != "--") {
										tdText = document.createTextNode("Inspection call placed, Qty: " + inspectionCallQty + ", Date: " + inspectionCallDate);
									} else {
										continue;
									}

									td.appendChild(tdText);
									var br = document.createElement("br");
									td.appendChild(br);
									td.style.fontWeight = "bold";
									tr.appendChild(td);
									consumptionRows.children[3].children[12].querySelectorAll("table")[0].appendChild(tr);
								}

								continue;
							}

							if (coveredRow.children.length == 10 && ["1", "2", "7"].includes(coveredRow.querySelectorAll("td")[0].innerText.trim().substring(15, 16))) {
								var anchors = coveredRow.querySelectorAll("td")[0].querySelectorAll("a");
								for (var k = 1; k < anchors.length; k++) {
									anchors[k].remove();
								}
								coveredRow.querySelectorAll("td")[0].querySelectorAll("span")[0].remove();
								coveredRow.querySelectorAll("td")[0].removeAttribute("rowspan");

								var tr = document.createElement("tr");
								var br = document.createElement("br");
								coveredRow.querySelectorAll("td")[0].appendChild(br);
								var td = coveredRow.querySelectorAll("td")[0];
								td.innerHTML = td.innerHTML.split(" PO-CAT:")[0] + td.innerHTML.split(" ]  ")[1];
								tr.appendChild(td.cloneNode(true));
								consumptionRows.children[3].children[12].querySelectorAll("table")[0].appendChild(tr);

								var depot = coveredRow.children[2].innerText;
								var qty = coveredRow.children[7].innerText;
								var dp = coveredRow.children[9].innerText;

								coveredRow.children[2].innerText = coveredRow.children[2].innerText + ": " + coveredRow.children[7].innerText + "; DP: " + coveredRow.children[9].innerText;
								coveredRow.children[2].setAttribute("align", "left");

								if (+qty > 0) {
									var tr = document.createElement("tr");
									var br = document.createElement("br");
									coveredRow.children[2].appendChild(br);
									tr.appendChild(coveredRow.children[2].cloneNode(true));
									consumptionRows.children[3].children[12].querySelectorAll("table")[0].appendChild(tr);

									for (var m = 3; m < consumptionRows.children.length; m++) {
										if (consumptionRows.children[m].children[1].innerText == depot) {
											consumptionRows.children[m].children[11].innerText = +consumptionRows.children[m].children[11].innerText + +qty;
										}
									}

									cummulativeCoveredDues = +cummulativeCoveredDues + +qty;
								}

								for (var k = 1; k < coveredRows.children.length - j; k++) {
									var coveredRow1 = coveredRows.children[j + k];

									if (coveredRow1.children.length == 10) {
										break;
									}
									if (coveredRow1.children.length == 1) {
										continue;
									}

									var depot = coveredRow1.children[1].innerText;
									var qty = coveredRow1.children[6].innerText;
									var dp = coveredRow1.children[8].innerText;

									coveredRow1.children[1].innerText = coveredRow1.children[1].innerText + ": " + coveredRow1.children[6].innerText + "; DP: " + coveredRow1.children[8].innerText;
									coveredRow1.children[1].setAttribute("align", "left");

									if (+qty > 0) {
										var tr = document.createElement("tr");
										var br = document.createElement("br");
										coveredRow1.children[1].appendChild(br);
										tr.appendChild(coveredRow1.children[1].cloneNode(true));
										consumptionRows.children[3].children[12].querySelectorAll("table")[0].appendChild(tr);

										for (var m = 3; m < consumptionRows.children.length; m++) {
											if (consumptionRows.children[m].children[1].innerText == depot) {
												consumptionRows.children[m].children[11].innerText = +consumptionRows.children[m].children[11].innerText + +qty;
											}
										}

										cummulativeCoveredDues = +cummulativeCoveredDues + +qty;
									}
								}
							}
						}

						consumptionRows.querySelectorAll("#stockdata_total")[0].children[7].innerText = cummulativeCoveredDues;

						var uncoveredRows = uncoveredDuesTable.querySelectorAll("tbody")[0];

						if (uncoveredRows.children.length >= 3 && uncoveredRows.children[2].children.length > 1) {
							for (var j = 2; j < uncoveredRows.children.length; j++) {
								var uncoveredRow = uncoveredRows.children[j];

								var tenderDepot = uncoveredRow.children[1].innerText;
								var tenderText = uncoveredRow.children[7].innerText;
								var tod = uncoveredRow.children[8].innerText;
								var tenderStatus = uncoveredRow.children[9];
								var tenderNo;
								var tenderQty;
								var tenderLink;

								if (tenderText != "" && tenderText.search("T No.") != -1) {
									tenderNo = tenderText.substring(6, tenderText.indexOf(" ("));
									tenderQty = tenderText.split("(")[1].split(")")[0];

									if (uncoveredRow.children[7].querySelectorAll("a")[0] != undefined) {
										tenderLink = uncoveredRow.children[7].querySelectorAll("a")[0];
										uncoveredRow.children[7].innerHTML = "";
										uncoveredRow.children[7].setAttribute("align", "left");
										uncoveredRow.children[7].appendChild(tenderLink);

										var p = document.createElement("span");
										var pText = document.createTextNode(" due on " + tod);
										p.appendChild(pText);
										uncoveredRow.children[7].appendChild(p);
									} else {
										uncoveredRow.children[7].innerHTML = "";
										uncoveredRow.children[7].setAttribute("align", "left");

										var p = document.createElement("span");
										var pText = document.createTextNode("T No. " + tenderNo + " (draft)");
										p.appendChild(pText);
										uncoveredRow.children[7].appendChild(p);
									}

									var tr = document.createElement("tr");
									var br = document.createElement("br");
									uncoveredRow.children[7].appendChild(br);
									tr.appendChild(uncoveredRow.children[7].cloneNode(true));
									uncoveredRow.children[1].innerText = uncoveredRow.children[1].innerText + ": " + tenderQty;
									var tr2 = document.createElement("tr");
									var br = document.createElement("br");
									uncoveredRow.children[1].appendChild(br);
									tr2.appendChild(uncoveredRow.children[1].cloneNode(true));
									var tr3 = document.createElement("tr");
									var br = document.createElement("br");
									tenderStatus.appendChild(br);
									tr3.appendChild(tenderStatus.cloneNode(true));

									var isInserted = false;
									for (var k = 0; k < consumptionRows.children[3].children[12].querySelectorAll("table")[0].children.length - 1; k++) {
										var consumptionRow = consumptionRows.children[3].children[12].querySelectorAll("table")[0].children[k];

										if (consumptionRow.innerText.trim() == tr.innerText.trim()) {
											consumptionRows.children[3].children[12].querySelectorAll("table")[0].insertBefore(tr2, consumptionRows.children[3].children[12].querySelectorAll("table")[0].children[k + 2]);
											isInserted = true;
											break;
										}
									}
									if (!isInserted) {
										consumptionRows.children[3].children[12].querySelectorAll("table")[0].appendChild(tr);
										consumptionRows.children[3].children[12].querySelectorAll("table")[0].appendChild(tr3);
										consumptionRows.children[3].children[12].querySelectorAll("table")[0].appendChild(tr2);
									}
								}
							}
						}

						//formatting

						if (UDMTable != undefined) {
							UDMTable.remove();
						}
						if (uncoveredDuesTable != undefined) {
							uncoveredDuesTable.remove();
						}
						if (coveredDuesTable != undefined) {
							coveredDuesTable.remove();
						}
						if (indentTable != undefined) {
							indentTable.remove();
						}
						if (remarksTable != undefined && remarksTable != null) {
							if (remarksTable.nextElementSibling != undefined && remarksTable.nextElementSibling != null) {
								if (remarksTable.nextElementSibling.nextSibling != undefined && remarksTable.nextElementSibling.nextSibling != null) {
									remarksTable.nextElementSibling.nextSibling.remove();
								}
								remarksTable.nextElementSibling.remove();
							}
							remarksTable.remove();
						}

						headerTable.querySelectorAll("tr")[0].children[16].remove();
						headerTable.querySelectorAll("tr")[0].children[15].remove();
						headerTable.querySelectorAll("tr")[0].children[14].remove();
						headerTable.querySelectorAll("tr")[0].children[13].remove();
						headerTable.querySelectorAll("tr")[0].children[12].innerText = "Dealer";
						headerTable.querySelectorAll("tr")[0].children[12].setAttribute("colspan", "2");
						headerTable.querySelectorAll("tr")[0].children[11].innerText = "Raised By";
						headerTable.querySelectorAll("tr")[0].children[8].remove();
						headerTable.querySelectorAll("tr")[0].children[7].remove();
						headerTable.querySelectorAll("tr")[0].children[6].remove();
						headerTable.querySelectorAll("tr")[0].children[5].remove();
						headerTable.querySelectorAll("tr")[0].children[4].remove();
						headerTable.querySelectorAll("tr")[0].children[3].remove();
						headerTable.querySelectorAll("tr")[0].children[2].innerText = "Description";
						headerTable.querySelectorAll("tr")[0].children[2].setAttribute("colspan", "4");

						headerTable.querySelectorAll("tr")[1].children[16].remove();
						headerTable.querySelectorAll("tr")[1].children[15].remove();
						headerTable.querySelectorAll("tr")[1].children[14].remove();
						headerTable.querySelectorAll("tr")[1].children[13].remove();
						headerTable.querySelectorAll("tr")[1].children[12].innerText = "";
						headerTable.querySelectorAll("tr")[1].children[12].setAttribute("colspan", "2");
						headerTable.querySelectorAll("tr")[1].children[11].innerText = "";
						headerTable.querySelectorAll("tr")[1].children[8].remove();
						headerTable.querySelectorAll("tr")[1].children[7].remove();
						headerTable.querySelectorAll("tr")[1].children[6].remove();
						headerTable.querySelectorAll("tr")[1].children[5].remove();
						headerTable.querySelectorAll("tr")[1].children[4].remove();
						headerTable.querySelectorAll("tr")[1].children[3].remove();
						headerTable.querySelectorAll("tr")[1].children[2].innerText = headerTable.querySelectorAll("tr")[2].innerText.split(" ").slice(0, 5).join(" ");
						headerTable.querySelectorAll("tr")[1].children[2].setAttribute("colspan", "4");

						if (headerTable.querySelectorAll("tr")[3] != undefined) {
							headerTable.querySelectorAll("tr")[3].remove();
						}
						headerTable.querySelectorAll("tr")[2].remove();

						consumptionTable.querySelectorAll("tr")[0].remove();

						consumptionTable.querySelectorAll("tr")[0].children[9].removeAttribute("rowspan");
						consumptionTable.querySelectorAll("tr")[0].appendChild(consumptionTable.querySelectorAll("tr")[0].children[9].cloneNode(true));
						consumptionTable.querySelectorAll("tr")[0].children[10].innerText = "Remarks by Depot";
						consumptionTable.querySelectorAll("tr")[0].children[8].removeAttribute("rowspan");
						consumptionTable.querySelectorAll("tr")[0].children[8].setAttribute("colspan", "3");
						consumptionTable.querySelectorAll("tr")[0].children[7].removeAttribute("rowspan");
						consumptionTable.querySelectorAll("tr")[0].children[6].removeAttribute("rowspan");
						consumptionTable.querySelectorAll("tr")[0].children[5].removeAttribute("rowspan");
						consumptionTable.querySelectorAll("tr")[0].children[6].innerText = "STOCK";
						consumptionTable.querySelectorAll("tr")[0].children[5].innerText = "AAC";
						consumptionTable.querySelectorAll("tr")[0].insertBefore(consumptionTable.querySelectorAll("tr")[0].children[5], consumptionTable.querySelectorAll("tr")[0].children[2]);
						consumptionTable.querySelectorAll("tr")[0].insertBefore(consumptionTable.querySelectorAll("tr")[1].children[3], consumptionTable.querySelectorAll("tr")[0].children[4]);
						consumptionTable.querySelectorAll("tr")[0].insertBefore(consumptionTable.querySelectorAll("tr")[1].children[2], consumptionTable.querySelectorAll("tr")[0].children[4]);
						consumptionTable.querySelectorAll("tr")[0].insertBefore(consumptionTable.querySelectorAll("tr")[1].children[1], consumptionTable.querySelectorAll("tr")[0].children[4]);
						consumptionTable.querySelectorAll("tr")[0].insertBefore(consumptionTable.querySelectorAll("tr")[1].children[0], consumptionTable.querySelectorAll("tr")[0].children[4]);
						consumptionTable.querySelectorAll("tr")[0].children[9].remove();
						consumptionTable.querySelectorAll("tr")[0].children[8].remove();
						consumptionTable.querySelectorAll("tr")[0].children[5].remove();
						consumptionTable.querySelectorAll("tr")[0].children[4].remove();
						consumptionTable.querySelectorAll("tr")[0].children[3].removeAttribute("rowspan");
						consumptionTable.querySelectorAll("tr")[0].children[3].remove();
						consumptionTable.querySelectorAll("tr")[0].children[1].removeAttribute("rowspan");
						consumptionTable.querySelectorAll("tr")[0].children[1].remove();
						consumptionTable.querySelectorAll("tr")[0].children[0].removeAttribute("rowspan");
						consumptionTable.querySelectorAll("tr")[0].children[0].removeAttribute("colspan");

						consumptionTable.querySelectorAll("tr")[1].remove();

						var numCoverageRows = consumptionRows.children[1].children[12].querySelectorAll("table")[0].children.length;
						for (var j = 0; j < consumptionRows.children[1].children[12].querySelectorAll("table")[0].children.length; j++) {
							consumptionRows.children[1].children[12].querySelectorAll("table")[0].children[j].setAttribute("colspan", "3");
							consumptionRows.children[1].children[12].querySelectorAll("table")[0].children[j].children[0].setAttribute("colspan", "3");
						}

						var consumptionRows = consumptionTable.querySelectorAll("tbody")[0].querySelectorAll(":scope > tr");
						var rowSpan = Math.floor(numCoverageRows / (consumptionRows.length - 2));

						for (var j = 1; j < consumptionRows.length - 1; j++) {
							var consumptionRow = consumptionRows[j];
							consumptionRow.children[13].innerText = "";
							consumptionRow.appendChild(consumptionRow.children[13].cloneNode(true));
							consumptionRow.children[14].setAttribute("rowspan", consumptionRows.length - 2);
							consumptionRow.children[13].setAttribute("rowspan", consumptionRows.length - 2);
							consumptionRow.children[12].removeAttribute("nowrap");
							consumptionRow.children[12].setAttribute("colspan", "3");
							consumptionRow.children[12].setAttribute("rowspan", consumptionRows.length - 2);
							consumptionRow.children[9].innerHTML = consumptionRow.children[9].innerHTML.split("<br>")[0];
							consumptionRow.children[10].innerText = consumptionRow.children[10].innerHTML.split("<br>")[0];
							consumptionRow.insertBefore(consumptionRow.children[9], consumptionRow.children[2]);

							if (j > 1) {
								consumptionRow.children[14].remove();
								consumptionRow.children[13].remove();
								consumptionRow.children[12].remove();
								consumptionRow.children[11].removeAttribute("rowspan");
								consumptionRow.children[10].removeAttribute("rowspan");
								consumptionRow.children[9].removeAttribute("rowspan");
								consumptionRow.children[8].removeAttribute("rowspan");
								consumptionRow.children[7].removeAttribute("rowspan");
								consumptionRow.children[1].removeAttribute("rowspan");
							}
							if (j == 1) {
								/*
                                consumptionRow.children[11].setAttribute("rowspan", numCoverageRows - consumptionRows.length + 3);
                                consumptionRow.children[10].setAttribute("rowspan", numCoverageRows - consumptionRows.length + 3);
                                consumptionRow.children[9].setAttribute("rowspan", numCoverageRows - consumptionRows.length + 3);
                                consumptionRow.children[8].setAttribute("rowspan", numCoverageRows - consumptionRows.length + 3);
                                consumptionRow.children[7].setAttribute("rowspan", numCoverageRows - consumptionRows.length + 3);
                                consumptionRow.children[1].setAttribute("rowspan", numCoverageRows - consumptionRows.length + 3);
                                */
							}
							consumptionRow.children[7].remove();
							consumptionRow.children[6].remove();
							consumptionRow.children[5].remove();
							consumptionRow.children[4].remove();
							consumptionRow.children[3].remove();
							consumptionRow.children[0].remove();
						}

						consumptionRows[consumptionRows.length - 1].children[8].setAttribute("colspan", "5");
						consumptionRows[consumptionRows.length - 1].children[5].innerText = consumptionRows[consumptionRows.length - 1].children[5].innerText.split("(")[0];
						consumptionRows[consumptionRows.length - 1].insertBefore(consumptionRows[consumptionRows.length - 1].children[5], consumptionRows[consumptionRows.length - 1].children[3]);
						consumptionRows[consumptionRows.length - 1].children[2].remove();
						consumptionRows[consumptionRows.length - 1].children[1].remove();
						consumptionRows[consumptionRows.length - 1].children[0].removeAttribute("colspan");
						consumptionRows[consumptionRows.length - 1].children[0].innerText = "TOTAL";

						for (var j = 0; j < consumptionRows.length; j++) {
							var consumptionRow = consumptionRows[j];
							headerTable.querySelectorAll("tbody")[0].appendChild(consumptionRow);
						}

						headerTable.querySelectorAll("tr").forEach((tr) => {
							tr.removeAttribute("bgcolor");
						});
						headerTable.querySelectorAll("td").forEach((td) => {
							td.removeAttribute("bgcolor");
							td.removeAttribute("align");
							td.style.verticalAlign = "middle";
							td.style.width = "100px";
							td.style.maxWidth = "100px";
						});
						headerTable.querySelectorAll("td[colspan='2']").forEach((td) => {
							td.style.width = "200px";
							td.style.maxWidth = "200px";
						});
						headerTable.querySelectorAll("td[colspan='3']").forEach((td) => {
							td.style.width = "300px";
							td.style.maxWidth = "300px";
						});
						headerTable.querySelectorAll("td[colspan='4']").forEach((td) => {
							td.style.width = "400px";
							td.style.maxWidth = "400px";
						});
						headerTable.style.font = "10pt Arial";
						headerTable.querySelectorAll("table")[0].style.font = "10pt Arial";
						headerTable.querySelectorAll("a").forEach((a) => {
							a.style.font = "10pt Arial";
						});
						headerTable.querySelectorAll("tr")[0].style.fontWeight = "bold";
						headerTable.querySelectorAll("tr")[0].style.backgroundColor = "#add8e6";
						headerTable.querySelectorAll("tr")[2].style.fontWeight = "bold";
						headerTable.querySelectorAll("tr")[2].style.backgroundColor = "#add8e6";

						consumptionTable.querySelectorAll("tbody")[0].appendChild(document.createElement("td"));
					}
				}
			});
		}

		if (document.title == "Quantity Review Sheet" || document.title == "Run Form - IMMIS/PUR/QTYREVIEW") {
			body.classList.add("quantity_review");

			let getData = () => {
				var divShowHtml1 = document.querySelectorAll("#divShowHtml1")[0];
				var date = divShowHtml1.children[1].querySelectorAll(":scope > table")[0].querySelectorAll("tr")[0].querySelectorAll("th")[1].innerText.substring(7, 15);
				var plNo = divShowHtml1.children[1].querySelectorAll(":scope > table")[0].querySelectorAll("tr")[1].querySelectorAll("td")[0].querySelectorAll("b")[0].innerText.substring(7);
				var itemDescription = divShowHtml1.children[1].querySelectorAll(":scope > table")[0].querySelectorAll("tr")[1].querySelectorAll("td")[1].innerText;
				var descriptionText = divShowHtml1.children[1].querySelectorAll(":scope > table")[0].querySelectorAll("tr")[2].querySelectorAll("td")[0].innerText;
				var unit = descriptionText.substring(descriptionText.indexOf("BU:") + 4, descriptionText.indexOf("Pur.Sec:") - 1);
				var category = descriptionText.substring(descriptionText.indexOf("ABC-Cat:") + 9, descriptionText.indexOf("V/S :"));
				var nature = descriptionText.substring(descriptionText.indexOf("V/S :") + 5);

				var consumptionTable = divShowHtml1.children[1].querySelectorAll(":scope > table")[1];
				var consumptionRows = consumptionTable.querySelectorAll("tbody")[0].children;
				var depotArray = [];
				var stockArray = [];
				var barArray = [];
				var consumptionArray = [];
				var consumptionYearsArray = [];
				var aacArray = [];
				var mcArray = [];
				var ipRequirementsArray = [];
				var cpRequirementsArray = [];
				var bpRequirementsArray = [];
				var netRequirementsArray = [];

				for (var i = 2; i < Math.max(consumptionRows.length - 1, 3); i++) {
					var row1 = consumptionRows[i];
					depotArray.push(row1.querySelectorAll("td")[0].innerText);
					stockArray.push(+row1.querySelectorAll("td")[4].innerText);
					barArray.push(+row1.querySelectorAll("td")[2].innerText);
					var array1 = [];
					array1.push(+row1.querySelectorAll("td")[7].innerText);
					array1.push(+row1.querySelectorAll("td")[8].innerText);
					array1.push(+row1.querySelectorAll("td")[9].innerText);
					array1.push(+row1.querySelectorAll("td")[10].innerText);
					consumptionArray.push(array1);
					aacArray.push(+row1.querySelectorAll("td")[13].innerText);
					mcArray.push(+row1.querySelectorAll("td")[13].innerText / 12);
				}

				consumptionYearsArray.push(consumptionTable.querySelectorAll("tr")[1].children[0].innerText);
				consumptionYearsArray.push(consumptionTable.querySelectorAll("tr")[1].children[1].innerText);
				consumptionYearsArray.push(consumptionTable.querySelectorAll("tr")[1].children[2].innerText);
				consumptionYearsArray.push(consumptionTable.querySelectorAll("tr")[1].children[3].innerText);

				var udmStockBalance = divShowHtml1.children[1].querySelectorAll(":scope > table")[2].querySelectorAll("td")[0].innerText;
				var coveredDuesTable = divShowHtml1.children[1].querySelectorAll(":scope > table")[3].querySelectorAll("tr")[0].children[0].querySelectorAll("table")[0];
				var coveredRows = coveredDuesTable.querySelectorAll("tbody")[0].children;
				var coveredDuesArray = [];
				var array2 = [];

				if (coveredRows.length > 1) {
					for (var i = 1; i < coveredRows.length; i++) {
						var row2 = coveredRows[i];

						if (row2.children[0].innerHTML.search("<br>")) {
							var coveredDepotArray = row2.children[0].innerHTML.split("<br>");
							var coveredPOQtyArray = row2.children[1].innerHTML.split("<br>");
							var coveredDueQtyArray = row2.children[2].innerHTML.split("<br>");
							var coveredDPArray = row2.children[4].innerHTML.split("<br>");
							var coveredPO = row2.children[5].innerText ? row2.children[5].innerText.split("Receipt under Accountal")[0] : "";

							for (var j = 0; j < coveredDepotArray.length; j++) {
								array2 = [];
								array2.push(coveredDepotArray[j]);
								array2.push(+coveredPOQtyArray[j]);
								array2.push(+coveredDueQtyArray[j]);
								array2.push(coveredDPArray[j]);
								array2.push(coveredPO);
								coveredDuesArray.push(array2);
							}
						} else {
							var coveredDepot = row2.children[0].innerText;
							var coveredPOQty = +row2.children[1].innerText;
							var coveredDueQty = +row2.children[2].innerText;
							var coveredDP = row2.children[4].innerText;
							var coveredPO = row2.children[5].innerText ? row2.children[5].innerText.split("Receipt under Accountal")[0] : "";

							array2 = [];
							array2.push(coveredDepot);
							array2.push(+coveredPOQty);
							array2.push(+coveredDueQty);
							array2.push(coveredDP);
							array2.push(coveredPO);
							coveredDuesArray.push(array2);
						}
					}
				}

				var uncoveredDuesTable = divShowHtml1.children[1].querySelectorAll(":scope > table")[3].querySelectorAll("tr")[0].children[1].querySelectorAll("table")[0];
				var uncoveredRows = uncoveredDuesTable.querySelectorAll("tbody")[0].children;
				var uncoveredDuesArray = [];

				if (uncoveredRows.length > 1) {
					for (var i = 1; i < uncoveredRows.length; i++) {
						var row3 = uncoveredRows[i];

						var uncoveredDepot = row3.children[0].innerText;
						var uncoveredQty = +row3.children[1].innerText;
						var uncoveredDemandNo = row3.children[2].innerText;
						var uncoveredDemandDate = row3.children[3].innerText;
						var uncoveredTenderDetails;
						if (row3.children[4]) {
							uncoveredTenderDetails = row3.children[4].innerText;
						} else {
							uncoveredTenderDetails = "";
						}

						var array3 = [];
						array3.push(uncoveredDepot);
						array3.push(+uncoveredQty);
						array3.push(uncoveredDemandNo);
						array3.push(uncoveredDemandDate);
						array3.push(uncoveredTenderDetails);
						uncoveredDuesArray.push(array3);
					}
				}

				var cpText = divShowHtml1.children[1].children[9].nextSibling.textContent;
				var cpFrom = cpText.substring(4, 12);
				var cpTo = cpText.substring(16, 24);
				var cpMM = parseInt(cpText.substring(27, 29));
				var ipFrom = cpText.substring(44, 52);
				var ipTo = cpText.substring(56, 64);
				var ipMM = parseInt(cpText.substring(67, 69));
				var bpText = divShowHtml1.children[1].children[10].nextSibling.textContent;
				var bpMM = parseInt(bpText.substring(8, 10).trim());

				var data = new Object();
				data.date = date;
				data.plNo = plNo;
				data.itemDescription = itemDescription;
				data.descriptionText = descriptionText;
				data.unit = unit;
				data.category = category;
				data.nature = nature;

				data.depotArray = depotArray;
				data.stockArray = stockArray;
				data.barArray = barArray;
				data.consumptionArray = consumptionArray;
				data.consumptionYearsArray = consumptionYearsArray;
				data.aacArray = aacArray;
				data.mcArray = mcArray;
				data.udmStockBalance = udmStockBalance;
				data.coveredDuesArray = coveredDuesArray;
				data.uncoveredDuesArray = uncoveredDuesArray;

				data.cpFrom = cpFrom;
				data.cpTo = cpTo;
				data.cpMM = cpMM;
				data.ipFrom = ipFrom;
				data.ipTo = ipTo;
				data.ipMM = ipMM;
				data.bpMM = bpMM;

				return data;
			};

			let confirmData = () => {
				var data = getData();

				var date = data.date;
				var plNo = data.plNo;
				var itemDescription = data.itemDescription;
				var descriptionText = data.descriptionText;
				var unit = data.unit;
				var category = data.category;
				var nature = data.nature;

				var depotArray = data.depotArray;
				var stockArray = data.stockArray;
				var barArray = data.barArray;
				var consumptionArray = data.consumptionArray;
				var consumptionYearsArray = data.consumptionYearsArray;
				var aacArray = data.aacArray;
				var mcArray = data.mcArray;
				var udmStockBalance = data.udmStockBalance;
				var coveredDuesArray = data.coveredDuesArray;
				var uncoveredDuesArray = data.uncoveredDuesArray;

				var cpFrom = data.cpFrom;
				var cpTo = data.cpTo;
				var cpMM = data.cpMM;
				var ipFrom = data.ipFrom;
				var ipTo = data.ipTo;
				var ipMM = data.ipMM;
				var bpMM = data.bpMM;

				var revisedAacArray = [];
				var revisedMcArray = [];
				var revisedUncoveredDuesArray = [];
				var revisedBP = 0;

				var divShowHtml1 = document.querySelectorAll("#divShowHtml1")[0];

				if (divShowHtml1.querySelectorAll(".data_review")[0]) {
					divShowHtml1.querySelectorAll(".data_review")[0].remove();
				}

				if (divShowHtml1.querySelectorAll(".qty_review_div")[0]) {
					divShowHtml1.querySelectorAll(".qty_review_div")[0].remove();
				}

				var div = document.createElement("div");
				div.classList.add("data_review");

				var table1 = document.createElement("table");
				var tbody1 = document.createElement("tbody");
				var tr1 = document.createElement("tr");
				var td11 = document.createElement("td");
				var text11 = document.createTextNode("Review AAC");
				td11.appendChild(text11);
				td11.setAttribute("colspan", "8");
				tr1.appendChild(td11);
				tr1.setAttribute("bgcolor", "lightGrey");
				var tr2 = document.createElement("tr");
				var td21 = document.createElement("td");
				var text21 = document.createTextNode("Depot");
				td21.appendChild(text21);
				var td22 = document.createElement("td");
				var text22 = document.createTextNode("Cons " + consumptionYearsArray[0]);
				td22.appendChild(text22);
				var td23 = document.createElement("td");
				var text23 = document.createTextNode("Cons " + consumptionYearsArray[1]);
				td23.appendChild(text23);
				var td24 = document.createElement("td");
				var text24 = document.createTextNode("Cons " + consumptionYearsArray[2]);
				td24.appendChild(text24);
				var td25 = document.createElement("td");
				var text25 = document.createTextNode("Cons " + consumptionYearsArray[3]);
				td25.appendChild(text25);
				var td26 = document.createElement("td");
				var text26 = document.createTextNode("Cons (Max)");
				td26.appendChild(text26);
				var td27 = document.createElement("td");
				var text27 = document.createTextNode("AAC");
				td27.appendChild(text27);
				var td28 = document.createElement("td");
				var text28 = document.createTextNode("Revised AAC");
				td28.appendChild(text28);
				tr2.appendChild(td21);
				tr2.appendChild(td22);
				tr2.appendChild(td23);
				tr2.appendChild(td24);
				tr2.appendChild(td25);
				tr2.appendChild(td26);
				tr2.appendChild(td27);
				tr2.appendChild(td28);
				tbody1.appendChild(tr1);
				tbody1.appendChild(tr2);

				var totalInputAAC = 0;

				for (var i = 0; i < depotArray.length; i++) {
					var trP = document.createElement("tr");
					var tdP1 = document.createElement("td");
					var textP1 = document.createTextNode(depotArray[i]);
					tdP1.appendChild(textP1);
					var tdP2 = document.createElement("td");
					var textP2 = document.createTextNode(consumptionArray[i][0]);
					tdP2.appendChild(textP2);
					var tdP3 = document.createElement("td");
					var textP3 = document.createTextNode(consumptionArray[i][1]);
					tdP3.appendChild(textP3);
					var tdP4 = document.createElement("td");
					var textP4 = document.createTextNode(consumptionArray[i][2]);
					tdP4.appendChild(textP4);
					var tdP5 = document.createElement("td");
					var textP5 = document.createTextNode(consumptionArray[i][3]);
					tdP5.appendChild(textP5);
					var date1 = new Date("20" + date.split("/")[2], +date.split("/")[1] - 1, +date.split("/")[0]);
					var date2 = new Date("20" + consumptionYearsArray[3].split("-")[0], 3, 1);
					var numDays = (date1 - date2) / (1000 * 60 * 60 * 24);
					var maxConsumption = Math.max(+consumptionArray[i][0], +consumptionArray[i][1], +consumptionArray[i][2], Math.round((+consumptionArray[i][3] * 365) / numDays));
					var tdP6 = document.createElement("td");
					var textP6 = document.createTextNode(maxConsumption);
					tdP6.appendChild(textP6);
					var tdP7 = document.createElement("td");
					var textP7 = document.createTextNode(aacArray[i]);
					tdP7.appendChild(textP7);

					var escalationLimit = 1;

					if (category.substring(0, 1) == "A") {
						escalationLimit = 1.5;
					} else if (category.substring(0, 1) == "B") {
						escalationLimit = 1.5;
					} else {
						escalationLimit = 2.0;
					}

					var tdP8 = document.createElement("td");
					var inputP8 = document.createElement("input");
					inputP8.value = Math.min(+aacArray[i], Math.round(escalationLimit * maxConsumption));
					if (aacArray[i] > escalationLimit * maxConsumption) {
						inputP8.style.color = "red";
					}
					totalInputAAC += Math.min(+aacArray[i], Math.round(escalationLimit * maxConsumption));

                    inputP8.addEventListener("keyup", (e) => {
						var dataReviewDiv = document.querySelectorAll(".data_review")[0];
						var rows = dataReviewDiv.querySelectorAll("table")[0].querySelectorAll("tr");
						var inputs = dataReviewDiv.querySelectorAll("table")[0].querySelectorAll("input");
						var totalInputAAC = 0;
						var bar = barArray[0];

						for (var i = 0; i < inputs.length; i++) {
							var input = inputs[i];
							totalInputAAC += +inputs[i].value;
						}

						rows[rows.length - 2].querySelectorAll("td")[7].innerText = totalInputAAC;
						rows[rows.length - 1].querySelectorAll("td")[7].innerText = Math.round(+totalInputAAC * +bar);
					});

					tdP8.appendChild(inputP8);
					trP.appendChild(tdP1);
					trP.appendChild(tdP2);
					trP.appendChild(tdP3);
					trP.appendChild(tdP4);
					trP.appendChild(tdP5);
					trP.appendChild(tdP6);
					trP.appendChild(tdP7);
					trP.appendChild(tdP8);
					tbody1.appendChild(trP);
				}

				var trP = document.createElement("tr");
				var tdP1 = document.createElement("td");
				var textP1 = document.createTextNode("Total");
				tdP1.appendChild(textP1);
				var tdP2 = document.createElement("td");
				var tdP3 = document.createElement("td");
				var tdP4 = document.createElement("td");
				var tdP5 = document.createElement("td");
				var tdP6 = document.createElement("td");
				var tdP7 = document.createElement("td");
				var tdP8 = document.createElement("td");
				var textP8 = document.createTextNode(totalInputAAC);
				tdP8.appendChild(textP8);
				trP.appendChild(tdP1);
				trP.appendChild(tdP2);
				trP.appendChild(tdP3);
				trP.appendChild(tdP4);
				trP.appendChild(tdP5);
				trP.appendChild(tdP6);
				trP.appendChild(tdP7);
				trP.appendChild(tdP8);
				tbody1.appendChild(trP);

				var trP = document.createElement("tr");
				var tdP1 = document.createElement("td");
				var textP1 = document.createTextNode("Total AAC Value");
				tdP1.appendChild(textP1);
				var tdP2 = document.createElement("td");
				var tdP3 = document.createElement("td");
				var tdP4 = document.createElement("td");
				var tdP5 = document.createElement("td");
				var tdP6 = document.createElement("td");
				var tdP7 = document.createElement("td");
				var tdP8 = document.createElement("td");
				var textP8 = document.createTextNode(Math.round(totalInputAAC * barArray[0]));
				tdP8.appendChild(textP8);
				trP.appendChild(tdP1);
				trP.appendChild(tdP2);
				trP.appendChild(tdP3);
				trP.appendChild(tdP4);
				trP.appendChild(tdP5);
				trP.appendChild(tdP6);
				trP.appendChild(tdP7);
				trP.appendChild(tdP8);
				tbody1.appendChild(trP);

				table1.appendChild(tbody1);
				div.appendChild(table1);

				var table1 = document.createElement("table");
				var tbody1 = document.createElement("tbody");
				var tr1 = document.createElement("tr");
				var td11 = document.createElement("td");
				var text11 = document.createTextNode("Buffer Months");
				td11.appendChild(text11);
				var td12 = document.createElement("td");
				var input12 = document.createElement("input");
				input12.value = data.bpMM;
				td12.appendChild(input12);
				tr1.appendChild(td11);
				tr1.appendChild(td12);
				tbody1.appendChild(tr1);
				table1.appendChild(tbody1);
				div.appendChild(table1);

				var table1 = document.createElement("table");
				var tbody1 = document.createElement("tbody");
				var tr1 = document.createElement("tr");
				var td11 = document.createElement("td");
				var text11 = document.createTextNode("Review Uncovered Dues");
				td11.appendChild(text11);
				td11.setAttribute("colspan", "6");
				tr1.appendChild(td11);
				tr1.setAttribute("bgcolor", "lightGrey");
				var tr2 = document.createElement("tr");
				var td21 = document.createElement("td");
				var text21 = document.createTextNode("Depot");
				td21.appendChild(text21);
				var td22 = document.createElement("td");
				var text22 = document.createTextNode("Demand No");
				td22.appendChild(text22);
				var td23 = document.createElement("td");
				var text23 = document.createTextNode("Demand Date");
				td23.appendChild(text23);
				var td24 = document.createElement("td");
				var text24 = document.createTextNode("Qty");
				td24.appendChild(text24);
				var td25 = document.createElement("td");
				var text25 = document.createTextNode("Tender Details");
				td25.appendChild(text25);
				var td26 = document.createElement("td");
				var text26 = document.createTextNode("Action");
				td26.appendChild(text26);
				tr2.appendChild(td21);
				tr2.appendChild(td22);
				tr2.appendChild(td23);
				tr2.appendChild(td24);
				tr2.appendChild(td25);
				tr2.appendChild(td26);
				tbody1.appendChild(tr1);
				tbody1.appendChild(tr2);

				for (var i = 0; i < uncoveredDuesArray.length; i++) {
					var trQ = document.createElement("tr");
					var tdQ1 = document.createElement("td");
					var textQ1 = document.createTextNode(uncoveredDuesArray[i][0]);
					tdQ1.appendChild(textQ1);
					var tdQ2 = document.createElement("td");
					var textQ2 = document.createTextNode(uncoveredDuesArray[i][2]);
					tdQ2.appendChild(textQ2);
					var tdQ3 = document.createElement("td");
					var textQ3 = document.createTextNode(uncoveredDuesArray[i][3]);
					tdQ3.appendChild(textQ3);
					var tdQ4 = document.createElement("td");
					var inputQ4 = document.createElement("input");
					inputQ4.value = uncoveredDuesArray[i][1];
					tdQ4.appendChild(inputQ4);
					var tdQ5 = document.createElement("td");
					var textQ5 = document.createTextNode(uncoveredDuesArray[i][4]);
					tdQ5.appendChild(textQ5);
					var tdQ6 = document.createElement("td");
					var selectQ6 = document.createElement("select");
					selectQ6.classList.add("demand_consider");
					var optionQ61 = document.createElement("option");
					optionQ61.value = "Ignore";
					optionQ61.innerHTML = "Ignore";
					selectQ6.appendChild(optionQ61);
					var optionQ62 = document.createElement("option");
					optionQ62.value = "Consider";
					optionQ62.innerHTML = "Consider";
					if (uncoveredDuesArray[i][0].substring(0, 1) == uncoveredDuesArray[i][4].substring(0, 1)) {
						optionQ62.setAttribute("selected", "selected");
						selectQ6.classList.add("considered");
					}
					selectQ6.appendChild(optionQ62);
					tdQ6.appendChild(selectQ6);
					trQ.appendChild(tdQ1);
					trQ.appendChild(tdQ2);
					trQ.appendChild(tdQ3);
					trQ.appendChild(tdQ4);
					trQ.appendChild(tdQ5);
					trQ.appendChild(tdQ6);
					tbody1.appendChild(trQ);
				}

				table1.appendChild(tbody1);
				div.appendChild(table1);

				var button = document.createElement("button");
				button.innerHTML = "Submit";
				button.classList.add("submit_aac_and_dues");
				button.onclick = () => {
					var dataReviewDiv = document.querySelectorAll(".data_review")[0];

					var aacTable = dataReviewDiv.querySelectorAll("table")[0];
					var aacRows = aacTable.children[0].children;

					var originalAacTable = divShowHtml1.children[1].querySelectorAll(":scope > table")[1];
					var originalAacRows = originalAacTable.children[0].children;

					for (var i = 2; i < originalAacRows.length; i++) {
						for (var j = 1; j < aacRows.length; j++) {
							if (originalAacRows[i].children[0].innerText == aacRows[j].children[0].innerText) {
								revisedAacArray.push(+aacRows[j].children[7].querySelectorAll("input")[0].value);
								revisedMcArray.push(aacRows[j].children[7].querySelectorAll("input")[0].value / 12);
							}
						}
					}

					var bpText1 = divShowHtml1.children[1].children[10].nextSibling.textContent.substring(0, 8);
					var bpText2 = divShowHtml1.children[1].children[10].nextSibling.textContent.substring(9);
					//divShowHtml1.children[1].children[10].nextSibling.textContent = bpText1 + dataReviewDiv.querySelectorAll("table")[1].querySelectorAll("input")[0].value + bpText2;
					revisedBP = dataReviewDiv.querySelectorAll("table")[1].querySelectorAll("input")[0].value;

					var uncoveredDuesTable = dataReviewDiv.querySelectorAll("table")[2];
					var uncoveredRows = uncoveredDuesTable.children[0].children;

					var originalUncoveredDuesTable = divShowHtml1.children[1].querySelectorAll(":scope > table")[3].querySelectorAll("tr")[0].children[1].querySelectorAll("table")[0];
					var originalUncoveredRows = originalUncoveredDuesTable.querySelectorAll("tbody")[0].children;

					var j = 1;
					for (var i = 2; i < uncoveredRows.length; i++) {
						if (uncoveredRows[i].children[5].querySelectorAll("select")[0].value == "Consider") {
							var array3 = [];
							array3.push(uncoveredRows[i].children[0].innerText);
							array3.push(uncoveredRows[i].children[3].querySelectorAll("input")[0].value);
							array3.push(uncoveredRows[i].children[1].innerText);
							array3.push(uncoveredRows[i].children[2].innerText);
							array3.push(uncoveredRows[i].children[4].innerText);
							revisedUncoveredDuesArray.push(array3);
							//originalUncoveredRows[j].querySelectorAll("td")[1].innerText = uncoveredRows[i].children[3].querySelectorAll("input")[0].value;
						} else {
							originalUncoveredRows[j].remove();
							j--;
						}
						j++;
					}

					data.revisedAacArray = revisedAacArray;
					data.revisedMcArray = revisedMcArray;
					data.revisedUncoveredDuesArray = revisedUncoveredDuesArray;
					data.revisedBP = revisedBP;

					divShowHtml1.children[2].style.display = "none";
					showQWS(data);
				};
				div.appendChild(button);

				divShowHtml1.appendChild(div);
				divShowHtml1.children[0].querySelectorAll("input[value='Print']")[0].removeAttribute("onclick");
			};

			let showQWS = (data) => {
				var date = data.date;
				var plNo = data.plNo;
				var itemDescription = data.itemDescription;
				var descriptionText = data.descriptionText;
				var unit = data.unit;
				var category = data.category;
				var nature = data.nature;

				var depotArray = data.depotArray;
				var stockArray = data.stockArray;
				var consumptionArray = data.consumptionArray;
				var consumptionYearsArray = data.consumptionYearsArray;
				var aacArray = data.aacArray;
				var mcArray = data.mcArray;
				var udmStockBalance = data.udmStockBalance;
				var coveredDuesArray = data.coveredDuesArray;
				var uncoveredDuesArray = data.uncoveredDuesArray;

				var cpFrom = data.cpFrom;
				var cpTo = data.cpTo;
				var cpMM = data.cpMM;
				var ipFrom = data.ipFrom;
				var ipTo = data.ipTo;
				var ipMM = data.ipMM;
				var bpMM = data.bpMM;

				var revisedAacArray = data.revisedAacArray;
				var revisedMcArray = data.revisedMcArray;
				var revisedUncoveredDuesArray = data.revisedUncoveredDuesArray;
				var revisedBP = data.revisedBP;

				var ipRequirementsArray = [];
				var cpRequirementsArray = [];
				var bpRequirementsArray = [];
				var netRequirementsArray = [];

				var divShowHtml1 = document.querySelectorAll("#divShowHtml1")[0];

				if (divShowHtml1.querySelectorAll(".qty_review_div")[0]) {
					divShowHtml1.querySelectorAll(".qty_review_div")[0].remove();
				}

				var div = document.createElement("div");
				div.classList.add("qty_review_div");

				var table1 = document.createElement("table");
				var tbody1 = document.createElement("tbody");
				var tr1 = document.createElement("tr");
				var td1 = document.createElement("td");
				var text1 = document.createTextNode("QUANTITY REVIEW SHEET");
				td1.appendChild(text1);
				tr1.appendChild(td1);
				tbody1.appendChild(tr1);
				var tr2 = document.createElement("tr");
				var td2 = document.createElement("td");
				var text2 = document.createTextNode("Date: " + date);
				td2.appendChild(text2);
				tr2.appendChild(td2);
				tr1.setAttribute("bgcolor", "lightBlue");
				tbody1.appendChild(tr1);
				tbody1.appendChild(tr2);
				table1.appendChild(tbody1);
				div.appendChild(table1);

				var table1 = document.createElement("table");
				var tbody1 = document.createElement("tbody");
				var tr1 = document.createElement("tr");
				var td1 = document.createElement("td");
				var text1 = document.createTextNode("PL No");
				td1.appendChild(text1);
				var td2 = document.createElement("td");
				var text2 = document.createTextNode(plNo);
				td2.appendChild(text2);
				var td3 = document.createElement("td");
				var text3 = document.createTextNode("Nature");
				td3.appendChild(text3);
				var td4 = document.createElement("td");
				var natureText = nature == "S" ? "Safety" : nature == "V" ? "Vital" : "Ordinary";
				var text4 = document.createTextNode(natureText);
				td4.appendChild(text4);
				var td5 = document.createElement("td");
				var text5 = document.createTextNode("Category");
				td5.appendChild(text5);
				var td6 = document.createElement("td");
				var text6 = document.createTextNode(category);
				td6.appendChild(text6);
				var td7 = document.createElement("td");
				var text7 = document.createTextNode("Unit");
				td7.appendChild(text7);
				var td8 = document.createElement("td");
				var text8 = document.createTextNode(unit);
				td8.appendChild(text8);
				tr1.appendChild(td1);
				tr1.appendChild(td2);
				tr1.appendChild(td3);
				tr1.appendChild(td4);
				tr1.appendChild(td5);
				tr1.appendChild(td6);
				tr1.appendChild(td7);
				tr1.appendChild(td8);
				var tr2 = document.createElement("tr");
				var td9 = document.createElement("td");
				var text9 = document.createTextNode("Description");
				td9.appendChild(text9);
				var td10 = document.createElement("td");
				var text10 = document.createTextNode(itemDescription);
				td10.appendChild(text10);
				td10.setAttribute("colspan", "7");
				tr2.appendChild(td9);
				tr2.appendChild(td10);
				tbody1.appendChild(tr1);
				tbody1.appendChild(tr2);
				table1.appendChild(tbody1);
				div.appendChild(table1);

				var table1 = document.createElement("table");
				var tbody1 = document.createElement("tbody");
				var tr1 = document.createElement("tr");
				var td1 = document.createElement("td");
				var text1 = document.createTextNode("Stock and Consumption History");
				td1.appendChild(text1);
				td1.setAttribute("colspan", 9);
				tr1.appendChild(td1);
				var tr2 = document.createElement("tr");
				var td2 = document.createElement("td");
				var text2 = document.createTextNode("Depot");
				td2.appendChild(text2);
				var td3 = document.createElement("td");
				var text3 = document.createTextNode("Cons " + consumptionYearsArray[0]);
				td3.appendChild(text3);
				var td4 = document.createElement("td");
				var text4 = document.createTextNode("Cons " + consumptionYearsArray[1]);
				td4.appendChild(text4);
				var td5 = document.createElement("td");
				var text5 = document.createTextNode("Cons " + consumptionYearsArray[2]);
				td5.appendChild(text5);
				var td6 = document.createElement("td");
				var text6 = document.createTextNode("Cons " + consumptionYearsArray[3]);
				td6.appendChild(text6);
				var td7 = document.createElement("td");
				var text7 = document.createTextNode("Max Consumption");
				td7.appendChild(text7);
				var td8 = document.createElement("td");
				var text8 = document.createTextNode("AAC");
				td8.appendChild(text8);
				var td9 = document.createElement("td");
				var text9 = document.createTextNode("Revised AAC");
				td9.appendChild(text9);
				var td10 = document.createElement("td");
				var text10 = document.createTextNode("Stock");
				td10.appendChild(text10);
				tr2.appendChild(td2);
				tr2.appendChild(td3);
				tr2.appendChild(td4);
				tr2.appendChild(td5);
				tr2.appendChild(td6);
				tr2.appendChild(td7);
				tr2.appendChild(td8);
				tr2.appendChild(td9);
				tr2.appendChild(td10);
				tr1.setAttribute("bgcolor", "lightBlue");
				tr2.setAttribute("bgcolor", "lightBlue");
				tbody1.appendChild(tr1);
				tbody1.appendChild(tr2);

				for (var i = 0; i < depotArray.length; i++) {
					var tri = document.createElement("tr");
					var tdi1 = document.createElement("td");
					var texti1 = document.createTextNode(depotArray[i]);
					tdi1.appendChild(texti1);
					var tdi2 = document.createElement("td");
					var texti2 = document.createTextNode(consumptionArray[i][0]);
					tdi2.appendChild(texti2);
					var tdi3 = document.createElement("td");
					var texti3 = document.createTextNode(consumptionArray[i][1]);
					tdi3.appendChild(texti3);
					var tdi4 = document.createElement("td");
					var texti4 = document.createTextNode(consumptionArray[i][2]);
					tdi4.appendChild(texti4);
					var tdi5 = document.createElement("td");
					var texti5 = document.createTextNode(consumptionArray[i][3]);
					tdi5.appendChild(texti5);
					var dateArray = date.split("/");
					var numMonths = +dateArray[1] - 4 + +dateArray[0] / 30;
					var date1 = new Date("20" + date.split("/")[2], +date.split("/")[1] - 1, +date.split("/")[0]);
					var date2 = new Date("20" + consumptionYearsArray[3].split("-")[0], 3, 1);
					var numDays = (date1 - date2) / (1000 * 60 * 60 * 24);
					var avgConsumption = Math.round(((+consumptionArray[i][0] * 1 + +consumptionArray[i][1] * 2 + +consumptionArray[i][2] * 3 + +consumptionArray[i][3] * 3) / (6 + (3 * numDays) / 365)) * 100) / 100;
					var maxConsumption = Math.max(+consumptionArray[i][0], +consumptionArray[i][1], +consumptionArray[i][2], Math.round((+consumptionArray[i][3] * 365) / numDays));
					var tdi6 = document.createElement("td");
					var texti6 = document.createTextNode(maxConsumption);
					tdi6.appendChild(texti6);
					var tdi7 = document.createElement("td");
					var texti7 = document.createTextNode(aacArray[i]);
					tdi7.appendChild(texti7);
					var tdi8 = document.createElement("td");
					var texti8 = document.createTextNode(revisedAacArray[i]);
					tdi8.appendChild(texti8);
					var tdi9 = document.createElement("td");
					var texti9 = document.createTextNode(stockArray[i]);
					tdi9.appendChild(texti9);
					tri.appendChild(tdi1);
					tri.appendChild(tdi2);
					tri.appendChild(tdi3);
					tri.appendChild(tdi4);
					tri.appendChild(tdi5);
					tri.appendChild(tdi6);
					tri.appendChild(tdi7);
					tri.appendChild(tdi8);
					tri.appendChild(tdi9);
					tbody1.appendChild(tri);
				}

				var tri = document.createElement("tr");
				var tdi1 = document.createElement("td");
				var texti1 = document.createTextNode("UDM");
				tdi1.appendChild(texti1);
				var tdi2 = document.createElement("td");
				var texti2 = document.createTextNode("-");
				tdi2.appendChild(texti2);
				var tdi3 = document.createElement("td");
				var texti3 = document.createTextNode("-");
				tdi3.appendChild(texti3);
				var tdi4 = document.createElement("td");
				var texti4 = document.createTextNode("-");
				tdi4.appendChild(texti4);
				var tdi5 = document.createElement("td");
				var texti5 = document.createTextNode("-");
				tdi5.appendChild(texti5);
				var tdi6 = document.createElement("td");
				var texti6 = document.createTextNode("-");
				tdi6.appendChild(texti6);
				var tdi7 = document.createElement("td");
				var texti7 = document.createTextNode("-");
				tdi7.appendChild(texti7);
				var tdi8 = document.createElement("td");
				var texti8 = document.createTextNode("-");
				tdi8.appendChild(texti8);
				var tdi9 = document.createElement("td");
				var texti9 = document.createTextNode(udmStockBalance);
				tdi9.appendChild(texti9);
				tri.appendChild(tdi1);
				tri.appendChild(tdi2);
				tri.appendChild(tdi3);
				tri.appendChild(tdi4);
				tri.appendChild(tdi5);
				tri.appendChild(tdi6);
				tri.appendChild(tdi7);
				tri.appendChild(tdi8);
				tri.appendChild(tdi9);
				tbody1.appendChild(tri);

				table1.appendChild(tbody1);
				div.appendChild(table1);

				var table1 = document.createElement("table");
				var tbody1 = document.createElement("tbody");
				var tr1 = document.createElement("tr");
				var td1 = document.createElement("td");
				var text1 = document.createTextNode("Covered Dues");
				td1.appendChild(text1);
				td1.setAttribute("colspan", 3);
				tr1.appendChild(td1);
				var tr2 = document.createElement("tr");
				var td2 = document.createElement("td");
				var text2 = document.createTextNode("Depot");
				td2.appendChild(text2);
				var td30 = document.createElement("td");
				var tr33 = document.createElement("tr");
				var td3 = document.createElement("td");
				var text3 = document.createTextNode("PO Details");
				td3.appendChild(text3);
				var td4 = document.createElement("td");
				var text4 = document.createTextNode("Due Qty");
				td4.appendChild(text4);
				var td5 = document.createElement("td");
				var text5 = document.createTextNode("Total Qty");
				td5.appendChild(text5);
				tr2.appendChild(td2);
				tr33.appendChild(td3);
				tr33.appendChild(td4);
				td30.appendChild(tr33);
				tr2.appendChild(td30);
				tr2.appendChild(td5);
				tr1.setAttribute("bgcolor", "lightBlue");
				tr2.setAttribute("bgcolor", "lightBlue");
				tbody1.appendChild(tr1);
				tbody1.appendChild(tr2);

				var totalCoveredDuesArray = [];

				for (var i = 0; i < depotArray.length; i++) {
					var trJ = document.createElement("tr");
					var tdJ1 = document.createElement("td");
					var textJ1 = document.createTextNode(depotArray[i]);
					tdJ1.appendChild(textJ1);
					var tdJ2 = document.createElement("td");
					var tdJ3 = document.createElement("td");
					var tdJ4 = document.createElement("td");

					var totalDues = 0;
					for (var j = 0; j < coveredDuesArray.length; j++) {
						var row4 = coveredDuesArray[j];

						if (row4[0] == depotArray[i].substring(0, 2) && row4[4].substring(16, 17) != "8" && row4[4].substring(16, 17) != "7") {
							var trK1 = document.createElement("tr");
							var tdK1 = document.createElement("td");
							var textK1 = document.createTextNode(row4[4].slice(0, 35) + " " + row4[4].slice(35));
							var br = document.createElement("br");
							var textK2 = document.createTextNode("DP: " + row4[3]);
							tdK1.appendChild(textK1);
							tdK1.appendChild(br);
							tdK1.appendChild(textK2);
							trK1.appendChild(tdK1);

							var tdK2 = document.createElement("td");
							var textK3 = document.createTextNode(row4[2]);
							tdK2.appendChild(textK3);
							trK1.appendChild(tdK2);
							tdJ3.appendChild(trK1);

							totalDues += +row4[2];
						}
					}

					totalCoveredDuesArray.push(totalDues);
					var textK4 = document.createTextNode(totalDues);
					tdJ4.appendChild(textK4);
					trJ.appendChild(tdJ1);
					trJ.appendChild(tdJ3);
					trJ.appendChild(tdJ4);
					tbody1.appendChild(trJ);
				}

				table1.appendChild(tbody1);
				div.appendChild(table1);

				var table1 = document.createElement("table");
				var tbody1 = document.createElement("tbody");
				var tr1 = document.createElement("tr");
				var td11 = document.createElement("td");
				var text11 = document.createTextNode("Uncovered Dues");
				td11.appendChild(text11);
				td11.setAttribute("colspan", 3);
				tr1.appendChild(td11);
				var tr2 = document.createElement("tr");
				var td21 = document.createElement("td");
				var text21 = document.createTextNode("Depot");
				td21.appendChild(text21);
				var td22 = document.createElement("td");
				var tr3 = document.createElement("tr");
				var td31 = document.createElement("td");
				var text31 = document.createTextNode("Demand No");
				td31.appendChild(text31);
				var td32 = document.createElement("td");
				var text32 = document.createTextNode("Demand Date");
				td32.appendChild(text32);
				var td33 = document.createElement("td");
				var text33 = document.createTextNode("Tender Details");
				td33.appendChild(text33);
				var td34 = document.createElement("td");
				var text34 = document.createTextNode("Qty");
				td34.appendChild(text34);
				tr3.appendChild(td31);
				tr3.appendChild(td32);
				tr3.appendChild(td33);
				tr3.appendChild(td34);
				td22.appendChild(tr3);
				var td23 = document.createElement("td");
				var text23 = document.createTextNode("Total Qty");
				td23.appendChild(text23);
				tr2.appendChild(td21);
				tr2.appendChild(td22);
				tr2.appendChild(td23);
				tr1.setAttribute("bgcolor", "lightBlue");
				tr2.setAttribute("bgcolor", "lightBlue");
				tbody1.appendChild(tr1);
				tbody1.appendChild(tr2);

				var totalUncoveredDuesArray = [];

				for (var i = 0; i < depotArray.length; i++) {
					var trJ = document.createElement("tr");
					var tdJ1 = document.createElement("td");
					var textJ1 = document.createTextNode(depotArray[i]);
					tdJ1.appendChild(textJ1);
					var tdJ2 = document.createElement("td");
					var tdJ3 = document.createElement("td");

					var totalDues = 0;
					for (var j = 0; j < revisedUncoveredDuesArray.length; j++) {
						var row4 = revisedUncoveredDuesArray[j];

						if (row4[0] == depotArray[i]) {
							var trK1 = document.createElement("tr");
							var tdK1 = document.createElement("td");
							var textK1 = document.createTextNode(row4[2]);
							tdK1.appendChild(textK1);
							trK1.appendChild(tdK1);

							var tdK2 = document.createElement("td");
							var textK2 = document.createTextNode(row4[3]);
							tdK2.appendChild(textK2);
							trK1.appendChild(tdK2);

							var tdK3 = document.createElement("td");
							var textK3 = document.createTextNode(row4[4]);
							tdK3.appendChild(textK3);
							trK1.appendChild(tdK3);

							var tdK4 = document.createElement("td");
							var textK4 = document.createTextNode(row4[1]);
							tdK4.appendChild(textK4);
							trK1.appendChild(tdK4);

							tdJ2.appendChild(trK1);
							trK1.appendChild(tdK2);
							trK1.appendChild(tdK3);
							trK1.appendChild(tdK4);
							tdJ2.appendChild(trK1);

							totalDues += +row4[1];
						}
					}

					totalUncoveredDuesArray.push(totalDues);
					var textJ3 = document.createTextNode(totalDues);
					tdJ3.appendChild(textJ3);
					trJ.appendChild(tdJ1);
					trJ.appendChild(tdJ2);
					trJ.appendChild(tdJ3);
					tbody1.appendChild(trJ);
				}

				table1.appendChild(tbody1);
				div.appendChild(table1);

				var table1 = document.createElement("table");
				var tbody1 = document.createElement("tbody");
				var tr1 = document.createElement("tr");
				var td1 = document.createElement("td");
				var text1 = document.createTextNode("Period Under Consideration");
				td1.appendChild(text1);
				td1.setAttribute("colspan", 3);
				tr1.appendChild(td1);
				tr1.setAttribute("bgcolor", "lightBlue");

				var tr2 = document.createElement("tr");
				var td21 = document.createElement("td");
				var text21 = document.createTextNode("IP");
				td21.appendChild(text21);
				var td22 = document.createElement("td");
				var text22 = document.createTextNode(ipFrom + " to " + ipTo);
				td22.appendChild(text22);
				var td23 = document.createElement("td");
				var text23 = document.createTextNode(ipMM + " Months");
				td23.appendChild(text23);
				tr2.appendChild(td21);
				tr2.appendChild(td22);
				tr2.appendChild(td23);

				var tr3 = document.createElement("tr");
				var td31 = document.createElement("td");
				var text31 = document.createTextNode("CP");
				td31.appendChild(text31);
				var td32 = document.createElement("td");
				var text32 = document.createTextNode(cpFrom + " to " + cpTo);
				td32.appendChild(text32);
				var td33 = document.createElement("td");
				var text33 = document.createTextNode(cpMM + " Months");
				td33.appendChild(text33);
				tr3.appendChild(td31);
				tr3.appendChild(td32);
				tr3.appendChild(td33);

				var tr4 = document.createElement("tr");
				var td41 = document.createElement("td");
				var text41 = document.createTextNode("Buffer");
				td41.appendChild(text41);
				var td42 = document.createElement("td");
				var text42 = document.createTextNode("-");
				td42.appendChild(text42);
				var td43 = document.createElement("td");
				var text43 = document.createTextNode(revisedBP + " Months");
				td43.appendChild(text43);
				tr4.appendChild(td41);
				tr4.appendChild(td42);
				tr4.appendChild(td43);

				tbody1.appendChild(tr1);
				tbody1.appendChild(tr2);
				tbody1.appendChild(tr3);
				tbody1.appendChild(tr4);
				table1.appendChild(tbody1);
				div.appendChild(table1);

				var table1 = document.createElement("table");
				var tbody1 = document.createElement("tbody");
				var tr1 = document.createElement("tr");
				var td1 = document.createElement("td");
				var text1 = document.createTextNode("Net Requirements");
				td1.appendChild(text1);
				td1.setAttribute("colspan", 10);
				tr1.appendChild(td1);
				var tr2 = document.createElement("tr");
				var td2 = document.createElement("td");
				var text2 = document.createTextNode("Depot");
				td2.appendChild(text2);
				var td3 = document.createElement("td");
				var text3 = document.createTextNode("AAC");
				td3.appendChild(text3);
				var td4 = document.createElement("td");
				var text4 = document.createTextNode("Monthly Requirement");
				td4.appendChild(text4);
				var td5 = document.createElement("td");
				var text5 = document.createTextNode("IP Requirement");
				td5.appendChild(text5);
				var td6 = document.createElement("td");
				var text6 = document.createTextNode("CP Requirement");
				td6.appendChild(text6);
				var td7 = document.createElement("td");
				var text7 = document.createTextNode("BP Requirement");
				td7.appendChild(text7);
				var td8 = document.createElement("td");
				var text8 = document.createTextNode("CD");
				td8.appendChild(text8);
				var td9 = document.createElement("td");
				var text9 = document.createTextNode("UCD");
				td9.appendChild(text9);
				var td10 = document.createElement("td");
				var text10 = document.createTextNode("Stock");
				td10.appendChild(text10);
				var td11 = document.createElement("td");
				var text11 = document.createTextNode("Total Requirement");
				td11.appendChild(text11);
				tr2.appendChild(td2);
				tr2.appendChild(td3);
				tr2.appendChild(td4);
				tr2.appendChild(td5);
				tr2.appendChild(td6);
				tr2.appendChild(td7);
				tr2.appendChild(td8);
				tr2.appendChild(td9);
				tr2.appendChild(td10);
				tr2.appendChild(td11);
				tr1.setAttribute("bgcolor", "lightBlue");
				tr2.setAttribute("bgcolor", "lightBlue");
				tbody1.appendChild(tr1);
				tbody1.appendChild(tr2);

				for (var i = 0; i <= depotArray.length; i++) {
					var trM = document.createElement("tr");
					var tdM1 = document.createElement("td");
					var textM1;
					if (i == depotArray.length) {
						textM1 = document.createTextNode("Total");
					} else {
						textM1 = document.createTextNode(depotArray[i]);
					}
					tdM1.appendChild(textM1);

					var tdM2 = document.createElement("td");
					var textM2;
					if (i == depotArray.length) {
						textM2 = document.createTextNode(revisedAacArray.reduce((a, b) => a + b, 0));
					} else {
						textM2 = document.createTextNode(revisedAacArray[i]);
					}
					tdM2.appendChild(textM2);

					var tdM3 = document.createElement("td");
					var textM3;
					if (i == depotArray.length) {
						textM3 = document.createTextNode(Math.round(revisedMcArray.reduce((a, b) => a + b, 0) * 100) / 100);
					} else {
						textM3 = document.createTextNode(Math.round(revisedMcArray[i] * 100) / 100);
					}
					tdM3.appendChild(textM3);

					var tdM4 = document.createElement("td");
					var textM4;
					if (i == depotArray.length) {
						textM4 = document.createTextNode(Math.round(ipRequirementsArray.reduce((a, b) => a + b, 0) * 100) / 100);
					} else {
						var ipRequirement = revisedMcArray[i] * ipMM;
						ipRequirementsArray.push(+ipRequirement);
						textM4 = document.createTextNode(Math.round(ipRequirement * 100) / 100);
					}
					tdM4.appendChild(textM4);

					var tdM5 = document.createElement("td");
					var textM5;
					if (i == depotArray.length) {
						textM5 = document.createTextNode(Math.round(cpRequirementsArray.reduce((a, b) => a + b, 0) * 100) / 100);
					} else {
						var cpRequirement = revisedAacArray[i];
						cpRequirementsArray.push(+cpRequirement);
						textM5 = document.createTextNode(Math.round(cpRequirement * 100) / 100);
					}
					tdM5.appendChild(textM5);

					var tdM6 = document.createElement("td");
					var textM6;
					if (i == depotArray.length) {
						textM6 = document.createTextNode(Math.round(bpRequirementsArray.reduce((a, b) => a + b, 0) * 100) / 100);
					} else {
						var bpRequirement = revisedMcArray[i] * revisedBP;
						bpRequirementsArray.push(+bpRequirement);
						textM6 = document.createTextNode(Math.round(bpRequirement * 100) / 100);
					}
					tdM6.appendChild(textM6);

					var tdM7 = document.createElement("td");
					var textM7;
					if (i == depotArray.length) {
						textM7 = document.createTextNode(totalCoveredDuesArray.reduce((a, b) => a + b, 0));
					} else {
						textM7 = document.createTextNode(totalCoveredDuesArray[i]);
					}
					tdM7.appendChild(textM7);

					var tdM8 = document.createElement("td");
					var textM8;
					if (i == depotArray.length) {
						textM8 = document.createTextNode(totalUncoveredDuesArray.reduce((a, b) => a + b, 0));
					} else {
						textM8 = document.createTextNode(totalUncoveredDuesArray[i]);
					}
					tdM8.appendChild(textM8);

					var tdM9 = document.createElement("td");
					var textM9;
					if (i == depotArray.length) {
						textM9 = document.createTextNode(stockArray.reduce((a, b) => a + b, 0));
					} else {
						textM9 = document.createTextNode(stockArray[i]);
					}
					tdM9.appendChild(textM9);

					var tdM10 = document.createElement("td");
					var textM10;
					if (i == depotArray.length) {
						textM10 = document.createTextNode(Math.round(netRequirementsArray.reduce((a, b) => a + b, 0) * 100) / 100);
					} else {
						var netRequirement = +ipRequirement + +cpRequirement + +bpRequirement - +totalCoveredDuesArray[i] - +totalUncoveredDuesArray[i] - +stockArray[i];
						netRequirementsArray.push(+netRequirement);
						textM10 = document.createTextNode(Math.round(netRequirement * 100) / 100);
					}
					tdM10.appendChild(textM10);

					trM.appendChild(tdM1);
					trM.appendChild(tdM2);
					trM.appendChild(tdM3);
					trM.appendChild(tdM4);
					trM.appendChild(tdM5);
					trM.appendChild(tdM6);
					trM.appendChild(tdM7);
					trM.appendChild(tdM8);
					trM.appendChild(tdM9);
					trM.appendChild(tdM10);

					tbody1.appendChild(trM);
				}

				table1.appendChild(tbody1);
				div.appendChild(table1);

				divShowHtml1.appendChild(div);
			};

			var divShowHtml1 = document.querySelectorAll("#divShowHtml1")[0];

			var plInput = document.querySelectorAll("#s_2")[0].querySelectorAll("input[name='PLNO_0']")[0];
			var cpSelect = document.querySelectorAll("#s_2")[0].querySelectorAll("select[name='CP_Start_0']")[0];
			plInput.focus();

			document.addEventListener("click", (e) => {
				if (e.target.name == "btn_Show_0") {
					confirmData();

					divShowHtml1.children[1].style.display = "none";
					divShowHtml1.querySelectorAll(".data_review")[0].querySelectorAll(".submit_aac_and_dues")[0].focus();
					document.title = "QRS " + plInput.value;
				}
				if (e.target.value == "Print") {
					var qty_review_div = divShowHtml1.querySelectorAll(".qty_review_div")[0];

					var a = window.open("", "", "fullscreen=yes");
					a.document.write("<html>");
					a.document.write("<body >");
					a.document.write(qty_review_div.outerHTML);
					a.document.write("</body></html>");
					a.document.close();
					a.print();
				}
			});

			document.addEventListener("change", (e) => {
				if (e.target.classList.contains("demand_consider")) {
					if (e.target.value == "Consider") {
						e.target.classList.add("considered");
					} else {
						e.target.classList.remove("considered");
					}
				}
			});

			plInput.addEventListener("keydown", (e) => {
				if (e.key === "Tab" || e.key === "Enter") {
					cpSelect.focus();
				}
			});

			cpSelect.addEventListener("keydown", (e) => {
				if (e.key === "Tab" || e.key === "Enter") {
					document.querySelectorAll("#s_2")[0].querySelectorAll("#s_0_13")[0].focus();
				}
			});

			document.addEventListener("keydown", (e) => {
				if (e.key === "Escape") {
					if (divShowHtml1.style.display == "block") {
						divShowHtml1.style.display = "none";
						plInput.focus();
						document.title = "Quantity Review Sheet";
					}
				}
			});
		}

		if (document.title == "Auto DRR Status Report" || document.title == "Run Form - IMMIS/DEP/AUTODRR") {
			body.classList.add("auto_drr_report");

			document.addEventListener("click", (e) => {
				if (e.target.name == "SHOW_EDISP_0") {
					var depotInput = document.querySelectorAll("#s_0_11")[0].value;
					var titleBar = document.querySelectorAll("#TitleBar")[0];
					var depotCode;
					zoneDepotArray.forEach((depot) => {
						if (depot[0] == depotInput) {
							depotCode = depot[1];
						}
					});

					var zoneCode = titleBar.querySelectorAll("td")[0].innerText.split(":")[0].substring(1, 3);

					var s_3 = document.querySelectorAll("#s_3")[0];
					var rows = s_3.querySelectorAll("div")[0].querySelectorAll("tbody")[0].children;

					for (var i = 1; i < rows.length; i++) {
						var row = rows[i];
						var eDispatchNo = row.querySelectorAll("td")[1].innerText;
						var eDispatchDepot = eDispatchNo.split("/")[1];

						if (eDispatchDepot != "00" + depotCode + "00") {
							row.style.display = "none";
						}

						var poNo = row.querySelectorAll("td")[7].innerText;
						var poDate = row.querySelectorAll("td")[8].innerText;
						var poYear = "20" + poDate.split("-")[2];

						var link = document.createElement("a");
						var linkText = document.createTextNode(poNo);
						link.appendChild(linkText);
						link.title = poNo;
						link.href = "https://ireps.gov.in/ireps/etender/pdfdocs/MMIS/PO/" + poYear + "/" + zoneCode + "/" + poNo + ".pdf";
						link.target = "_blank";
						row.children[7].innerHTML = "";
						row.children[7].appendChild(link);
					}
				}
			});
		}

		if (document.title == "Consignee Wise AAC Master" || document.title == "Run Form - IMMIS/PUR/CONSAAC") {
			body.classList.add("consignee_aac");

			document.addEventListener("click", (e) => {
				if (e.target.title == "View Added Cons. AAC.") {
					var scrollTop = window.pageYOffset || e.target.scrollTop || document.body.scrollTop;
					var divShowHtml1 = document.querySelectorAll("#divShowHtml1")[0];
					scrollTop += 150;

					divShowHtml1.style.top = scrollTop + "px";
				}
				if (e.target.title == "Select This PL." && e.target.closest("table").id == "tab_fwd_aislist") {
					var s_4 = body.querySelectorAll("#s_4")[0];
					var consumptionTable = s_4.querySelectorAll("fieldset")[1].querySelectorAll("tbody")[0];

					var consumption1st = 0;
					var consumption2nd = 0;

					for (var i = 1; i < consumptionTable.children.length; i++) {
						var consigneeRow = consumptionTable.children[i];
						var consigneeConsumption1st = 0;
						var consigneeConsumption2nd = 0;

						if (typeof consigneeRow.children[3] != "undefined" || consigneeRow.children[3] != null) {
							consigneeConsumption1st = consigneeRow.children[3].innerText;
						}
						if (typeof consigneeRow.children[4] != "undefined" || consigneeRow.children[4] != null) {
							consigneeConsumption2nd = consigneeRow.children[4].innerText;
						}

						consumption1st += +consigneeConsumption1st;
						consumption2nd += +consigneeConsumption2nd;
					}

					var tr = document.createElement("tr");
					var td1 = document.createElement("td");
					var text1 = document.createTextNode("Total consumption");
					td1.appendChild(text1);
					td1.setAttribute("colspan", 3);
					td1.style.textAlign = "center";
					var td2 = document.createElement("td");
					var text2 = document.createTextNode(consumption1st);
					td2.appendChild(text2);
					td2.style.textAlign = "center";
					var td3 = document.createElement("td");
					var text3 = document.createTextNode(consumption2nd);
					td3.appendChild(text3);
					td3.style.textAlign = "center";
					var td4 = document.createElement("td");
					td4.setAttribute("colspan", 2);
					tr.appendChild(td1);
					tr.appendChild(td2);
					tr.appendChild(td3);
					tr.appendChild(td4);
					consumptionTable.appendChild(tr);
				}
			});
		}

		if (document.title == "Map Consignee in Depot" || document.title == "Run Form - IMMIS/DEP/DOCONSMAP") {
			body.classList.add("depot_consignee_mapping");
		}

		if (document.title == "TPI Status" || document.title == "Run Form - IMMIS/PUR/TPINSP") {
			body.classList.add("tpi_status");

			var s_2 = body.querySelectorAll("#s_2")[0];
			var s_3 = body.querySelectorAll("#s_3")[0];

			var monthSelect = document.querySelectorAll("#s_0_10")[0];
			monthSelect.selectedIndex = new Date().getMonth();

			var th = document.createElement("th");
			var label = document.createElement("label");
			label.style.cssText = s_2.querySelectorAll("table")[0].querySelectorAll("tr")[1].querySelectorAll("th")[0].querySelectorAll("label")[0].style.cssText;
			var b = document.createElement("b");
			var text = document.createTextNode("Sec :");
			b.appendChild(text);
			label.appendChild(b);
			th.appendChild(label);
			th.setAttribute("nowrap", "");
			var td = document.createElement("td");
			var input = s_2.querySelectorAll("input[name='IC_NO_0']")[0].cloneNode(true);
			input.removeAttribute("id");
			input.setAttribute("name", "SEC_NO_0");
			td.appendChild(input);

			s_2.querySelectorAll("table")[0].querySelectorAll("tr")[1].insertBefore(th, s_2.querySelectorAll("table")[0].querySelectorAll("tr")[1].querySelectorAll("th")[0]);
			s_2.querySelectorAll("table")[0].querySelectorAll("tr")[1].insertBefore(td, s_2.querySelectorAll("table")[0].querySelectorAll("tr")[1].querySelectorAll("th")[1]);
			s_2.querySelectorAll("table")[0].querySelectorAll("tr")[1].querySelectorAll("th")[1].style.display = "none";
			s_2.querySelectorAll("table")[0].querySelectorAll("tr")[1].querySelectorAll("td")[1].style.display = "none";

			document.addEventListener("click", (e) => {
				if (e.target.getAttribute("name") == "SHOW_BTN_0") {
					if (s_2.querySelectorAll(":scope > table").length > 1) {
						s_2.querySelectorAll(":scope > table")[1].remove();
					}

					var tableHeader = s_3.querySelectorAll("div")[0].querySelectorAll("tr")[0];
					var tableHeaderClone = tableHeader.cloneNode(true);

					var tableHeaderCloneChildren = tableHeaderClone.children;
					for (var i = 0; i < tableHeaderCloneChildren.length; i++) {
						var tableHeaderCloneChild = tableHeaderCloneChildren[i];
						tableHeaderCloneChild.style.width = window.getComputedStyle(tableHeader.querySelectorAll("td")[i]).getPropertyValue("width");
					}

					var table1 = document.createElement("table");
					var tbody1 = document.createElement("tbody");
					tbody1.appendChild(tableHeaderClone);
					table1.appendChild(tbody1);
					s_2.appendChild(table1);

					var section = s_2.querySelectorAll("input[name='SEC_NO_0']")[0].value;

					var inspectionTable = s_3.querySelectorAll("table")[1];
					var inspectionTableRows = inspectionTable.querySelectorAll("tbody")[0].children;

					for (var j = 1; j < inspectionTableRows.length; j++) {
						var inspectionRow = inspectionTableRows[j];
						var callID = inspectionRow.children[1].innerText;
						var callDate = inspectionRow.children[2].innerText;
						var poNo = inspectionRow.children[6].innerText;
						var plNo = inspectionRow.children[8].innerText;
						var itemDescription = inspectionRow.children[9].innerText;
						var qtyRejected = inspectionRow.children[14].innerText;
						var qtyPassed = inspectionRow.children[12].innerText;
						var icNo = inspectionRow.children[17].innerText;
						var icDate = inspectionRow.children[18].innerText;

						var br1 = document.createElement("br");
						var text1 = document.createTextNode(callDate);
						inspectionRow.children[1].appendChild(br1);
						inspectionRow.children[1].appendChild(text1);

						inspectionRow.children[9].innerHTML = "<span>[" + plNo + "]</span> " + itemDescription;

						var p = document.createElement("p");
						var text2 = document.createTextNode("Get PO");
						p.appendChild(text2);
						p.className = "get_po_url";
						inspectionRow.children[6].appendChild(p);

						if (+qtyRejected > +qtyPassed) {
							var br3 = document.createElement("br");
							var text3 = document.createTextNode("Rejected");
							inspectionRow.children[16].appendChild(br3);
							inspectionRow.children[16].appendChild(text3);
							inspectionRow.children[16].style.color = "red";
						}

						var br4 = document.createElement("br");
						var text4 = document.createTextNode(icDate);
						inspectionRow.children[17].appendChild(br4);
						inspectionRow.children[17].appendChild(text4);

						if (section != "" && section != poNo.substring(0, 2)) {
							inspectionRow.style.display = "none";
						}
					}
				}

				if (e.target.classList.contains("get_po_url")) {
					async function getPOUrl() {
						var poNo = e.target.parentElement.innerText.substring(0, 15);
						var poYear = "20" + poNo.substring(2, 4);
						var poZone = currentZone;

						var url = "https://ireps.gov.in/ireps/etender/pdfdocs/MMIS/PO/" + poYear + "/" + zoneJson[poZone] + "/" + poNo + ".pdf";

						try {
							const urlExists = await checkUrl(url);
							if (!urlExists) {
								poYear = +poYear + 1;
								url = "https://ireps.gov.in/ireps/etender/pdfdocs/MMIS/PO/" + poYear + "/" + zoneJson[poZone] + "/" + poNo + ".pdf";
							}

							var link = document.createElement("a");
							var linkText = document.createTextNode(poNo);
							link.appendChild(linkText);
							link.title = poNo;
							link.href = url;
							link.target = "_blank";
							e.target.parentElement.appendChild(link);
						} catch (error) {
							console.error(`Error in exampleUsage: ${error.message}`);
						}
					}

					getPOUrl();
				}
			});
		}

		if (document.title == "Spare Stock Entry" || document.title == "Run Form - IMMIS/DEP/SPARESTKENTRY") {
			body.classList.add("spare_stock_entry");

			var CanvassHolder = document.querySelectorAll("#CanvassHolder")[0];
			var s_3 = document.querySelectorAll("#s_3")[0];
			var div = s_3.querySelectorAll("tr")[1].querySelectorAll("div")[0];
			var divCssText = div.style.cssText;
			var divCssTextNew = divCssText.slice(0, divCssText.indexOf("overflow:") - 2) + " !important" + divCssText.slice(divCssText.indexOf("overflow:") - 2);
			div.style.cssText = divCssTextNew;
		}

		if (document.title == "BIN CARD" || document.title == "Run Form - IMMIS/DEP/BINCARD") {
			body.classList.add("bin_card");

			var plInput = document.querySelectorAll("#s_0_8")[0];
			var monthFromInput = document.querySelectorAll("#s_0_15")[0];
			var yyCode = "";

			if (new Date().getMonth() < 3) {
				yyCode = +currentYear.substring(2, 4) - 1;
			} else {
				yyCode = currentYear.substring(2, 4);
			}

			monthFromInput.value = yyCode + "04";

			plInput.addEventListener("keydown", (e) => {
				if (e.key === "Tab" || e.key === "Enter") {
					e.target.parentElement.nextElementSibling.nextElementSibling.querySelectorAll("select")[0].value = currentDepotCode;
					e.target.parentElement.nextElementSibling.nextElementSibling.querySelectorAll("select")[0].dispatchEvent(new Event("change", { bubbles: true }));
					document.querySelectorAll("#s_2")[0].querySelectorAll("#s_0_19")[0].focus();
				}
			});
		}

		if (document.title == "Status of Receipt Accountal" || document.title == "Run Form - IMMIS/DEP/DRRSTAT") {
			body.classList.add("drr_status");

			var dateFromInput = document.querySelectorAll("#s_0_11")[0];
			var yyCode = "";

			if (new Date().getMonth() < 3) {
				yyCode = +currentYear.substring(2, 4) - 1;
			} else {
				yyCode = currentYear.substring(2, 4);
			}

			dateFromInput.value = "01-APR-" + yyCode;

			var statisticsButton = document.querySelectorAll("#s_0_28")[0];
			statisticsButton.click();
		}

        if (document.title == "Request for Authorization of Proposals / Records" || document.title == "Run Form - IMMIS/AUTHREQ") {
            body.classList.add("authreq");
        }

        if (document.title == "MMIS - Organization Masters (Railways)" || document.title == "Run Form - IMMIS/MMISORGRLY") {
            body.classList.add("mmis_organization");
        }

        if (document.title == "View / Manage Organization Structure" || document.title == "Run Form - ORG") {
            body.classList.add("organization_structure");
        }

        if (document.title == "Processing of Purchase Orders" || document.title == "Run Form - IMMIS/PUR/ORDERAUTH") {
            body.classList.add("po_process");

            var s_4 = document.querySelectorAll("#s_4")[0];

            document.addEventListener("click", (e) => {

                if(e.target.id.startsWith("btnActRow_")){

                    s_4.querySelectorAll("input[name='btn_Auth_0']")[0].focus();

                }

            });
        }

		if (document.title == "Formation of NIT for Publishing" || document.title == "Run Form - IMMIS/PUR/NITPUBLISH") {
            body.classList.add("newspaper_publication");

            var todFromInput = document.querySelectorAll("input[name='TOD_FR_0']")[0];
            var todToInput = document.querySelectorAll("input[name='TOD_TO_0']")[0];

            var todFromValue = todFromInput.value;
            var todFromArray = todFromValue.split("-");

            todFromInput.value = todFromArray[0] + "-" + todFromArray[1] + "-" + (+todFromArray[2] - 1);
            todToInput.value = todFromArray[0] + "-" + todFromArray[1] + "-" + (+todFromArray[2] + 1);

            var getTendersButton = document.querySelectorAll("input[name='GET_BTN_0']")[0];

            getTendersButton.addEventListener("click", (e) => {

                var lastNITDateValue = document.querySelectorAll("input[name='MAX_NIT_DT_0']")[0].value;
                var lastNITDate = new Date("20" + lastNITDateValue.split("-")[2], monthArray.indexOf(lastNITDateValue.split("-")[1]), lastNITDateValue.split("-")[0]);

                var s_3 = document.querySelectorAll("#s_3")[0];

                var listTenders = s_3.querySelectorAll("div")[0].querySelectorAll("tbody")[0].children;

                for(var i = 1; i < listTenders.length; i++){

                    var tender = listTenders[i];
                    var publishedDateValue = tender.children[9].innerText.trim();
                    var publishedDate = new Date("20" + publishedDateValue.split("-")[2], monthArray.indexOf(publishedDateValue.split("-")[1]), publishedDateValue.split("-")[0]);

                    if(publishedDate < lastNITDate){
                        tender.style.display = "none";
                    }

                }

            });
        }

        if (document.title == "PL Group to Purchase Section Mapping" || document.title == "Run Form - IMMIS/PLSECMAP") {
            body.classList.add("pl_section_mapping");
        }
	},
	false
);
